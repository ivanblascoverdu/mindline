(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[284],{855:(e,t,r)=>{"use strict";var n=r(98445),i=r(60956),o="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;function s(e){if(e>0x7fffffff)throw RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return Object.setPrototypeOf(t,a.prototype),t}function a(e,t,r){if("number"==typeof e){if("string"==typeof t)throw TypeError('The "string" argument must be of type string. Received type number');return c(e)}return u(e,t,r)}function u(e,t,r){if("string"==typeof e)return function(e,t){if(("string"!=typeof t||""===t)&&(t="utf8"),!a.isEncoding(t))throw TypeError("Unknown encoding: "+t);var r=0|p(e,t),n=s(r),i=n.write(e,t);return i!==r&&(n=n.slice(0,i)),n}(e,t);if(ArrayBuffer.isView(e))return function(e){if(I(e,Uint8Array)){var t=new Uint8Array(e);return d(t.buffer,t.byteOffset,t.byteLength)}return h(e)}(e);if(null==e)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(I(e,ArrayBuffer)||e&&I(e.buffer,ArrayBuffer)||"undefined"!=typeof SharedArrayBuffer&&(I(e,SharedArrayBuffer)||e&&I(e.buffer,SharedArrayBuffer)))return d(e,t,r);if("number"==typeof e)throw TypeError('The "value" argument must not be of type number. Received type number');var n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return a.from(n,t,r);var i=function(e){if(a.isBuffer(e)){var t=0|f(e.length),r=s(t);return 0===r.length||e.copy(r,0,0,t),r}return void 0!==e.length?"number"!=typeof e.length||function(e){return e!=e}(e.length)?s(0):h(e):"Buffer"===e.type&&Array.isArray(e.data)?h(e.data):void 0}(e);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return a.from(e[Symbol.toPrimitive]("string"),t,r);throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function l(e){if("number"!=typeof e)throw TypeError('"size" argument must be of type number');if(e<0)throw RangeError('The value "'+e+'" is invalid for option "size"')}function c(e){return l(e),s(e<0?0:0|f(e))}function h(e){for(var t=e.length<0?0:0|f(e.length),r=s(t),n=0;n<t;n+=1)r[n]=255&e[n];return r}function d(e,t,r){var n;if(t<0||e.byteLength<t)throw RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw RangeError('"length" is outside of buffer bounds');return Object.setPrototypeOf(n=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r),a.prototype),n}function f(e){if(e>=0x7fffffff)throw RangeError("Attempt to allocate Buffer larger than maximum size: 0x7fffffff bytes");return 0|e}function p(e,t){if(a.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||I(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var r=e.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return C(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return O(e).length;default:if(i)return n?-1:C(e).length;t=(""+t).toLowerCase(),i=!0}}function v(e,t,r){var i,o,s,a=!1;if((void 0===t||t<0)&&(t=0),t>this.length||((void 0===r||r>this.length)&&(r=this.length),r<=0||(r>>>=0)<=(t>>>=0)))return"";for(e||(e="utf8");;)switch(e){case"hex":return function(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var i="",o=t;o<r;++o)i+=P[e[o]];return i}(this,t,r);case"utf8":case"utf-8":return b(this,t,r);case"ascii":return function(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}(this,t,r);case"latin1":case"binary":return function(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}(this,t,r);case"base64":return i=this,o=t,s=r,0===o&&s===i.length?n.fromByteArray(i):n.fromByteArray(i.slice(o,s));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return function(e,t,r){for(var n=e.slice(t,r),i="",o=0;o<n.length-1;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}(this,t,r);default:if(a)throw TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),a=!0}}function g(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function y(e,t,r,n,i){var o;if(0===e.length)return -1;if("string"==typeof r?(n=r,r=0):r>0x7fffffff?r=0x7fffffff:r<-0x80000000&&(r=-0x80000000),(o=r*=1)!=o&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return -1;r=e.length-1}else if(r<0){if(!i)return -1;r=0}if("string"==typeof t&&(t=a.from(t,n)),a.isBuffer(t))return 0===t.length?-1:m(e,t,r,n,i);if("number"==typeof t)return(t&=255,"function"==typeof Uint8Array.prototype.indexOf)?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):m(e,[t],r,n,i);throw TypeError("val must be string, number or Buffer")}function m(e,t,r,n,i){var o,s=1,a=e.length,u=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return -1;s=2,a/=2,u/=2,r/=2}function l(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(i){var c=-1;for(o=r;o<a;o++)if(l(e,o)===l(t,-1===c?0:o-c)){if(-1===c&&(c=o),o-c+1===u)return c*s}else -1!==c&&(o-=o-c),c=-1}else for(r+u>a&&(r=a-u),o=r;o>=0;o--){for(var h=!0,d=0;d<u;d++)if(l(e,o+d)!==l(t,d)){h=!1;break}if(h)return o}return -1}function b(e,t,r){r=Math.min(e.length,r);for(var n=[],i=t;i<r;){var o,s,a,u,l=e[i],c=null,h=l>239?4:l>223?3:l>191?2:1;if(i+h<=r)switch(h){case 1:l<128&&(c=l);break;case 2:(192&(o=e[i+1]))==128&&(u=(31&l)<<6|63&o)>127&&(c=u);break;case 3:o=e[i+1],s=e[i+2],(192&o)==128&&(192&s)==128&&(u=(15&l)<<12|(63&o)<<6|63&s)>2047&&(u<55296||u>57343)&&(c=u);break;case 4:o=e[i+1],s=e[i+2],a=e[i+3],(192&o)==128&&(192&s)==128&&(192&a)==128&&(u=(15&l)<<18|(63&o)<<12|(63&s)<<6|63&a)>65535&&u<1114112&&(c=u)}null===c?(c=65533,h=1):c>65535&&(c-=65536,n.push(c>>>10&1023|55296),c=56320|1023&c),n.push(c),i+=h}return function(e){var t=e.length;if(t<=4096)return String.fromCharCode.apply(String,e);for(var r="",n=0;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=4096));return r}(n)}function w(e,t,r){if(e%1!=0||e<0)throw RangeError("offset is not uint");if(e+t>r)throw RangeError("Trying to access beyond buffer length")}function _(e,t,r,n,i,o){if(!a.isBuffer(e))throw TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw RangeError('"value" argument is out of bounds');if(r+n>e.length)throw RangeError("Index out of range")}function k(e,t,r,n,i,o){if(r+n>e.length||r<0)throw RangeError("Index out of range")}function S(e,t,r,n,o){return t*=1,r>>>=0,o||k(e,t,r,4,34028234663852886e22,-34028234663852886e22),i.write(e,t,r,n,23,4),r+4}function E(e,t,r,n,o){return t*=1,r>>>=0,o||k(e,t,r,8,17976931348623157e292,-17976931348623157e292),i.write(e,t,r,n,52,8),r+8}t.hp=a,t.IS=50,a.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),a.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.buffer}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.byteOffset}}),a.poolSize=8192,a.from=function(e,t,r){return u(e,t,r)},Object.setPrototypeOf(a.prototype,Uint8Array.prototype),Object.setPrototypeOf(a,Uint8Array),a.alloc=function(e,t,r){return(l(e),e<=0)?s(e):void 0!==t?"string"==typeof r?s(e).fill(t,r):s(e).fill(t):s(e)},a.allocUnsafe=function(e){return c(e)},a.allocUnsafeSlow=function(e){return c(e)},a.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==a.prototype},a.compare=function(e,t){if(I(e,Uint8Array)&&(e=a.from(e,e.offset,e.byteLength)),I(t,Uint8Array)&&(t=a.from(t,t.offset,t.byteLength)),!a.isBuffer(e)||!a.isBuffer(t))throw TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var r=e.length,n=t.length,i=0,o=Math.min(r,n);i<o;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:+(n<r)},a.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(e,t){if(!Array.isArray(e))throw TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return a.alloc(0);if(void 0===t)for(r=0,t=0;r<e.length;++r)t+=e[r].length;var r,n=a.allocUnsafe(t),i=0;for(r=0;r<e.length;++r){var o=e[r];if(I(o,Uint8Array))i+o.length>n.length?a.from(o).copy(n,i):Uint8Array.prototype.set.call(n,o,i);else if(a.isBuffer(o))o.copy(n,i);else throw TypeError('"list" argument must be an Array of Buffers');i+=o.length}return n},a.byteLength=p,a.prototype._isBuffer=!0,a.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)g(this,t,t+1);return this},a.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)g(this,t,t+3),g(this,t+1,t+2);return this},a.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)g(this,t,t+7),g(this,t+1,t+6),g(this,t+2,t+5),g(this,t+3,t+4);return this},a.prototype.toString=function(){var e=this.length;return 0===e?"":0==arguments.length?b(this,0,e):v.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(e){if(!a.isBuffer(e))throw TypeError("Argument must be a Buffer");return this===e||0===a.compare(this,e)},a.prototype.inspect=function(){var e="",r=t.IS;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"},o&&(a.prototype[o]=a.prototype.inspect),a.prototype.compare=function(e,t,r,n,i){if(I(e,Uint8Array)&&(e=a.from(e,e.offset,e.byteLength)),!a.isBuffer(e))throw TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return -1;if(t>=r)return 1;if(t>>>=0,r>>>=0,n>>>=0,i>>>=0,this===e)return 0;for(var o=i-n,s=r-t,u=Math.min(o,s),l=this.slice(n,i),c=e.slice(t,r),h=0;h<u;++h)if(l[h]!==c[h]){o=l[h],s=c[h];break}return o<s?-1:+(s<o)},a.prototype.includes=function(e,t,r){return -1!==this.indexOf(e,t,r)},a.prototype.indexOf=function(e,t,r){return y(this,e,t,r,!0)},a.prototype.lastIndexOf=function(e,t,r){return y(this,e,t,r,!1)},a.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else if(isFinite(t))t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var i,o,s,a,u,l,c,h,d=this.length-t;if((void 0===r||r>d)&&(r=d),e.length>0&&(r<0||t<0)||t>this.length)throw RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var f=!1;;)switch(n){case"hex":return function(e,t,r,n){r=Number(r)||0;var i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;var o=t.length;n>o/2&&(n=o/2);for(var s=0;s<n;++s){var a,u=parseInt(t.substr(2*s,2),16);if((a=u)!=a)break;e[r+s]=u}return s}(this,e,t,r);case"utf8":case"utf-8":return i=t,o=r,A(C(e,this.length-i),this,i,o);case"ascii":case"latin1":case"binary":return s=t,a=r,A(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(e),this,s,a);case"base64":return u=t,l=r,A(O(e),this,u,l);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return c=t,h=r,A(function(e,t){for(var r,n,i=[],o=0;o<e.length&&!((t-=2)<0);++o)n=(r=e.charCodeAt(o))>>8,i.push(r%256),i.push(n);return i}(e,this.length-c),this,c,h);default:if(f)throw TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),f=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},a.prototype.slice=function(e,t){var r=this.length;e=~~e,t=void 0===t?r:~~t,e<0?(e+=r)<0&&(e=0):e>r&&(e=r),t<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);var n=this.subarray(e,t);return Object.setPrototypeOf(n,a.prototype),n},a.prototype.readUintLE=a.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||w(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n},a.prototype.readUintBE=a.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||w(e,t,this.length);for(var n=this[e+--t],i=1;t>0&&(i*=256);)n+=this[e+--t]*i;return n},a.prototype.readUint8=a.prototype.readUInt8=function(e,t){return e>>>=0,t||w(e,1,this.length),this[e]},a.prototype.readUint16LE=a.prototype.readUInt16LE=function(e,t){return e>>>=0,t||w(e,2,this.length),this[e]|this[e+1]<<8},a.prototype.readUint16BE=a.prototype.readUInt16BE=function(e,t){return e>>>=0,t||w(e,2,this.length),this[e]<<8|this[e+1]},a.prototype.readUint32LE=a.prototype.readUInt32LE=function(e,t){return e>>>=0,t||w(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+0x1000000*this[e+3]},a.prototype.readUint32BE=a.prototype.readUInt32BE=function(e,t){return e>>>=0,t||w(e,4,this.length),0x1000000*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},a.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||w(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*t)),n},a.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||w(e,t,this.length);for(var n=t,i=1,o=this[e+--n];n>0&&(i*=256);)o+=this[e+--n]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},a.prototype.readInt8=function(e,t){return(e>>>=0,t||w(e,1,this.length),128&this[e])?-((255-this[e]+1)*1):this[e]},a.prototype.readInt16LE=function(e,t){e>>>=0,t||w(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?0xffff0000|r:r},a.prototype.readInt16BE=function(e,t){e>>>=0,t||w(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?0xffff0000|r:r},a.prototype.readInt32LE=function(e,t){return e>>>=0,t||w(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},a.prototype.readInt32BE=function(e,t){return e>>>=0,t||w(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},a.prototype.readFloatLE=function(e,t){return e>>>=0,t||w(e,4,this.length),i.read(this,e,!0,23,4)},a.prototype.readFloatBE=function(e,t){return e>>>=0,t||w(e,4,this.length),i.read(this,e,!1,23,4)},a.prototype.readDoubleLE=function(e,t){return e>>>=0,t||w(e,8,this.length),i.read(this,e,!0,52,8)},a.prototype.readDoubleBE=function(e,t){return e>>>=0,t||w(e,8,this.length),i.read(this,e,!1,52,8)},a.prototype.writeUintLE=a.prototype.writeUIntLE=function(e,t,r,n){if(e*=1,t>>>=0,r>>>=0,!n){var i=Math.pow(2,8*r)-1;_(this,e,t,r,i,0)}var o=1,s=0;for(this[t]=255&e;++s<r&&(o*=256);)this[t+s]=e/o&255;return t+r},a.prototype.writeUintBE=a.prototype.writeUIntBE=function(e,t,r,n){if(e*=1,t>>>=0,r>>>=0,!n){var i=Math.pow(2,8*r)-1;_(this,e,t,r,i,0)}var o=r-1,s=1;for(this[t+o]=255&e;--o>=0&&(s*=256);)this[t+o]=e/s&255;return t+r},a.prototype.writeUint8=a.prototype.writeUInt8=function(e,t,r){return e*=1,t>>>=0,r||_(this,e,t,1,255,0),this[t]=255&e,t+1},a.prototype.writeUint16LE=a.prototype.writeUInt16LE=function(e,t,r){return e*=1,t>>>=0,r||_(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},a.prototype.writeUint16BE=a.prototype.writeUInt16BE=function(e,t,r){return e*=1,t>>>=0,r||_(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},a.prototype.writeUint32LE=a.prototype.writeUInt32LE=function(e,t,r){return e*=1,t>>>=0,r||_(this,e,t,4,0xffffffff,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},a.prototype.writeUint32BE=a.prototype.writeUInt32BE=function(e,t,r){return e*=1,t>>>=0,r||_(this,e,t,4,0xffffffff,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},a.prototype.writeIntLE=function(e,t,r,n){if(e*=1,t>>>=0,!n){var i=Math.pow(2,8*r-1);_(this,e,t,r,i-1,-i)}var o=0,s=1,a=0;for(this[t]=255&e;++o<r&&(s*=256);)e<0&&0===a&&0!==this[t+o-1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+r},a.prototype.writeIntBE=function(e,t,r,n){if(e*=1,t>>>=0,!n){var i=Math.pow(2,8*r-1);_(this,e,t,r,i-1,-i)}var o=r-1,s=1,a=0;for(this[t+o]=255&e;--o>=0&&(s*=256);)e<0&&0===a&&0!==this[t+o+1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+r},a.prototype.writeInt8=function(e,t,r){return e*=1,t>>>=0,r||_(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},a.prototype.writeInt16LE=function(e,t,r){return e*=1,t>>>=0,r||_(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},a.prototype.writeInt16BE=function(e,t,r){return e*=1,t>>>=0,r||_(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},a.prototype.writeInt32LE=function(e,t,r){return e*=1,t>>>=0,r||_(this,e,t,4,0x7fffffff,-0x80000000),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},a.prototype.writeInt32BE=function(e,t,r){return e*=1,t>>>=0,r||_(this,e,t,4,0x7fffffff,-0x80000000),e<0&&(e=0xffffffff+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},a.prototype.writeFloatLE=function(e,t,r){return S(this,e,t,!0,r)},a.prototype.writeFloatBE=function(e,t,r){return S(this,e,t,!1,r)},a.prototype.writeDoubleLE=function(e,t,r){return E(this,e,t,!0,r)},a.prototype.writeDoubleBE=function(e,t,r){return E(this,e,t,!1,r)},a.prototype.copy=function(e,t,r,n){if(!a.isBuffer(e))throw TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r||0===e.length||0===this.length)return 0;if(t<0)throw RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw RangeError("Index out of range");if(n<0)throw RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var i=n-r;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,r,n):Uint8Array.prototype.set.call(e,this.subarray(r,n),t),i},a.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw TypeError("encoding must be a string");if("string"==typeof n&&!a.isEncoding(n))throw TypeError("Unknown encoding: "+n);if(1===e.length){var i,o=e.charCodeAt(0);("utf8"===n&&o<128||"latin1"===n)&&(e=o)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<r)throw RangeError("Out of range index");if(r<=t)return this;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(i=t;i<r;++i)this[i]=e;else{var s=a.isBuffer(e)?e:a.from(e,n),u=s.length;if(0===u)throw TypeError('The value "'+e+'" is invalid for argument "value"');for(i=0;i<r-t;++i)this[i+t]=s[i%u]}return this};var T=/[^+/0-9A-Za-z-_]/g;function C(e,t){t=t||1/0;for(var r,n=e.length,i=null,o=[],s=0;s<n;++s){if((r=e.charCodeAt(s))>55295&&r<57344){if(!i){if(r>56319||s+1===n){(t-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&o.push(239,191,189),i=r;continue}r=(i-55296<<10|r-56320)+65536}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;o.push(r)}else if(r<2048){if((t-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else if(r<1114112){if((t-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}else throw Error("Invalid code point")}return o}function O(e){return n.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(T,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function A(e,t,r,n){for(var i=0;i<n&&!(i+r>=t.length)&&!(i>=e.length);++i)t[i+r]=e[i];return i}function I(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}var P=function(){for(var e="0123456789abcdef",t=Array(256),r=0;r<16;++r)for(var n=16*r,i=0;i<16;++i)t[n+i]=e[r]+e[i];return t}()},5383:(e,t,r)=>{"use strict";r.d(t,{Cs:()=>f,Ct:()=>k,F3:()=>A,Gp:()=>C,Jn:()=>p,KY:()=>_,L:()=>P,OP:()=>c,SO:()=>O,VU:()=>v,Wx:()=>g,_9:()=>h,bu:()=>u,e5:()=>s,fL:()=>d,fS:()=>o,h2:()=>y,j7:()=>I,lT:()=>m,mG:()=>n,mJ:()=>a,pL:()=>l,q2:()=>w,qr:()=>S,r:()=>i,tt:()=>T,wX:()=>b,wu:()=>E});var n="-",i="AMP",o="".concat(i,"_unsent"),s="$default_instance",a="https://api2.amplitude.com/2/httpapi",u="https://api.eu.amplitude.com/2/httpapi",l="https://api2.amplitude.com/batch",c="https://api.eu.amplitude.com/batch",h="utm_campaign",d="utm_content",f="utm_id",p="utm_medium",v="utm_source",g="utm_term",y="dclid",m="fbclid",b="gbraid",w="gclid",_="ko_click_id",k="li_fat_id",S="msclkid",E="rdt_cid",T="ttclid",C="twclid",O="wbraid",A={utm_campaign:void 0,utm_content:void 0,utm_id:void 0,utm_medium:void 0,utm_source:void 0,utm_term:void 0,referrer:void 0,referring_domain:void 0,dclid:void 0,gbraid:void 0,gclid:void 0,fbclid:void 0,ko_click_id:void 0,li_fat_id:void 0,msclkid:void 0,rdt_cid:void 0,ttclid:void 0,twclid:void 0,wbraid:void 0},I=["access-control-allow-origin","access-control-allow-credentials","access-control-expose-headers","access-control-max-age","access-control-allow-methods","access-control-allow-headers","accept-patch","accept-ranges","age","allow","alt-svc","cache-control","connection","content-disposition","content-encoding","content-language","content-length","content-location","content-md5","content-range","content-type","date","delta-base","etag","expires","im","last-modified","link","location","permanent","p3p","pragma","proxy-authenticate","public-key-pins","retry-after","server","status","strict-transport-security","trailer","transfer-encoding","tk","upgrade","vary","via","warning","www-authenticate","x-b3-traceid","x-frame-options"],P=["authorization","cookie","set-cookie"]},6150:(e,t,r)=>{"use strict";let n;r.d(t,{createBrowserClient:()=>t1});let i=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>Promise.resolve().then(r.bind(r,91518)).then(({default:t})=>t(...e)):fetch),(...e)=>t(...e)};class o extends Error{constructor(e,t="FunctionsError",r){super(e),this.name=t,this.context=r}}class s extends o{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class a extends o{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class u extends o{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}!function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"}(g||(g={}));class l{constructor(e,{headers:t={},customFetch:r,region:n=g.Any}={}){this.url=e,this.headers=t,this.region=n,this.fetch=i(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var r,n,i,o,l;return n=this,i=void 0,o=void 0,l=function*(){try{let n,i;let{headers:o,method:l,body:c}=t,h={},{region:d}=t;d||(d=this.region);let f=new URL(`${this.url}/${e}`);d&&"any"!==d&&(h["x-region"]=d,f.searchParams.set("forceFunctionRegion",d)),c&&(o&&!Object.prototype.hasOwnProperty.call(o,"Content-Type")||!o)&&("undefined"!=typeof Blob&&c instanceof Blob||c instanceof ArrayBuffer?(h["Content-Type"]="application/octet-stream",n=c):"string"==typeof c?(h["Content-Type"]="text/plain",n=c):"undefined"!=typeof FormData&&c instanceof FormData?n=c:(h["Content-Type"]="application/json",n=JSON.stringify(c)));let p=yield this.fetch(f.toString(),{method:l||"POST",headers:Object.assign(Object.assign(Object.assign({},h),this.headers),o),body:n}).catch(e=>{throw new s(e)}),v=p.headers.get("x-relay-error");if(v&&"true"===v)throw new a(p);if(!p.ok)throw new u(p);let g=(null!==(r=p.headers.get("Content-Type"))&&void 0!==r?r:"text/plain").split(";")[0].trim();return{data:"application/json"===g?yield p.json():"application/octet-stream"===g?yield p.blob():"text/event-stream"===g?p:"multipart/form-data"===g?yield p.formData():yield p.text(),error:null,response:p}}catch(e){return{data:null,error:e,response:e instanceof u||e instanceof a?e.context:void 0}}},new(o||(o=Promise))(function(e,t){function r(e){try{a(l.next(e))}catch(e){t(e)}}function s(e){try{a(l.throw(e))}catch(e){t(e)}}function a(t){var n;t.done?e(t.value):((n=t.value)instanceof o?n:new o(function(e){e(n)})).then(r,s)}a((l=l.apply(n,i||[])).next())})}}let{PostgrestClient:c,PostgrestQueryBuilder:h,PostgrestFilterBuilder:d,PostgrestTransformBuilder:f,PostgrestBuilder:p,PostgrestError:v}=r(12029);var g,y,m,b,w,_,k,S,E,T,C,O=r(88986);class A{static detectEnvironment(){var e;if("undefined"!=typeof WebSocket)return{type:"native",constructor:WebSocket};if("undefined"!=typeof globalThis&&void 0!==globalThis.WebSocket)return{type:"native",constructor:globalThis.WebSocket};if(void 0!==r.g&&void 0!==r.g.WebSocket)return{type:"native",constructor:r.g.WebSocket};if("undefined"!=typeof globalThis&&void 0!==globalThis.WebSocketPair&&void 0===globalThis.WebSocket)return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if("undefined"!=typeof globalThis&&globalThis.EdgeRuntime||"undefined"!=typeof navigator&&(null===(e=navigator.userAgent)||void 0===e?void 0:e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(void 0!==O&&O.versions&&O.versions.node){let e=parseInt(O.versions.node.split(".")[0]);return e>=22?void 0!==globalThis.WebSocket?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${e} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${e} detected without native WebSocket support.`,workaround:'For Node.js < 22, install "ws" package and provide it via the transport option:\nimport ws from "ws"\nnew RealtimeClient(url, { transport: ws })'}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){let e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`

Suggested solution: ${e.workaround}`),Error(t)}static createWebSocket(e,t){return new(this.getWebSocketConstructor())(e,t)}static isWebSocketSupported(){try{let e=this.detectEnvironment();return"native"===e.type||"ws"===e.type}catch(e){return!1}}}!function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"}(y||(y={})),function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"}(m||(m={})),function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"}(b||(b={})),(w||(w={})).websocket="websocket",function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"}(_||(_={}));class I{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):"string"==typeof e?t(JSON.parse(e)):t({})}_binaryDecode(e){let t=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,t,r)}_decodeBroadcast(e,t,r){let n=t.getUint8(1),i=t.getUint8(2),o=this.HEADER_LENGTH+2,s=r.decode(e.slice(o,o+n));o+=n;let a=r.decode(e.slice(o,o+i));return o+=i,{ref:null,topic:s,event:a,payload:JSON.parse(r.decode(e.slice(o,e.byteLength)))}}}class P{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}!function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"}(k||(k={}));let x=(e,t,r={})=>{var n;let i=null!==(n=r.skipTypes)&&void 0!==n?n:[];return Object.keys(t).reduce((r,n)=>(r[n]=R(n,e,t,i),r),{})},R=(e,t,r,n)=>{let i=t.find(t=>t.name===e),o=null==i?void 0:i.type,s=r[e];return o&&!n.includes(o)?j(o,s):U(s)},j=(e,t)=>{if("_"===e.charAt(0))return D(t,e.slice(1,e.length));switch(e){case k.bool:return L(t);case k.float4:case k.float8:case k.int2:case k.int4:case k.int8:case k.numeric:case k.oid:return N(t);case k.json:case k.jsonb:return $(t);case k.timestamp:return H(t);case k.abstime:case k.date:case k.daterange:case k.int4range:case k.int8range:case k.money:case k.reltime:case k.text:case k.time:case k.timestamptz:case k.timetz:case k.tsrange:case k.tstzrange:default:return U(t)}},U=e=>e,L=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},N=e=>{if("string"==typeof e){let t=parseFloat(e);if(!Number.isNaN(t))return t}return e},$=e=>{if("string"==typeof e)try{return JSON.parse(e)}catch(e){console.log(`JSON parse error: ${e}`)}return e},D=(e,t)=>{if("string"!=typeof e)return e;let r=e.length-1,n=e[r];if("{"===e[0]&&"}"===n){let n;let i=e.slice(1,r);try{n=JSON.parse("["+i+"]")}catch(e){n=i?i.split(","):[]}return n.map(e=>j(t,e))}return e},H=e=>"string"==typeof e?e.replace(" ","T"):e,q=e=>{let t=e;return(t=(t=t.replace(/^ws/i,"http")).replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,"")).replace(/\/+$/,"")+"/api/broadcast"};class M{constructor(e,t,r={},n=1e4){this.channel=e,this.event=t,this.payload=r,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){!this._hasReceived("timeout")&&(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t(null===(r=this.receivedResp)||void 0===r?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){!this.timeoutTimer&&(this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref),this.channel._on(this.refEvent,{},e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)}),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout))}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(t=>t.status===e).forEach(e=>e.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}!function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"}(S||(S={}));class B{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};let r=(null==t?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},e=>{let{onJoin:t,onLeave:r,onSync:n}=this.caller;this.joinRef=this.channel._joinRef(),this.state=B.syncState(this.state,e,t,r),this.pendingDiffs.forEach(e=>{this.state=B.syncDiff(this.state,e,t,r)}),this.pendingDiffs=[],n()}),this.channel._on(r.diff,{},e=>{let{onJoin:t,onLeave:r,onSync:n}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(e):(this.state=B.syncDiff(this.state,e,t,r),n())}),this.onJoin((e,t,r)=>{this.channel._trigger("presence",{event:"join",key:e,currentPresences:t,newPresences:r})}),this.onLeave((e,t,r)=>{this.channel._trigger("presence",{event:"leave",key:e,currentPresences:t,leftPresences:r})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,r,n){let i=this.cloneDeep(e),o=this.transformState(t),s={},a={};return this.map(i,(e,t)=>{o[e]||(a[e]=t)}),this.map(o,(e,t)=>{let r=i[e];if(r){let n=t.map(e=>e.presence_ref),i=r.map(e=>e.presence_ref),o=t.filter(e=>0>i.indexOf(e.presence_ref)),u=r.filter(e=>0>n.indexOf(e.presence_ref));o.length>0&&(s[e]=o),u.length>0&&(a[e]=u)}else s[e]=t}),this.syncDiff(i,{joins:s,leaves:a},r,n)}static syncDiff(e,t,r,n){let{joins:i,leaves:o}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),n||(n=()=>{}),this.map(i,(t,n)=>{var i;let o=null!==(i=e[t])&&void 0!==i?i:[];if(e[t]=this.cloneDeep(n),o.length>0){let r=e[t].map(e=>e.presence_ref),n=o.filter(e=>0>r.indexOf(e.presence_ref));e[t].unshift(...n)}r(t,o,n)}),this.map(o,(t,r)=>{let i=e[t];if(!i)return;let o=r.map(e=>e.presence_ref);i=i.filter(e=>0>o.indexOf(e.presence_ref)),e[t]=i,n(t,i,r),0===i.length&&delete e[t]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(r=>t(r,e[r]))}static transformState(e){return Object.getOwnPropertyNames(e=this.cloneDeep(e)).reduce((t,r)=>{let n=e[r];return"metas"in n?t[r]=n.metas.map(e=>(e.presence_ref=e.phx_ref,delete e.phx_ref,delete e.phx_ref_prev,e)):t[r]=n,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}!function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"}(E||(E={})),function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"}(T||(T={})),function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"}(C||(C={}));class F{constructor(e,t={config:{}},r){this.topic=e,this.params=t,this.socket=r,this.bindings={},this.state=m.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new M(this,b.join,this.params,this.timeout),this.rejoinTimer=new P(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=m.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(e=>e.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=m.closed,this.socket._remove(this)}),this._onError(e=>{!(this._isLeaving()||this._isClosed())&&(this.socket.log("channel",`error ${this.topic}`,e),this.state=m.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=m.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",e=>{!(this._isLeaving()||this._isClosed())&&(this.socket.log("channel",`error ${this.topic}`,e),this.state=m.errored,this.rejoinTimer.scheduleTimeout())}),this._on(b.reply,{},(e,t)=>{this._trigger(this._replyEventName(t),e)}),this.presence=new B(this),this.broadcastEndpointURL=q(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var r,n;if(this.socket.isConnected()||this.socket.connect(),this.state==m.closed){let{config:{broadcast:i,presence:o,private:s}}=this.params,a=null!==(n=null===(r=this.bindings.postgres_changes)||void 0===r?void 0:r.map(e=>e.filter))&&void 0!==n?n:[],u=!!this.bindings[T.PRESENCE]&&this.bindings[T.PRESENCE].length>0,l={},c={broadcast:i,presence:Object.assign(Object.assign({},o),{enabled:u}),postgres_changes:a,private:s};this.socket.accessTokenValue&&(l.access_token=this.socket.accessTokenValue),this._onError(t=>null==e?void 0:e(C.CHANNEL_ERROR,t)),this._onClose(()=>null==e?void 0:e(C.CLOSED)),this.updateJoinPayload(Object.assign({config:c},l)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:t})=>{var r;if(this.socket.setAuth(),void 0===t){null==e||e(C.SUBSCRIBED);return}{let n=this.bindings.postgres_changes,i=null!==(r=null==n?void 0:n.length)&&void 0!==r?r:0,o=[];for(let r=0;r<i;r++){let i=n[r],{filter:{event:s,schema:a,table:u,filter:l}}=i,c=t&&t[r];if(c&&c.event===s&&c.schema===a&&c.table===u&&c.filter===l)o.push(Object.assign(Object.assign({},i),{id:c.id}));else{this.unsubscribe(),this.state=m.errored,null==e||e(C.CHANNEL_ERROR,Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=o,e&&e(C.SUBSCRIBED);return}}).receive("error",t=>{this.state=m.errored,null==e||e(C.CHANNEL_ERROR,Error(JSON.stringify(Object.values(t).join(", ")||"error")))}).receive("timeout",()=>{null==e||e(C.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,r){return this.state===m.joined&&e===T.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,t,r)}async send(e,t={}){var r,n;if(this._canPush()||"broadcast"!==e.type)return new Promise(r=>{var n,i,o;let s=this._push(e.type,e,t.timeout||this.timeout);"broadcast"!==e.type||(null===(o=null===(i=null===(n=this.params)||void 0===n?void 0:n.config)||void 0===i?void 0:i.broadcast)||void 0===o?void 0:o.ack)||r("ok"),s.receive("ok",()=>r("ok")),s.receive("error",()=>r("error")),s.receive("timeout",()=>r("timed out"))});{let{event:i,payload:o}=e,s={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{let e=await this._fetchWithTimeout(this.broadcastEndpointURL,s,null!==(r=t.timeout)&&void 0!==r?r:this.timeout);return await (null===(n=e.body)||void 0===n?void 0:n.cancel()),e.ok?"ok":"error"}catch(e){if("AbortError"===e.name)return"timed out";return"error"}}}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=m.leaving;let t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(b.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(n=>{(r=new M(this,b.leave,{},e)).receive("ok",()=>{t(),n("ok")}).receive("timeout",()=>{t(),n("timed out")}).receive("error",()=>{n("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{null==r||r.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=m.closed,this.bindings={}}async _fetchWithTimeout(e,t,r){let n=new AbortController,i=setTimeout(()=>n.abort(),r),o=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:n.signal}));return clearTimeout(i),o}_push(e,t,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new M(this,e,t,r);return this._canPush()?n.send():this._addToPushBuffer(n),n}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>100){let e=this.pushBuffer.shift();e&&(e.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${e.event}`,e.payload))}}_onMessage(e,t,r){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,r){var n,i;let o=e.toLocaleLowerCase(),{close:s,error:a,leave:u,join:l}=b;if(r&&[s,a,u,l].indexOf(o)>=0&&r!==this._joinRef())return;let c=this._onMessage(o,t,r);if(t&&!c)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?null===(n=this.bindings.postgres_changes)||void 0===n||n.filter(e=>{var t,r,n;return(null===(t=e.filter)||void 0===t?void 0:t.event)==="*"||(null===(n=null===(r=e.filter)||void 0===r?void 0:r.event)||void 0===n?void 0:n.toLocaleLowerCase())===o}).map(e=>e.callback(c,r)):null===(i=this.bindings[o])||void 0===i||i.filter(e=>{var r,n,i,s,a,u;if(!["broadcast","presence","postgres_changes"].includes(o))return e.type.toLocaleLowerCase()===o;if("id"in e){let o=e.id,s=null===(r=e.filter)||void 0===r?void 0:r.event;return o&&(null===(n=t.ids)||void 0===n?void 0:n.includes(o))&&("*"===s||(null==s?void 0:s.toLocaleLowerCase())===(null===(i=t.data)||void 0===i?void 0:i.type.toLocaleLowerCase()))}{let r=null===(a=null===(s=null==e?void 0:e.filter)||void 0===s?void 0:s.event)||void 0===a?void 0:a.toLocaleLowerCase();return"*"===r||r===(null===(u=null==t?void 0:t.event)||void 0===u?void 0:u.toLocaleLowerCase())}}).map(e=>{if("object"==typeof c&&"ids"in c){let e=c.data,{schema:t,table:r,commit_timestamp:n,type:i,errors:o}=e;c=Object.assign(Object.assign({},{schema:t,table:r,commit_timestamp:n,eventType:i,new:{},old:{},errors:o}),this._getPayloadRecords(e))}e.callback(c,r)})}_isClosed(){return this.state===m.closed}_isJoined(){return this.state===m.joined}_isJoining(){return this.state===m.joining}_isLeaving(){return this.state===m.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,r){let n=e.toLocaleLowerCase(),i={type:n,filter:t,callback:r};return this.bindings[n]?this.bindings[n].push(i):this.bindings[n]=[i],this}_off(e,t){let r=e.toLocaleLowerCase();return this.bindings[r]&&(this.bindings[r]=this.bindings[r].filter(e=>{var n;return!((null===(n=e.type)||void 0===n?void 0:n.toLocaleLowerCase())===r&&F.isEqual(e.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(let r in e)if(e[r]!==t[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(b.close,{},e)}_onError(e){this._on(b.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){!this._isLeaving()&&(this.socket._leaveOpenTopic(this.topic),this.state=m.joining,this.joinPush.resend(e))}_getPayloadRecords(e){let t={new:{},old:{}};return("INSERT"===e.type||"UPDATE"===e.type)&&(t.new=x(e.columns,e.record)),("UPDATE"===e.type||"DELETE"===e.type)&&(t.old=x(e.columns,e.old_record)),t}}let z=()=>{},W={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},J=[1e3,2e3,5e3,1e4],Y=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class K{constructor(e,t){var n;if(this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=1e4,this.transport=null,this.heartbeatIntervalMs=W.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=z,this.ref=0,this.reconnectTimer=null,this.logger=z,this.conn=null,this.sendBuffer=[],this.serializer=new I,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>Promise.resolve().then(r.bind(r,91518)).then(({default:t})=>t(...e)).catch(e=>{throw Error(`Failed to load @supabase/node-fetch: ${e.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):fetch),(...e)=>t(...e)},!(null===(n=null==t?void 0:t.params)||void 0===n?void 0:n.apikey))throw Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${w.websocket}`,this.httpEndpoint=q(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(null==t?void 0:t.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||null!==this.conn&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=A.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");let e=t.message;if(e.includes("Node.js"))throw Error(`${e}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`);throw Error(`WebSocket not available: ${e}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:"1.0.0"}))}disconnect(e,t){if(!this.isDisconnecting()){if(this._setConnectionState("disconnecting",!0),this.conn){let r=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(r),this._setConnectionState("disconnected")},e?this.conn.close(e,null!=t?t:""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}}getChannels(){return this.channels}async removeChannel(e){let t=await e.unsubscribe();return 0===this.channels.length&&this.disconnect(),t}async removeAllChannels(){let e=await Promise.all(this.channels.map(e=>e.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,r){this.logger(e,t,r)}connectionState(){switch(this.conn&&this.conn.readyState){case y.connecting:return _.Connecting;case y.open:return _.Open;case y.closing:return _.Closing;default:return _.Closed}}isConnected(){return this.connectionState()===_.Open}isConnecting(){return"connecting"===this._connectionState}isDisconnecting(){return"disconnecting"===this._connectionState}channel(e,t={config:{}}){let r=`realtime:${e}`,n=this.getChannels().find(e=>e.topic===r);if(n)return n;{let r=new F(`realtime:${e}`,t,this);return this.channels.push(r),r}}push(e){let{topic:t,event:r,payload:n,ref:i}=e,o=()=>{this.encode(e,e=>{var t;null===(t=this.conn)||void 0===t||t.send(e)})};this.log("push",`${t} ${r} (${i})`,n),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),this._wasManualDisconnect=!1,null===(e=this.conn)||void 0===e||e.close(1e3,"heartbeat timeout"),setTimeout(()=>{var e;this.isConnected()||null===(e=this.reconnectTimer)||void 0===e||e.scheduleTimeout()},W.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(t=>t.topic===e&&(t._isJoined()||t._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,e=>{"phoenix"===e.topic&&"phx_reply"===e.event&&this.heartbeatCallback("ok"===e.payload.status?"ok":"error"),e.ref&&e.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);let{topic:t,event:r,payload:n,ref:i}=e,o=i?`(${i})`:"",s=n.status||"";this.log("receive",`${s} ${t} ${r} ${o}`.trim(),n),this.channels.filter(e=>e._isMember(t)).forEach(e=>e._trigger(r,n,i)),this._triggerStateCallbacks("message",e)})}_clearTimer(e){var t;"heartbeat"===e&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):"reconnect"===e&&(null===(t=this.reconnectTimer)||void 0===t||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");let e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this.workerRef.terminate()},this.workerRef.onmessage=e=>{"keepAlive"===e.data.event&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||null===(t=this.reconnectTimer)||void 0===t||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(b.error))}_appendParams(e,t){if(0===Object.keys(t).length)return e;let r=e.match(/\?/)?"&":"?",n=new URLSearchParams(t);return`${e}${r}${n}`}_workerObjectUrl(e){let t;if(e)t=e;else{let e=new Blob([Y],{type:"application/javascript"});t=URL.createObjectURL(e)}return t}_setConnectionState(e,t=!1){this._connectionState=e,"connecting"===e?this._wasManualDisconnect=!1:"disconnecting"===e&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t;t=e||(this.accessToken?await this.accessToken():this.accessTokenValue),this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(e=>{t&&e.updateJoinPayload({access_token:t,version:"realtime-js/2.15.1"}),e.joinedOnce&&e._isJoined()&&e._push(b.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(t=>{this.log("error",`error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(r=>{try{r(t)}catch(t){this.log("error",`error in ${e} callback`,t)}})}catch(t){this.log("error",`error triggering ${e} callbacks`,t)}}_setupReconnectionTimer(){this.reconnectTimer=new P(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},W.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var t,r,n,i,o,s,a,u;if(this.transport=null!==(t=null==e?void 0:e.transport)&&void 0!==t?t:null,this.timeout=null!==(r=null==e?void 0:e.timeout)&&void 0!==r?r:1e4,this.heartbeatIntervalMs=null!==(n=null==e?void 0:e.heartbeatIntervalMs)&&void 0!==n?n:W.HEARTBEAT_INTERVAL,this.worker=null!==(i=null==e?void 0:e.worker)&&void 0!==i&&i,this.accessToken=null!==(o=null==e?void 0:e.accessToken)&&void 0!==o?o:null,(null==e?void 0:e.params)&&(this.params=e.params),(null==e?void 0:e.logger)&&(this.logger=e.logger),((null==e?void 0:e.logLevel)||(null==e?void 0:e.log_level))&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=null!==(s=null==e?void 0:e.reconnectAfterMs)&&void 0!==s?s:e=>J[e-1]||1e4,this.encode=null!==(a=null==e?void 0:e.encode)&&void 0!==a?a:(e,t)=>t(JSON.stringify(e)),this.decode=null!==(u=null==e?void 0:e.decode)&&void 0!==u?u:this.serializer.decode.bind(this.serializer),this.worker){if("undefined"!=typeof window&&!window.Worker)throw Error("Web Worker is not supported");this.workerUrl=null==e?void 0:e.workerUrl}}}class V extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function G(e){return"object"==typeof e&&null!==e&&"__isStorageError"in e}class X extends V{constructor(e,t,r){super(e),this.name="StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Q extends V{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}let Z=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>Promise.resolve().then(r.bind(r,91518)).then(({default:t})=>t(...e)):fetch),(...e)=>t(...e)},ee=()=>(function(e,t,r,n){return new(r||(r=Promise))(function(i,o){function s(e){try{u(n.next(e))}catch(e){o(e)}}function a(e){try{u(n.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(s,a)}u((n=n.apply(e,t||[])).next())})})(void 0,void 0,void 0,function*(){return"undefined"==typeof Response?(yield Promise.resolve().then(r.bind(r,91518))).Response:Response}),et=e=>{if(Array.isArray(e))return e.map(e=>et(e));if("function"==typeof e||e!==Object(e))return e;let t={};return Object.entries(e).forEach(([e,r])=>{t[e.replace(/([-_][a-z])/gi,e=>e.toUpperCase().replace(/[-_]/g,""))]=et(r)}),t},er=e=>{if("object"!=typeof e||null===e)return!1;let t=Object.getPrototypeOf(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)};var en=function(e,t,r,n){return new(r||(r=Promise))(function(i,o){function s(e){try{u(n.next(e))}catch(e){o(e)}}function a(e){try{u(n.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(s,a)}u((n=n.apply(e,t||[])).next())})};let ei=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),eo=(e,t,r)=>en(void 0,void 0,void 0,function*(){e instanceof(yield ee())&&!(null==r?void 0:r.noResolveJson)?e.json().then(r=>{let n=e.status||500,i=(null==r?void 0:r.statusCode)||n+"";t(new X(ei(r),n,i))}).catch(e=>{t(new Q(ei(e),e))}):t(new Q(ei(e),e))}),es=(e,t,r,n)=>{let i={method:e,headers:(null==t?void 0:t.headers)||{}};return"GET"!==e&&n?(er(n)?(i.headers=Object.assign({"Content-Type":"application/json"},null==t?void 0:t.headers),i.body=JSON.stringify(n)):i.body=n,(null==t?void 0:t.duplex)&&(i.duplex=t.duplex),Object.assign(Object.assign({},i),r)):i};function ea(e,t,r,n,i,o){return en(this,void 0,void 0,function*(){return new Promise((s,a)=>{e(r,es(t,n,i,o)).then(e=>{if(!e.ok)throw e;return(null==n?void 0:n.noResolveJson)?e:e.json()}).then(e=>s(e)).catch(e=>eo(e,a,n))})})}function eu(e,t,r,n){return en(this,void 0,void 0,function*(){return ea(e,"GET",t,r,n)})}function el(e,t,r,n,i){return en(this,void 0,void 0,function*(){return ea(e,"POST",t,n,i,r)})}function ec(e,t,r,n,i){return en(this,void 0,void 0,function*(){return ea(e,"PUT",t,n,i,r)})}function eh(e,t,r,n,i){return en(this,void 0,void 0,function*(){return ea(e,"DELETE",t,n,i,r)})}var ed=r(855).hp,ef=function(e,t,r,n){return new(r||(r=Promise))(function(i,o){function s(e){try{u(n.next(e))}catch(e){o(e)}}function a(e){try{u(n.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(s,a)}u((n=n.apply(e,t||[])).next())})};let ep={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},ev={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class eg{constructor(e,t={},r,n){this.url=e,this.headers=t,this.bucketId=r,this.fetch=Z(n)}uploadOrUpdate(e,t,r,n){return ef(this,void 0,void 0,function*(){try{let i;let o=Object.assign(Object.assign({},ev),n),s=Object.assign(Object.assign({},this.headers),"POST"===e&&{"x-upsert":String(o.upsert)}),a=o.metadata;"undefined"!=typeof Blob&&r instanceof Blob?((i=new FormData).append("cacheControl",o.cacheControl),a&&i.append("metadata",this.encodeMetadata(a)),i.append("",r)):"undefined"!=typeof FormData&&r instanceof FormData?((i=r).append("cacheControl",o.cacheControl),a&&i.append("metadata",this.encodeMetadata(a))):(i=r,s["cache-control"]=`max-age=${o.cacheControl}`,s["content-type"]=o.contentType,a&&(s["x-metadata"]=this.toBase64(this.encodeMetadata(a)))),(null==n?void 0:n.headers)&&(s=Object.assign(Object.assign({},s),n.headers));let u=this._removeEmptyFolders(t),l=this._getFinalPath(u),c=yield("PUT"==e?ec:el)(this.fetch,`${this.url}/object/${l}`,i,Object.assign({headers:s},(null==o?void 0:o.duplex)?{duplex:o.duplex}:{}));return{data:{path:u,id:c.Id,fullPath:c.Key},error:null}}catch(e){if(G(e))return{data:null,error:e};throw e}})}upload(e,t,r){return ef(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,r)})}uploadToSignedUrl(e,t,r,n){return ef(this,void 0,void 0,function*(){let i=this._removeEmptyFolders(e),o=this._getFinalPath(i),s=new URL(this.url+`/object/upload/sign/${o}`);s.searchParams.set("token",t);try{let e;let t=Object.assign({upsert:ev.upsert},n),o=Object.assign(Object.assign({},this.headers),{"x-upsert":String(t.upsert)});"undefined"!=typeof Blob&&r instanceof Blob?((e=new FormData).append("cacheControl",t.cacheControl),e.append("",r)):"undefined"!=typeof FormData&&r instanceof FormData?(e=r).append("cacheControl",t.cacheControl):(e=r,o["cache-control"]=`max-age=${t.cacheControl}`,o["content-type"]=t.contentType);let a=yield ec(this.fetch,s.toString(),e,{headers:o});return{data:{path:i,fullPath:a.Key},error:null}}catch(e){if(G(e))return{data:null,error:e};throw e}})}createSignedUploadUrl(e,t){return ef(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e),n=Object.assign({},this.headers);(null==t?void 0:t.upsert)&&(n["x-upsert"]="true");let i=yield el(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:n}),o=new URL(this.url+i.url),s=o.searchParams.get("token");if(!s)throw new V("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:s},error:null}}catch(e){if(G(e))return{data:null,error:e};throw e}})}update(e,t,r){return ef(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,r)})}move(e,t,r){return ef(this,void 0,void 0,function*(){try{return{data:yield el(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null==r?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(e){if(G(e))return{data:null,error:e};throw e}})}copy(e,t,r){return ef(this,void 0,void 0,function*(){try{return{data:{path:(yield el(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null==r?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(e){if(G(e))return{data:null,error:e};throw e}})}createSignedUrl(e,t,r){return ef(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e),i=yield el(this.fetch,`${this.url}/object/sign/${n}`,Object.assign({expiresIn:t},(null==r?void 0:r.transform)?{transform:r.transform}:{}),{headers:this.headers}),o=(null==r?void 0:r.download)?`&download=${!0===r.download?"":r.download}`:"";return{data:i={signedUrl:encodeURI(`${this.url}${i.signedURL}${o}`)},error:null}}catch(e){if(G(e))return{data:null,error:e};throw e}})}createSignedUrls(e,t,r){return ef(this,void 0,void 0,function*(){try{let n=yield el(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),i=(null==r?void 0:r.download)?`&download=${!0===r.download?"":r.download}`:"";return{data:n.map(e=>Object.assign(Object.assign({},e),{signedUrl:e.signedURL?encodeURI(`${this.url}${e.signedURL}${i}`):null})),error:null}}catch(e){if(G(e))return{data:null,error:e};throw e}})}download(e,t){return ef(this,void 0,void 0,function*(){let r=void 0!==(null==t?void 0:t.transform),n=this.transformOptsToQueryString((null==t?void 0:t.transform)||{}),i=n?`?${n}`:"";try{let t=this._getFinalPath(e),n=yield eu(this.fetch,`${this.url}/${r?"render/image/authenticated":"object"}/${t}${i}`,{headers:this.headers,noResolveJson:!0});return{data:yield n.blob(),error:null}}catch(e){if(G(e))return{data:null,error:e};throw e}})}info(e){return ef(this,void 0,void 0,function*(){let t=this._getFinalPath(e);try{let e=yield eu(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:et(e),error:null}}catch(e){if(G(e))return{data:null,error:e};throw e}})}exists(e){return ef(this,void 0,void 0,function*(){let t=this._getFinalPath(e);try{return yield function(e,t,r,n){return en(this,void 0,void 0,function*(){return ea(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),void 0)})}(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(e){if(G(e)&&e instanceof Q){let t=e.originalError;if([400,404].includes(null==t?void 0:t.status))return{data:!1,error:e}}throw e}})}getPublicUrl(e,t){let r=this._getFinalPath(e),n=[],i=(null==t?void 0:t.download)?`download=${!0===t.download?"":t.download}`:"";""!==i&&n.push(i);let o=void 0!==(null==t?void 0:t.transform),s=this.transformOptsToQueryString((null==t?void 0:t.transform)||{});""!==s&&n.push(s);let a=n.join("&");return""!==a&&(a=`?${a}`),{data:{publicUrl:encodeURI(`${this.url}/${o?"render/image":"object"}/public/${r}${a}`)}}}remove(e){return ef(this,void 0,void 0,function*(){try{return{data:yield eh(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(e){if(G(e))return{data:null,error:e};throw e}})}list(e,t,r){return ef(this,void 0,void 0,function*(){try{let n=Object.assign(Object.assign(Object.assign({},ep),t),{prefix:e||""});return{data:yield el(this.fetch,`${this.url}/object/list/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(e){if(G(e))return{data:null,error:e};throw e}})}listV2(e,t){return ef(this,void 0,void 0,function*(){try{let r=Object.assign({},e);return{data:yield el(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,r,{headers:this.headers},t),error:null}}catch(e){if(G(e))return{data:null,error:e};throw e}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return void 0!==ed?ed.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){let t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}let ey={"X-Client-Info":"storage-js/2.11.0"};var em=function(e,t,r,n){return new(r||(r=Promise))(function(i,o){function s(e){try{u(n.next(e))}catch(e){o(e)}}function a(e){try{u(n.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(s,a)}u((n=n.apply(e,t||[])).next())})};class eb{constructor(e,t={},r,n){let i=new URL(e);(null==n?void 0:n.useNewHostname)&&/supabase\.(co|in|red)$/.test(i.hostname)&&!i.hostname.includes("storage.supabase.")&&(i.hostname=i.hostname.replace("supabase.","storage.supabase.")),this.url=i.href,this.headers=Object.assign(Object.assign({},ey),t),this.fetch=Z(r)}listBuckets(){return em(this,void 0,void 0,function*(){try{return{data:yield eu(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(G(e))return{data:null,error:e};throw e}})}getBucket(e){return em(this,void 0,void 0,function*(){try{return{data:yield eu(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(e){if(G(e))return{data:null,error:e};throw e}})}createBucket(e,t={public:!1}){return em(this,void 0,void 0,function*(){try{return{data:yield el(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(e){if(G(e))return{data:null,error:e};throw e}})}updateBucket(e,t){return em(this,void 0,void 0,function*(){try{return{data:yield ec(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(e){if(G(e))return{data:null,error:e};throw e}})}emptyBucket(e){return em(this,void 0,void 0,function*(){try{return{data:yield el(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(e){if(G(e))return{data:null,error:e};throw e}})}deleteBucket(e){return em(this,void 0,void 0,function*(){try{return{data:yield eh(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(e){if(G(e))return{data:null,error:e};throw e}})}}class ew extends eb{constructor(e,t={},r,n){super(e,t,r,n)}from(e){return new eg(this.url,this.headers,e,this.fetch)}}let e_="";e_="undefined"!=typeof Deno?"deno":"undefined"!=typeof document?"web":"undefined"!=typeof navigator&&"ReactNative"===navigator.product?"react-native":"node";let ek={headers:{"X-Client-Info":`supabase-js-${e_}/2.56.0`}},eS={schema:"public"},eE={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},eT={};var eC=r(91518);let eO=e=>{let t;return t=e||("undefined"==typeof fetch?eC.default:fetch),(...e)=>t(...e)},eA=()=>"undefined"==typeof Headers?eC.Headers:Headers,eI=(e,t,r)=>{let n=eO(r),i=eA();return(r,o)=>(function(e,t,r,n){return new(r||(r=Promise))(function(i,o){function s(e){try{u(n.next(e))}catch(e){o(e)}}function a(e){try{u(n.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(s,a)}u((n=n.apply(e,t||[])).next())})})(void 0,void 0,void 0,function*(){var s;let a=null!==(s=yield t())&&void 0!==s?s:e,u=new i(null==o?void 0:o.headers);return u.has("apikey")||u.set("apikey",e),u.has("Authorization")||u.set("Authorization",`Bearer ${a}`),n(r,Object.assign(Object.assign({},o),{headers:u}))})},eP="2.71.1",ex={"X-Client-Info":`gotrue-js/${eP}`},eR="X-Supabase-Api-Version",ej={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},eU=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i;class eL extends Error{constructor(e,t,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=r}}function eN(e){return"object"==typeof e&&null!==e&&"__isAuthError"in e}class e$ extends eL{constructor(e,t,r){super(e,t,r),this.name="AuthApiError",this.status=t,this.code=r}}class eD extends eL{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class eH extends eL{constructor(e,t,r,n){super(e,r,n),this.name=t,this.status=r}}class eq extends eH{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}class eM extends eH{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class eB extends eH{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class eF extends eH{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class ez extends eH{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class eW extends eH{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function eJ(e){return eN(e)&&"AuthRetryableFetchError"===e.name}class eY extends eH{constructor(e,t,r){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=r}}class eK extends eH{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}let eV="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),eG=" 	\n\r=".split(""),eX=(()=>{let e=Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<eG.length;t+=1)e[eG[t].charCodeAt(0)]=-2;for(let t=0;t<eV.length;t+=1)e[eV[t].charCodeAt(0)]=t;return e})();function eQ(e,t,r){if(null!==e)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;)r(eV[t.queue>>t.queuedBits-6&63]),t.queuedBits-=6;else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;)r(eV[t.queue>>t.queuedBits-6&63]),t.queuedBits-=6}function eZ(e,t,r){let n=eX[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else if(-2===n)return;else throw Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}function e0(e){let t=[],r=e=>{t.push(String.fromCodePoint(e))},n={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},o=e=>{!function(e,t,r){if(0===t.utf8seq){if(e<=127){r(e);return}for(let r=1;r<6;r+=1)if((e>>7-r&1)==0){t.utf8seq=r;break}if(2===t.utf8seq)t.codepoint=31&e;else if(3===t.utf8seq)t.codepoint=15&e;else if(4===t.utf8seq)t.codepoint=7&e;else throw Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|63&e,t.utf8seq-=1,0===t.utf8seq&&r(t.codepoint)}}(e,n,r)};for(let t=0;t<e.length;t+=1)eZ(e.charCodeAt(t),i,o);return t.join("")}let e1=()=>"undefined"!=typeof window&&"undefined"!=typeof document,e2={tested:!1,writable:!1},e3=()=>{if(!e1())return!1;try{if("object"!=typeof globalThis.localStorage)return!1}catch(e){return!1}if(e2.tested)return e2.writable;let e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),e2.tested=!0,e2.writable=!0}catch(e){e2.tested=!0,e2.writable=!1}return e2.writable},e4=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>Promise.resolve().then(r.bind(r,91518)).then(({default:t})=>t(...e)):fetch),(...e)=>t(...e)},e5=e=>"object"==typeof e&&null!==e&&"status"in e&&"ok"in e&&"json"in e&&"function"==typeof e.json,e6=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},e8=async(e,t)=>{let r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch(e){return r}},e9=async(e,t)=>{await e.removeItem(t)};class e7{constructor(){this.promise=new e7.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}function te(e){let t=e.split(".");if(3!==t.length)throw new eK("Invalid JWT structure");for(let e=0;e<t.length;e++)if(!eU.test(t[e]))throw new eK("JWT not in base64url format");return{header:JSON.parse(e0(t[0])),payload:JSON.parse(e0(t[1])),signature:function(e){let t=[],r={queue:0,queuedBits:0},n=e=>{t.push(e)};for(let t=0;t<e.length;t+=1)eZ(e.charCodeAt(t),r,n);return new Uint8Array(t)}(t[2]),raw:{header:t[0],payload:t[1]}}}async function tt(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function tr(e){return("0"+e.toString(16)).substr(-2)}async function tn(e){let t=new TextEncoder().encode(e);return Array.from(new Uint8Array(await crypto.subtle.digest("SHA-256",t))).map(e=>String.fromCharCode(e)).join("")}async function ti(e){return"undefined"==typeof crypto||void 0===crypto.subtle||"undefined"==typeof TextEncoder?(console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e):btoa(await tn(e)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function to(e,t,r=!1){let n=function(){let e=new Uint32Array(56);if("undefined"==typeof crypto){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",t=e.length,r="";for(let n=0;n<56;n++)r+=e.charAt(Math.floor(Math.random()*t));return r}return crypto.getRandomValues(e),Array.from(e,tr).join("")}(),i=n;r&&(i+="/PASSWORD_RECOVERY"),await e6(e,`${t}-code-verifier`,i);let o=await ti(n),s=n===o?"plain":"s256";return[o,s]}e7.promiseConstructor=Promise;let ts=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i,ta=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function tu(e){if(!ta.test(e))throw Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function tl(){return new Proxy({},{get:(e,t)=>{if("__isUserNotAvailableProxy"===t)return!0;if("symbol"==typeof t){let e=t.toString();if("Symbol(Symbol.toPrimitive)"===e||"Symbol(Symbol.toStringTag)"===e||"Symbol(util.inspect.custom)"===e)return}throw Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function tc(e){return JSON.parse(JSON.stringify(e))}var th=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>t.indexOf(n)&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)0>t.indexOf(n[i])&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r};let td=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),tf=[502,503,504];async function tp(e){var t;let r,n;if(!e5(e))throw new eW(td(e),0);if(tf.includes(e.status))throw new eW(td(e),e.status);try{r=await e.json()}catch(e){throw new eD(td(e),e)}let i=function(e){let t=e.headers.get(eR);if(!t||!t.match(ts))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch(e){return null}}(e);if(i&&i.getTime()>=ej["2024-01-01"].timestamp&&"object"==typeof r&&r&&"string"==typeof r.code?n=r.code:"object"==typeof r&&r&&"string"==typeof r.error_code&&(n=r.error_code),n){if("weak_password"===n)throw new eY(td(r),e.status,(null===(t=r.weak_password)||void 0===t?void 0:t.reasons)||[]);if("session_not_found"===n)throw new eq}else if("object"==typeof r&&r&&"object"==typeof r.weak_password&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((e,t)=>e&&"string"==typeof t,!0))throw new eY(td(r),e.status,r.weak_password.reasons);throw new e$(td(r),e.status||500,n)}let tv=(e,t,r,n)=>{let i={method:e,headers:(null==t?void 0:t.headers)||{}};return"GET"===e?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},null==t?void 0:t.headers),i.body=JSON.stringify(n),Object.assign(Object.assign({},i),r))};async function tg(e,t,r,n){var i;let o=Object.assign({},null==n?void 0:n.headers);o[eR]||(o[eR]=ej["2024-01-01"].name),(null==n?void 0:n.jwt)&&(o.Authorization=`Bearer ${n.jwt}`);let s=null!==(i=null==n?void 0:n.query)&&void 0!==i?i:{};(null==n?void 0:n.redirectTo)&&(s.redirect_to=n.redirectTo);let a=Object.keys(s).length?"?"+new URLSearchParams(s).toString():"",u=await ty(e,t,r+a,{headers:o,noResolveJson:null==n?void 0:n.noResolveJson},{},null==n?void 0:n.body);return(null==n?void 0:n.xform)?null==n?void 0:n.xform(u):{data:Object.assign({},u),error:null}}async function ty(e,t,r,n,i,o){let s;let a=tv(t,n,i,o);try{s=await e(r,Object.assign({},a))}catch(e){throw console.error(e),new eW(td(e),0)}if(s.ok||await tp(s),null==n?void 0:n.noResolveJson)return s;try{return await s.json()}catch(e){await tp(e)}}function tm(e){var t,r,n;let i=null;if((n=e).access_token&&n.refresh_token&&n.expires_in&&(i=Object.assign({},e),!e.expires_at))i.expires_at=(r=e.expires_in,Math.round(Date.now()/1e3)+r);return{data:{session:i,user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function tb(e){let t=tm(e);return!t.error&&e.weak_password&&"object"==typeof e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&"string"==typeof e.weak_password.message&&e.weak_password.reasons.reduce((e,t)=>e&&"string"==typeof t,!0)&&(t.data.weak_password=e.weak_password),t}function tw(e){var t;return{data:{user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function t_(e){return{data:e,error:null}}function tk(e){let{action_link:t,email_otp:r,hashed_token:n,redirect_to:i,verification_type:o}=e;return{data:{properties:{action_link:t,email_otp:r,hashed_token:n,redirect_to:i,verification_type:o},user:Object.assign({},th(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]))},error:null}}function tS(e){return e}let tE=["global","local","others"];var tT=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>t.indexOf(n)&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)0>t.indexOf(n[i])&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r};class tC{constructor({url:e="",headers:t={},fetch:r}){this.url=e,this.headers=t,this.fetch=e4(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t=tE[0]){if(0>tE.indexOf(t))throw Error(`@supabase/auth-js: Parameter scope must be one of ${tE.join(", ")}`);try{return await tg(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(e){if(eN(e))return{data:null,error:e};throw e}}async inviteUserByEmail(e,t={}){try{return await tg(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:tw})}catch(e){if(eN(e))return{data:{user:null},error:e};throw e}}async generateLink(e){try{let{options:t}=e,r=tT(e,["options"]),n=Object.assign(Object.assign({},r),t);return"newEmail"in r&&(n.new_email=null==r?void 0:r.newEmail,delete n.newEmail),await tg(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:tk,redirectTo:null==t?void 0:t.redirectTo})}catch(e){if(eN(e))return{data:{properties:null,user:null},error:e};throw e}}async createUser(e){try{return await tg(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:tw})}catch(e){if(eN(e))return{data:{user:null},error:e};throw e}}async listUsers(e){var t,r,n,i,o,s,a;try{let u={nextPage:null,lastPage:0,total:0},l=await tg(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:null!==(r=null===(t=null==e?void 0:e.page)||void 0===t?void 0:t.toString())&&void 0!==r?r:"",per_page:null!==(i=null===(n=null==e?void 0:e.perPage)||void 0===n?void 0:n.toString())&&void 0!==i?i:""},xform:tS});if(l.error)throw l.error;let c=await l.json(),h=null!==(o=l.headers.get("x-total-count"))&&void 0!==o?o:0,d=null!==(a=null===(s=l.headers.get("link"))||void 0===s?void 0:s.split(","))&&void 0!==a?a:[];return d.length>0&&(d.forEach(e=>{let t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),r=JSON.parse(e.split(";")[1].split("=")[1]);u[`${r}Page`]=t}),u.total=parseInt(h)),{data:Object.assign(Object.assign({},c),u),error:null}}catch(e){if(eN(e))return{data:{users:[]},error:e};throw e}}async getUserById(e){tu(e);try{return await tg(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:tw})}catch(e){if(eN(e))return{data:{user:null},error:e};throw e}}async updateUserById(e,t){tu(e);try{return await tg(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:tw})}catch(e){if(eN(e))return{data:{user:null},error:e};throw e}}async deleteUser(e,t=!1){tu(e);try{return await tg(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:tw})}catch(e){if(eN(e))return{data:{user:null},error:e};throw e}}async _listFactors(e){tu(e.userId);try{let{data:t,error:r}=await tg(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:e=>({data:{factors:e},error:null})});return{data:t,error:r}}catch(e){if(eN(e))return{data:null,error:e};throw e}}async _deleteFactor(e){tu(e.userId),tu(e.id);try{return{data:await tg(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(e){if(eN(e))return{data:null,error:e};throw e}}}function tO(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}let tA={debug:!!(globalThis&&e3()&&globalThis.localStorage&&"true"===globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug"))};class tI extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class tP extends tI{}async function tx(e,t,r){tA.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);let n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),tA.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,0===t?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async n=>{if(n){tA.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,n.name);try{return await r()}finally{tA.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,n.name)}}else{if(0===t)throw tA.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new tP(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(tA.debug)try{let e=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(e,null,"  "))}catch(e){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",e)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}!function(){if("object"!=typeof globalThis)try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(e){"undefined"!=typeof self&&(self.globalThis=self)}}();let tR={url:"http://localhost:9999",storageKey:"supabase.auth.token",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:ex,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function tj(e,t,r){return await r()}let tU={};class tL{constructor(e){var t,r;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=tL.nextInstanceID,tL.nextInstanceID+=1,this.instanceID>0&&e1()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");let n=Object.assign(Object.assign({},tR),e);if(this.logDebugMessages=!!n.debug,"function"==typeof n.debug&&(this.logger=n.debug),this.persistSession=n.persistSession,this.storageKey=n.storageKey,this.autoRefreshToken=n.autoRefreshToken,this.admin=new tC({url:n.url,headers:n.headers,fetch:n.fetch}),this.url=n.url,this.headers=n.headers,this.fetch=e4(n.fetch),this.lock=n.lock||tj,this.detectSessionInUrl=n.detectSessionInUrl,this.flowType=n.flowType,this.hasCustomAuthorizationHeader=n.hasCustomAuthorizationHeader,n.lock?this.lock=n.lock:e1()&&(null===(t=null==globalThis?void 0:globalThis.navigator)||void 0===t?void 0:t.locks)?this.lock=tx:this.lock=tj,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(n.storage?this.storage=n.storage:e3()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=tO(this.memoryStorage)),n.userStorage&&(this.userStorage=n.userStorage)):(this.memoryStorage={},this.storage=tO(this.memoryStorage)),e1()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(e){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",e)}null===(r=this.broadcastChannel)||void 0===r||r.addEventListener("message",async e=>{this._debug("received broadcast notification from other tab or client",e),await this._notifyAllSubscribers(e.data.event,e.data.session,!1)})}this.initialize()}get jwks(){var e,t;return null!==(t=null===(e=tU[this.storageKey])||void 0===e?void 0:e.jwks)&&void 0!==t?t:{keys:[]}}set jwks(e){tU[this.storageKey]=Object.assign(Object.assign({},tU[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return null!==(t=null===(e=tU[this.storageKey])||void 0===e?void 0:e.cachedAt)&&void 0!==t?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){tU[this.storageKey]=Object.assign(Object.assign({},tU[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${eP}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise||(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))()),await this.initializePromise}async _initialize(){var e;try{let t=function(e){let t={},r=new URL(e);if(r.hash&&"#"===r.hash[0])try{new URLSearchParams(r.hash.substring(1)).forEach((e,r)=>{t[r]=e})}catch(e){}return r.searchParams.forEach((e,r)=>{t[r]=e}),t}(window.location.href),r="none";if(this._isImplicitGrantCallback(t)?r="implicit":await this._isPKCECallback(t)&&(r="pkce"),e1()&&this.detectSessionInUrl&&"none"!==r){let{data:n,error:i}=await this._getSessionFromURL(t,r);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),eN(i)&&"AuthImplicitGrantRedirectError"===i.name){let t=null===(e=i.details)||void 0===e?void 0:e.code;if("identity_already_exists"===t||"identity_not_found"===t||"single_identity_not_deletable"===t)return{error:i}}return await this._removeSession(),{error:i}}let{session:o,redirectType:s}=n;return this._debug("#_initialize()","detected session in URL",o,"redirect type",s),await this._saveSession(o),setTimeout(async()=>{"recovery"===s?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(e){if(eN(e))return{error:e};return{error:new eD("Unexpected error during initialization",e)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,r,n;try{let{data:i,error:o}=await tg(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:null!==(r=null===(t=null==e?void 0:e.options)||void 0===t?void 0:t.data)&&void 0!==r?r:{},gotrue_meta_security:{captcha_token:null===(n=null==e?void 0:e.options)||void 0===n?void 0:n.captchaToken}},xform:tm});if(o||!i)return{data:{user:null,session:null},error:o};let s=i.session,a=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",s)),{data:{user:a,session:s},error:null}}catch(e){if(eN(e))return{data:{user:null,session:null},error:e};throw e}}async signUp(e){var t,r,n;try{let i;if("email"in e){let{email:r,password:n,options:o}=e,s=null,a=null;"pkce"===this.flowType&&([s,a]=await to(this.storage,this.storageKey)),i=await tg(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:null==o?void 0:o.emailRedirectTo,body:{email:r,password:n,data:null!==(t=null==o?void 0:o.data)&&void 0!==t?t:{},gotrue_meta_security:{captcha_token:null==o?void 0:o.captchaToken},code_challenge:s,code_challenge_method:a},xform:tm})}else if("phone"in e){let{phone:t,password:o,options:s}=e;i=await tg(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:t,password:o,data:null!==(r=null==s?void 0:s.data)&&void 0!==r?r:{},channel:null!==(n=null==s?void 0:s.channel)&&void 0!==n?n:"sms",gotrue_meta_security:{captcha_token:null==s?void 0:s.captchaToken}},xform:tm})}else throw new eB("You must provide either an email or phone number and a password");let{data:o,error:s}=i;if(s||!o)return{data:{user:null,session:null},error:s};let a=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",a)),{data:{user:u,session:a},error:null}}catch(e){if(eN(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithPassword(e){try{let t;if("email"in e){let{email:r,password:n,options:i}=e;t=await tg(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:r,password:n,gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken}},xform:tb})}else if("phone"in e){let{phone:r,password:n,options:i}=e;t=await tg(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:r,password:n,gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken}},xform:tb})}else throw new eB("You must provide either an email or phone number and a password");let{data:r,error:n}=t;if(n)return{data:{user:null,session:null},error:n};if(!r||!r.session||!r.user)return{data:{user:null,session:null},error:new eM};return r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:n}}catch(e){if(eN(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithOAuth(e){var t,r,n,i;return await this._handleProviderSignIn(e.provider,{redirectTo:null===(t=e.options)||void 0===t?void 0:t.redirectTo,scopes:null===(r=e.options)||void 0===r?void 0:r.scopes,queryParams:null===(n=e.options)||void 0===n?void 0:n.queryParams,skipBrowserRedirect:null===(i=e.options)||void 0===i?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){let{chain:t}=e;if("solana"===t)return await this.signInWithSolana(e);throw Error(`@supabase/auth-js: Unsupported chain "${t}"`)}async signInWithSolana(e){var t,r,n,i,o,s,a,u,l,c,h,d;let f,p;if("message"in e)f=e.message,p=e.signature;else{let h;let{chain:d,wallet:v,statement:g,options:y}=e;if(e1()){if("object"==typeof v)h=v;else{let e=window;if("solana"in e&&"object"==typeof e.solana&&("signIn"in e.solana&&"function"==typeof e.solana.signIn||"signMessage"in e.solana&&"function"==typeof e.solana.signMessage))h=e.solana;else throw Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}}else{if("object"!=typeof v||!(null==y?void 0:y.url))throw Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");h=v}let m=new URL(null!==(t=null==y?void 0:y.url)&&void 0!==t?t:window.location.href);if("signIn"in h&&h.signIn){let e;let t=await h.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},null==y?void 0:y.signInWithSolana),{version:"1",domain:m.host,uri:m.href}),g?{statement:g}:null));if(Array.isArray(t)&&t[0]&&"object"==typeof t[0])e=t[0];else if(t&&"object"==typeof t&&"signedMessage"in t&&"signature"in t)e=t;else throw Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in e&&"signature"in e&&("string"==typeof e.signedMessage||e.signedMessage instanceof Uint8Array)&&e.signature instanceof Uint8Array)f="string"==typeof e.signedMessage?e.signedMessage:new TextDecoder().decode(e.signedMessage),p=e.signature;else throw Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in h)||"function"!=typeof h.signMessage||!("publicKey"in h)||"object"!=typeof h||!h.publicKey||!("toBase58"in h.publicKey)||"function"!=typeof h.publicKey.toBase58)throw Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");f=[`${m.host} wants you to sign in with your Solana account:`,h.publicKey.toBase58(),...g?["",g,""]:[""],"Version: 1",`URI: ${m.href}`,`Issued At: ${null!==(n=null===(r=null==y?void 0:y.signInWithSolana)||void 0===r?void 0:r.issuedAt)&&void 0!==n?n:new Date().toISOString()}`,...(null===(i=null==y?void 0:y.signInWithSolana)||void 0===i?void 0:i.notBefore)?[`Not Before: ${y.signInWithSolana.notBefore}`]:[],...(null===(o=null==y?void 0:y.signInWithSolana)||void 0===o?void 0:o.expirationTime)?[`Expiration Time: ${y.signInWithSolana.expirationTime}`]:[],...(null===(s=null==y?void 0:y.signInWithSolana)||void 0===s?void 0:s.chainId)?[`Chain ID: ${y.signInWithSolana.chainId}`]:[],...(null===(a=null==y?void 0:y.signInWithSolana)||void 0===a?void 0:a.nonce)?[`Nonce: ${y.signInWithSolana.nonce}`]:[],...(null===(u=null==y?void 0:y.signInWithSolana)||void 0===u?void 0:u.requestId)?[`Request ID: ${y.signInWithSolana.requestId}`]:[],...(null===(c=null===(l=null==y?void 0:y.signInWithSolana)||void 0===l?void 0:l.resources)||void 0===c?void 0:c.length)?["Resources",...y.signInWithSolana.resources.map(e=>`- ${e}`)]:[]].join("\n");let e=await h.signMessage(new TextEncoder().encode(f),"utf8");if(!e||!(e instanceof Uint8Array))throw Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");p=e}}try{let{data:t,error:r}=await tg(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:f,signature:function(e){let t=[],r={queue:0,queuedBits:0},n=e=>{t.push(e)};return e.forEach(e=>eQ(e,r,n)),eQ(null,r,n),t.join("")}(p)},(null===(h=e.options)||void 0===h?void 0:h.captchaToken)?{gotrue_meta_security:{captcha_token:null===(d=e.options)||void 0===d?void 0:d.captchaToken}}:null),xform:tm});if(r)throw r;if(!t||!t.session||!t.user)return{data:{user:null,session:null},error:new eM};return t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),{data:Object.assign({},t),error:r}}catch(e){if(eN(e))return{data:{user:null,session:null},error:e};throw e}}async _exchangeCodeForSession(e){let t=await e8(this.storage,`${this.storageKey}-code-verifier`),[r,n]=(null!=t?t:"").split("/");try{let{data:t,error:i}=await tg(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:tm});if(await e9(this.storage,`${this.storageKey}-code-verifier`),i)throw i;if(!t||!t.session||!t.user)return{data:{user:null,session:null,redirectType:null},error:new eM};return t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),{data:Object.assign(Object.assign({},t),{redirectType:null!=n?n:null}),error:i}}catch(e){if(eN(e))return{data:{user:null,session:null,redirectType:null},error:e};throw e}}async signInWithIdToken(e){try{let{options:t,provider:r,token:n,access_token:i,nonce:o}=e,{data:s,error:a}=await tg(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:n,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:null==t?void 0:t.captchaToken}},xform:tm});if(a)return{data:{user:null,session:null},error:a};if(!s||!s.session||!s.user)return{data:{user:null,session:null},error:new eM};return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:s,error:a}}catch(e){if(eN(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithOtp(e){var t,r,n,i,o;try{if("email"in e){let{email:n,options:i}=e,o=null,s=null;"pkce"===this.flowType&&([o,s]=await to(this.storage,this.storageKey));let{error:a}=await tg(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:n,data:null!==(t=null==i?void 0:i.data)&&void 0!==t?t:{},create_user:null===(r=null==i?void 0:i.shouldCreateUser)||void 0===r||r,gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken},code_challenge:o,code_challenge_method:s},redirectTo:null==i?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:a}}if("phone"in e){let{phone:t,options:r}=e,{data:s,error:a}=await tg(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:t,data:null!==(n=null==r?void 0:r.data)&&void 0!==n?n:{},create_user:null===(i=null==r?void 0:r.shouldCreateUser)||void 0===i||i,gotrue_meta_security:{captcha_token:null==r?void 0:r.captchaToken},channel:null!==(o=null==r?void 0:r.channel)&&void 0!==o?o:"sms"}});return{data:{user:null,session:null,messageId:null==s?void 0:s.message_id},error:a}}throw new eB("You must provide either an email or phone number.")}catch(e){if(eN(e))return{data:{user:null,session:null},error:e};throw e}}async verifyOtp(e){var t,r;try{let n,i;"options"in e&&(n=null===(t=e.options)||void 0===t?void 0:t.redirectTo,i=null===(r=e.options)||void 0===r?void 0:r.captchaToken);let{data:o,error:s}=await tg(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:n,xform:tm});if(s)throw s;if(!o)throw Error("An error occurred on token verification.");let a=o.session,u=o.user;return(null==a?void 0:a.access_token)&&(await this._saveSession(a),await this._notifyAllSubscribers("recovery"==e.type?"PASSWORD_RECOVERY":"SIGNED_IN",a)),{data:{user:u,session:a},error:null}}catch(e){if(eN(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithSSO(e){var t,r,n;try{let i=null,o=null;return"pkce"===this.flowType&&([i,o]=await to(this.storage,this.storageKey)),await tg(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:null!==(r=null===(t=e.options)||void 0===t?void 0:t.redirectTo)&&void 0!==r?r:void 0}),(null===(n=null==e?void 0:e.options)||void 0===n?void 0:n.captchaToken)?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:o}),headers:this.headers,xform:t_})}catch(e){if(eN(e))return{data:null,error:e};throw e}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{let{data:{session:t},error:r}=e;if(r)throw r;if(!t)throw new eq;let{error:n}=await tg(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:n}})}catch(e){if(eN(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{let t=`${this.url}/resend`;if("email"in e){let{email:r,type:n,options:i}=e,{error:o}=await tg(this.fetch,"POST",t,{headers:this.headers,body:{email:r,type:n,gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken}},redirectTo:null==i?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:o}}if("phone"in e){let{phone:r,type:n,options:i}=e,{data:o,error:s}=await tg(this.fetch,"POST",t,{headers:this.headers,body:{phone:r,type:n,gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:null==o?void 0:o.message_id},error:s}}throw new eB("You must provide either an email or phone number and a type")}catch(e){if(eN(e))return{data:{user:null,session:null},error:e};throw e}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async e=>e))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){let e=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),r=(async()=>(await e,await t()))();return this.pendingInLock.push((async()=>{try{await r}catch(e){}})()),r}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;let e=t();for(this.pendingInLock.push((async()=>{try{await e}catch(e){}})()),await e;this.pendingInLock.length;){let e=[...this.pendingInLock];await Promise.all(e),this.pendingInLock.splice(0,e.length)}return await e}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{let t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",Error().stack);try{let e=null,t=await e8(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),null!==t&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};let r=!!e.expires_at&&1e3*e.expires_at-Date.now()<9e4;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.userStorage){let t=await e8(this.userStorage,this.storageKey+"-user");(null==t?void 0:t.user)?e.user=t.user:e.user=tl()}if(this.storage.isServer&&e.user){let t=this.suppressGetSessionWarning;e=new Proxy(e,{get:(e,r,n)=>(t||"user"!==r||(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t=!0,this.suppressGetSessionWarning=!0),Reflect.get(e,r,n))})}return{data:{session:e},error:null}}let{session:n,error:i}=await this._callRefreshToken(e.refresh_token);if(i)return{data:{session:null},error:i};return{data:{session:n},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{if(e)return await tg(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:tw});return await this._useSession(async e=>{var t,r,n;let{data:i,error:o}=e;if(o)throw o;return(null===(t=i.session)||void 0===t?void 0:t.access_token)||this.hasCustomAuthorizationHeader?await tg(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:null!==(n=null===(r=i.session)||void 0===r?void 0:r.access_token)&&void 0!==n?n:void 0,xform:tw}):{data:{user:null},error:new eq}})}catch(e){if(eN(e))return eN(e)&&"AuthSessionMissingError"===e.name&&(await this._removeSession(),await e9(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:e};throw e}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async r=>{let{data:n,error:i}=r;if(i)throw i;if(!n.session)throw new eq;let o=n.session,s=null,a=null;"pkce"===this.flowType&&null!=e.email&&([s,a]=await to(this.storage,this.storageKey));let{data:u,error:l}=await tg(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:null==t?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:s,code_challenge_method:a}),jwt:o.access_token,xform:tw});if(l)throw l;return o.user=u.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(e){if(eN(e))return{data:{user:null},error:e};throw e}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new eq;let t=Date.now()/1e3,r=t,n=!0,i=null,{payload:o}=te(e.access_token);if(o.exp&&(n=(r=o.exp)<=t),n){let{session:t,error:r}=await this._callRefreshToken(e.refresh_token);if(r)return{data:{user:null,session:null},error:r};if(!t)return{data:{user:null,session:null},error:null};i=t}else{let{data:n,error:o}=await this._getUser(e.access_token);if(o)throw o;i={access_token:e.access_token,refresh_token:e.refresh_token,user:n.user,token_type:"bearer",expires_in:r-t,expires_at:r},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(e){if(eN(e))return{data:{session:null,user:null},error:e};throw e}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var r;if(!e){let{data:n,error:i}=t;if(i)throw i;e=null!==(r=n.session)&&void 0!==r?r:void 0}if(!(null==e?void 0:e.refresh_token))throw new eq;let{session:n,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:n?{data:{user:n.user,session:n},error:null}:{data:{user:null,session:null},error:null}})}catch(e){if(eN(e))return{data:{user:null,session:null},error:e};throw e}}async _getSessionFromURL(e,t){try{if(!e1())throw new eF("No browser detected.");if(e.error||e.error_description||e.error_code)throw new eF(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if("pkce"===this.flowType)throw new ez("Not a valid PKCE flow url.");break;case"pkce":if("implicit"===this.flowType)throw new eF("Not a valid implicit grant flow url.")}if("pkce"===t){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new ez("No code detected.");let{data:t,error:r}=await this._exchangeCodeForSession(e.code);if(r)throw r;let n=new URL(window.location.href);return n.searchParams.delete("code"),window.history.replaceState(window.history.state,"",n.toString()),{data:{session:t.session,redirectType:null},error:null}}let{provider_token:r,provider_refresh_token:n,access_token:i,refresh_token:o,expires_in:s,expires_at:a,token_type:u}=e;if(!i||!s||!o||!u)throw new eF("No session defined in URL");let l=Math.round(Date.now()/1e3),c=parseInt(s),h=l+c;a&&(h=parseInt(a));let d=h-l;1e3*d<=3e4&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${d}s, should have been closer to ${c}s`);let f=h-c;l-f>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",f,h,l):l-f<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",f,h,l);let{data:p,error:v}=await this._getUser(i);if(v)throw v;let g={provider_token:r,provider_refresh_token:n,access_token:i,expires_in:c,expires_at:h,refresh_token:o,token_type:u,user:p.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:g,redirectType:e.type},error:null}}catch(e){if(eN(e))return{data:{session:null,redirectType:null},error:e};throw e}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){let t=await e8(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var r;let{data:n,error:i}=t;if(i)return{error:i};let o=null===(r=n.session)||void 0===r?void 0:r.access_token;if(o){let{error:t}=await this.admin.signOut(o,e);if(t&&!(eN(t)&&"AuthApiError"===t.name&&(404===t.status||401===t.status||403===t.status)))return{error:t}}return"others"!==e&&(await this._removeSession(),await e9(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){let t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){let t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}),r={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,r),(async()=>{await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})})(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async t=>{var r,n;try{let{data:{session:n},error:i}=t;if(i)throw i;await (null===(r=this.stateChangeEmitters.get(e))||void 0===r?void 0:r.callback("INITIAL_SESSION",n)),this._debug("INITIAL_SESSION","callback id",e,"session",n)}catch(t){await (null===(n=this.stateChangeEmitters.get(e))||void 0===n?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",t),console.error(t)}})}async resetPasswordForEmail(e,t={}){let r=null,n=null;"pkce"===this.flowType&&([r,n]=await to(this.storage,this.storageKey,!0));try{return await tg(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:n,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(e){if(eN(e))return{data:null,error:e};throw e}}async getUserIdentities(){var e;try{let{data:t,error:r}=await this.getUser();if(r)throw r;return{data:{identities:null!==(e=t.user.identities)&&void 0!==e?e:[]},error:null}}catch(e){if(eN(e))return{data:null,error:e};throw e}}async linkIdentity(e){var t;try{let{data:r,error:n}=await this._useSession(async t=>{var r,n,i,o,s;let{data:a,error:u}=t;if(u)throw u;let l=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:null===(r=e.options)||void 0===r?void 0:r.redirectTo,scopes:null===(n=e.options)||void 0===n?void 0:n.scopes,queryParams:null===(i=e.options)||void 0===i?void 0:i.queryParams,skipBrowserRedirect:!0});return await tg(this.fetch,"GET",l,{headers:this.headers,jwt:null!==(s=null===(o=a.session)||void 0===o?void 0:o.access_token)&&void 0!==s?s:void 0})});if(n)throw n;return!e1()||(null===(t=e.options)||void 0===t?void 0:t.skipBrowserRedirect)||window.location.assign(null==r?void 0:r.url),{data:{provider:e.provider,url:null==r?void 0:r.url},error:null}}catch(t){if(eN(t))return{data:{provider:e.provider,url:null},error:t};throw t}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var r,n;let{data:i,error:o}=t;if(o)throw o;return await tg(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:null!==(n=null===(r=i.session)||void 0===r?void 0:r.access_token)&&void 0!==n?n:void 0})})}catch(e){if(eN(e))return{data:null,error:e};throw e}}async _refreshAccessToken(e){let t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{var r,n;let i=Date.now();return await (r=async r=>(r>0&&await tt(200*Math.pow(2,r-1)),this._debug(t,"refreshing attempt",r),await tg(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:tm})),n=(e,t)=>{let r=200*Math.pow(2,e);return t&&eJ(t)&&Date.now()+r-i<3e4},new Promise((e,t)=>{(async()=>{for(let i=0;i<1/0;i++)try{let t=await r(i);if(!n(i,null,t)){e(t);return}}catch(e){if(!n(i,e)){t(e);return}}})()}))}catch(e){if(this._debug(t,"error",e),eN(e))return{data:{session:null,user:null},error:e};throw e}finally{this._debug(t,"end")}}_isValidSession(e){return"object"==typeof e&&null!==e&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){let r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",r),e1()&&!t.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e,t;let r="#_recoverAndRefresh()";this._debug(r,"begin");try{let n=await e8(this.storage,this.storageKey);if(n&&this.userStorage){let t=await e8(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!t&&(t={user:n.user},await e6(this.userStorage,this.storageKey+"-user",t)),n.user=null!==(e=null==t?void 0:t.user)&&void 0!==e?e:tl()}else if(n&&!n.user&&!n.user){let e=await e8(this.storage,this.storageKey+"-user");e&&(null==e?void 0:e.user)?(n.user=e.user,await e9(this.storage,this.storageKey+"-user"),await e6(this.storage,this.storageKey,n)):n.user=tl()}if(this._debug(r,"session from storage",n),!this._isValidSession(n)){this._debug(r,"session is not valid"),null!==n&&await this._removeSession();return}let i=(null!==(t=n.expires_at)&&void 0!==t?t:1/0)*1e3-Date.now()<9e4;if(this._debug(r,`session has${i?"":" not"} expired with margin of 90000s`),i){if(this.autoRefreshToken&&n.refresh_token){let{error:e}=await this._callRefreshToken(n.refresh_token);e&&(console.error(e),eJ(e)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",e),await this._removeSession()))}}else if(n.user&&!0===n.user.__isUserNotAvailableProxy)try{let{data:e,error:t}=await this._getUser(n.access_token);!t&&(null==e?void 0:e.user)?(n.user=e.user,await this._saveSession(n),await this._notifyAllSubscribers("SIGNED_IN",n)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(e){console.error("Error getting user data:",e),this._debug(r,"error getting user data, skipping SIGNED_IN notification",e)}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(e){this._debug(r,"error",e),console.error(e);return}finally{this._debug(r,"end")}}async _callRefreshToken(e){var t,r;if(!e)throw new eq;if(this.refreshingDeferred)return this.refreshingDeferred.promise;let n=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new e7;let{data:t,error:r}=await this._refreshAccessToken(e);if(r)throw r;if(!t.session)throw new eq;await this._saveSession(t.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",t.session);let n={session:t.session,error:null};return this.refreshingDeferred.resolve(n),n}catch(e){if(this._debug(n,"error",e),eN(e)){let r={session:null,error:e};return eJ(e)||await this._removeSession(),null===(t=this.refreshingDeferred)||void 0===t||t.resolve(r),r}throw null===(r=this.refreshingDeferred)||void 0===r||r.reject(e),e}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(e,t,r=!0){let n=`#_notifyAllSubscribers(${e})`;this._debug(n,"begin",t,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:t});let n=[],i=Array.from(this.stateChangeEmitters.values()).map(async r=>{try{await r.callback(e,t)}catch(e){n.push(e)}});if(await Promise.all(i),n.length>0){for(let e=0;e<n.length;e+=1)console.error(n[e]);throw n[0]}}finally{this._debug(n,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;let t=Object.assign({},e),r=t.user&&!0===t.user.__isUserNotAvailableProxy;if(this.userStorage){!r&&t.user&&await e6(this.userStorage,this.storageKey+"-user",{user:t.user});let e=Object.assign({},t);delete e.user;let n=tc(e);await e6(this.storage,this.storageKey,n)}else{let e=tc(t);await e6(this.storage,this.storageKey,e)}}async _removeSession(){this._debug("#_removeSession()"),await e9(this.storage,this.storageKey),await e9(this.storage,this.storageKey+"-code-verifier"),await e9(this.storage,this.storageKey+"-user"),this.userStorage&&await e9(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");let e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&e1()&&(null==window?void 0:window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(e){console.error("removing visibilitychange callback failed",e)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");let e=setInterval(()=>this._autoRefreshTokenTick(),3e4);this.autoRefreshTicker=e,e&&"object"==typeof e&&"function"==typeof e.unref?e.unref():"undefined"!=typeof Deno&&"function"==typeof Deno.unrefTimer&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");let e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{let e=Date.now();try{return await this._useSession(async t=>{let{data:{session:r}}=t;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}let n=Math.floor((1e3*r.expires_at-e)/3e4);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts 30000ms, refresh threshold is 3 ticks`),n<=3&&await this._callRefreshToken(r.refresh_token)})}catch(e){console.error("Auto refresh tick failed with error. This is likely a transient error.",e)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof tI)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!e1()||!(null==window?void 0:window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),null==window||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){let t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),"visible"===document.visibilityState?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if("visible"!==document.visibilityState){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):"hidden"===document.visibilityState&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,r){let n=[`provider=${encodeURIComponent(t)}`];if((null==r?void 0:r.redirectTo)&&n.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),(null==r?void 0:r.scopes)&&n.push(`scopes=${encodeURIComponent(r.scopes)}`),"pkce"===this.flowType){let[e,t]=await to(this.storage,this.storageKey),r=new URLSearchParams({code_challenge:`${encodeURIComponent(e)}`,code_challenge_method:`${encodeURIComponent(t)}`});n.push(r.toString())}if(null==r?void 0:r.queryParams){let e=new URLSearchParams(r.queryParams);n.push(e.toString())}return(null==r?void 0:r.skipBrowserRedirect)&&n.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${n.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var r;let{data:n,error:i}=t;return i?{data:null,error:i}:await tg(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:null===(r=null==n?void 0:n.session)||void 0===r?void 0:r.access_token})})}catch(e){if(eN(e))return{data:null,error:e};throw e}}async _enroll(e){try{return await this._useSession(async t=>{var r,n;let{data:i,error:o}=t;if(o)return{data:null,error:o};let s=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},"phone"===e.factorType?{phone:e.phone}:{issuer:e.issuer}),{data:a,error:u}=await tg(this.fetch,"POST",`${this.url}/factors`,{body:s,headers:this.headers,jwt:null===(r=null==i?void 0:i.session)||void 0===r?void 0:r.access_token});return u?{data:null,error:u}:("totp"===e.factorType&&(null===(n=null==a?void 0:a.totp)||void 0===n?void 0:n.qr_code)&&(a.totp.qr_code=`data:image/svg+xml;utf-8,${a.totp.qr_code}`),{data:a,error:null})})}catch(e){if(eN(e))return{data:null,error:e};throw e}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;let{data:n,error:i}=t;if(i)return{data:null,error:i};let{data:o,error:s}=await tg(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:null===(r=null==n?void 0:n.session)||void 0===r?void 0:r.access_token});return s?{data:null,error:s}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:s})})}catch(e){if(eN(e))return{data:null,error:e};throw e}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;let{data:n,error:i}=t;return i?{data:null,error:i}:await tg(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:null===(r=null==n?void 0:n.session)||void 0===r?void 0:r.access_token})})}catch(e){if(eN(e))return{data:null,error:e};throw e}})}async _challengeAndVerify(e){let{data:t,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){let{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};let r=(null==e?void 0:e.factors)||[],n=r.filter(e=>"totp"===e.factor_type&&"verified"===e.status),i=r.filter(e=>"phone"===e.factor_type&&"verified"===e.status);return{data:{all:r,totp:n,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,r;let{data:{session:n},error:i}=e;if(i)return{data:null,error:i};if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};let{payload:o}=te(n.access_token),s=null;o.aal&&(s=o.aal);let a=s;return(null!==(r=null===(t=n.user.factors)||void 0===t?void 0:t.filter(e=>"verified"===e.status))&&void 0!==r?r:[]).length>0&&(a="aal2"),{data:{currentLevel:s,nextLevel:a,currentAuthenticationMethods:o.amr||[]},error:null}}))}async fetchJwk(e,t={keys:[]}){let r=t.keys.find(t=>t.kid===e);if(r)return r;let n=Date.now();if((r=this.jwks.keys.find(t=>t.kid===e))&&this.jwks_cached_at+6e5>n)return r;let{data:i,error:o}=await tg(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return i.keys&&0!==i.keys.length&&(this.jwks=i,this.jwks_cached_at=n,r=i.keys.find(t=>t.kid===e))?r:null}async getClaims(e,t={}){try{let r=e;if(!r){let{data:e,error:t}=await this.getSession();if(t||!e.session)return{data:null,error:t};r=e.session.access_token}let{header:n,payload:i,signature:o,raw:{header:s,payload:a}}=te(r);(null==t?void 0:t.allowExpired)||function(e){if(!e)throw Error("Missing exp claim");if(e<=Math.floor(Date.now()/1e3))throw Error("JWT has expired")}(i.exp);let u=!n.alg||n.alg.startsWith("HS")||!n.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(n.kid,(null==t?void 0:t.keys)?{keys:t.keys}:null==t?void 0:t.jwks);if(!u){let{error:e}=await this.getUser(r);if(e)throw e;return{data:{claims:i,header:n,signature:o},error:null}}let l=function(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw Error("Invalid alg claim")}}(n.alg),c=await crypto.subtle.importKey("jwk",u,l,!0,["verify"]);if(!await crypto.subtle.verify(l,c,o,function(e){let t=[];return function(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){let t=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|t)+65536,r+=1}!function(e,t){if(e<=127){t(e);return}if(e<=2047){t(192|e>>6),t(128|63&e);return}if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|63&e);return}if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|63&e);return}throw Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}(n,t)}}(e,e=>t.push(e)),new Uint8Array(t)}(`${s}.${a}`)))throw new eK("Invalid JWT signature");return{data:{claims:i,header:n,signature:o},error:null}}catch(e){if(eN(e))return{data:null,error:e};throw e}}}tL.nextInstanceID=0;let tN=tL;class t$ extends tN{constructor(e){super(e)}}class tD{constructor(e,t,r){var n,i,o;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw Error("supabaseUrl is required.");if(!t)throw Error("supabaseKey is required.");let s=new URL(function(e){return e.endsWith("/")?e:e+"/"}(e));this.realtimeUrl=new URL("realtime/v1",s),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",s),this.storageUrl=new URL("storage/v1",s),this.functionsUrl=new URL("functions/v1",s);let a=`sb-${s.hostname.split(".")[0]}-auth-token`,u=function(e,t){var r,n;let{db:i,auth:o,realtime:s,global:a}=e,{db:u,auth:l,realtime:c,global:h}=t,d={db:Object.assign(Object.assign({},u),i),auth:Object.assign(Object.assign({},l),o),realtime:Object.assign(Object.assign({},c),s),storage:{},global:Object.assign(Object.assign(Object.assign({},h),a),{headers:Object.assign(Object.assign({},null!==(r=null==h?void 0:h.headers)&&void 0!==r?r:{}),null!==(n=null==a?void 0:a.headers)&&void 0!==n?n:{})}),accessToken:()=>{var e,t,r,n;return e=this,t=void 0,n=function*(){return""},new(r=void 0,r=Promise)(function(i,o){function s(e){try{u(n.next(e))}catch(e){o(e)}}function a(e){try{u(n.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(s,a)}u((n=n.apply(e,t||[])).next())})}};return e.accessToken?d.accessToken=e.accessToken:delete d.accessToken,d}(null!=r?r:{},{db:eS,realtime:eT,auth:Object.assign(Object.assign({},eE),{storageKey:a}),global:ek});this.storageKey=null!==(n=u.auth.storageKey)&&void 0!==n?n:"",this.headers=null!==(i=u.global.headers)&&void 0!==i?i:{},u.accessToken?(this.accessToken=u.accessToken,this.auth=new Proxy({},{get:(e,t)=>{throw Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(t)} is not possible`)}})):this.auth=this._initSupabaseAuthClient(null!==(o=u.auth)&&void 0!==o?o:{},this.headers,u.global.fetch),this.fetch=eI(t,this._getAccessToken.bind(this),u.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},u.realtime)),this.rest=new c(new URL("rest/v1",s).href,{headers:this.headers,schema:u.db.schema,fetch:this.fetch}),this.storage=new ew(this.storageUrl.href,this.headers,this.fetch,null==r?void 0:r.storage),u.accessToken||this._listenForAuthEvents()}get functions(){return new l(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t,r,n,i,o;return r=this,n=void 0,i=void 0,o=function*(){if(this.accessToken)return yield this.accessToken();let{data:r}=yield this.auth.getSession();return null!==(t=null===(e=r.session)||void 0===e?void 0:e.access_token)&&void 0!==t?t:this.supabaseKey},new(i||(i=Promise))(function(e,t){function s(e){try{u(o.next(e))}catch(e){t(e)}}function a(e){try{u(o.throw(e))}catch(e){t(e)}}function u(t){var r;t.done?e(t.value):((r=t.value)instanceof i?r:new i(function(e){e(r)})).then(s,a)}u((o=o.apply(r,n||[])).next())})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,storageKey:i,flowType:o,lock:s,debug:a},u,l){let c={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new t$({url:this.authUrl.href,headers:Object.assign(Object.assign({},c),u),storageKey:i,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,flowType:o,lock:s,debug:a,fetch:l,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new K(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},null==e?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",null==t?void 0:t.access_token)})}_handleTokenChanged(e,t,r){("TOKEN_REFRESHED"===e||"SIGNED_IN"===e)&&this.changedAccessToken!==r?this.changedAccessToken=r:"SIGNED_OUT"===e&&(this.realtime.setAuth(),"STORAGE"==t&&this.auth.signOut(),this.changedAccessToken=void 0)}}var tH=r(88986);let tq=(e,t,r)=>new tD(e,t,r);(function(){if("undefined"!=typeof window||void 0===tH)return!1;let e=tH.version;if(null==e)return!1;let t=e.match(/^v(\d+)\./);return!!t&&18>=parseInt(t[1],10)})()&&console.warn(`  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217`);var tM=r(84337);function tB(){return"undefined"!=typeof window&&void 0!==window.document}let tF={path:"/",sameSite:"lax",httpOnly:!1,maxAge:3456e4},tz=/^(.*)[.](0|[1-9][0-9]*)$/;function tW(e,t){if(e===t)return!0;let r=e.match(tz);return!!r&&r[1]===t}function tJ(e,t,r){let n=r??3180,i=encodeURIComponent(t);if(i.length<=n)return[{name:e,value:t}];let o=[];for(;i.length>0;){let e=i.slice(0,n),t=e.lastIndexOf("%");t>n-3&&(e=e.slice(0,t));let r="";for(;e.length>0;)try{r=decodeURIComponent(e);break}catch(t){if(t instanceof URIError&&"%"===e.at(-3)&&e.length>3)e=e.slice(0,e.length-3);else throw t}o.push(r),i=i.slice(e.length)}return o.map((t,r)=>({name:`${e}.${r}`,value:t}))}async function tY(e,t){let r=await t(e);if(r)return r;let n=[];for(let r=0;;r++){let i=`${e}.${r}`,o=await t(i);if(!o)break;n.push(o)}return n.length>0?n.join(""):null}let tK="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),tV=" 	\n\r=".split(""),tG=(()=>{let e=Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<tV.length;t+=1)e[tV[t].charCodeAt(0)]=-2;for(let t=0;t<tK.length;t+=1)e[tK[t].charCodeAt(0)]=t;return e})();function tX(e){let t=[],r=0,n=0;if(function(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){let t=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|t)+65536,r+=1}!function(e,t){if(e<=127){t(e);return}if(e<=2047){t(192|e>>6),t(128|63&e);return}if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|63&e);return}if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|63&e);return}throw Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}(n,t)}}(e,e=>{for(r=r<<8|e,n+=8;n>=6;){let e=r>>n-6&63;t.push(tK[e]),n-=6}}),n>0)for(r<<=6-n,n=6;n>=6;){let e=r>>n-6&63;t.push(tK[e]),n-=6}return t.join("")}function tQ(e){let t=[],r=e=>{t.push(String.fromCodePoint(e))},n={utf8seq:0,codepoint:0},i=0,o=0;for(let t=0;t<e.length;t+=1){let s=tG[e.charCodeAt(t)];if(s>-1)for(i=i<<6|s,o+=6;o>=8;)(function(e,t,r){if(0===t.utf8seq){if(e<=127){r(e);return}for(let r=1;r<6;r+=1)if((e>>7-r&1)==0){t.utf8seq=r;break}if(2===t.utf8seq)t.codepoint=31&e;else if(3===t.utf8seq)t.codepoint=15&e;else if(4===t.utf8seq)t.codepoint=7&e;else throw Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|63&e,t.utf8seq-=1,0===t.utf8seq&&r(t.codepoint)}})(i>>o-8&255,n,r),o-=8;else if(-2===s)continue;else throw Error(`Invalid Base64-URL character "${e.at(t)}" at position ${t}`)}return t.join("")}let tZ="base64-";async function t0({getAll:e,setAll:t,setItems:r,removedItems:n},i){let o=i.cookieEncoding,s=i.cookieOptions??null,a=await e([...r?Object.keys(r):[],...n?Object.keys(n):[]]),u=a?.map(({name:e})=>e)||[],l=Object.keys(n).flatMap(e=>u.filter(t=>tW(t,e))),c=Object.keys(r).flatMap(e=>{let t=new Set(u.filter(t=>tW(t,e))),n=r[e];"base64url"===o&&(n=tZ+tX(n));let i=tJ(e,n);return i.forEach(e=>{t.delete(e.name)}),l.push(...t),i}),h={...tF,...s,maxAge:0},d={...tF,...s,maxAge:tF.maxAge};delete h.name,delete d.name,await t([...l.map(e=>({name:e,value:"",options:h})),...c.map(({name:e,value:t})=>({name:e,value:t,options:d}))])}function t1(e,t,r){let i=r?.isSingleton===!0||(!r||!("isSingleton"in r))&&tB();if(i&&n)return n;if(!e||!t)throw Error(`@supabase/ssr: Your project's URL and API key are required to create a Supabase client!

Check your Supabase project's API settings to find these values

https://supabase.com/dashboard/project/_/settings/api`);let{storage:o}=function(e,t){let r,n;let i=e.cookies??null,o=e.cookieEncoding,s={},a={};if(i){if("get"in i){let e=async e=>{let t=e.flatMap(e=>[e,...Array.from({length:5}).map((t,r)=>`${e}.${r}`)]),r=[];for(let e=0;e<t.length;e+=1){let n=await i.get(t[e]);(n||"string"==typeof n)&&r.push({name:t[e],value:n})}return r};if(r=async t=>await e(t),"set"in i&&"remove"in i)n=async e=>{for(let t=0;t<e.length;t+=1){let{name:r,value:n,options:o}=e[t];n?await i.set(r,n,o):await i.remove(r,o)}};else if(t)n=async()=>{console.warn("@supabase/ssr: createServerClient was configured without set and remove cookie methods, but the client needs to set cookies. This can lead to issues such as random logouts, early session termination or increased token refresh requests. If in NextJS, check your middleware.ts file, route handlers and server actions for correctness. Consider switching to the getAll and setAll cookie methods instead of get, set and remove which are deprecated and can be difficult to use correctly.")};else throw Error("@supabase/ssr: createBrowserClient requires configuring a getAll and setAll cookie method (deprecated: alternatively both get, set and remove can be used)")}else if("getAll"in i){if(r=async()=>await i.getAll(),"setAll"in i)n=i.setAll;else if(t)n=async()=>{console.warn("@supabase/ssr: createServerClient was configured without the setAll cookie method, but the client needs to set cookies. This can lead to issues such as random logouts, early session termination or increased token refresh requests. If in NextJS, check your middleware.ts file, route handlers and server actions for correctness.")};else throw Error("@supabase/ssr: createBrowserClient requires configuring both getAll and setAll cookie methods (deprecated: alternatively both get, set and remove can be used)")}else throw Error(`@supabase/ssr: ${t?"createServerClient":"createBrowserClient"} requires configuring getAll and setAll cookie methods (deprecated: alternatively use get, set and remove).${tB()?" As this is called in a browser runtime, consider removing the cookies option object to use the document.cookie API automatically.":""}`)}else if(!t&&tB()){let e=()=>{let e=(0,tM.q)(document.cookie);return Object.keys(e).map(t=>({name:t,value:e[t]}))};r=()=>e(),n=e=>{e.forEach(({name:e,value:t,options:r})=>{document.cookie=(0,tM.l)(e,t,r)})}}else if(t)throw Error("@supabase/ssr: createServerClient must be initialized with cookie options that specify getAll and setAll functions (deprecated, not recommended: alternatively use get, set and remove)");else r=()=>[],n=()=>{throw Error("@supabase/ssr: createBrowserClient in non-browser runtimes (including Next.js pre-rendering mode) was not initialized cookie options that specify getAll and setAll functions (deprecated: alternatively use get, set and remove), but they were needed")};return t?{getAll:r,setAll:n,setItems:s,removedItems:a,storage:{isServer:!0,getItem:async e=>{if("string"==typeof s[e])return s[e];if(a[e])return null;let t=await r([e]),n=await tY(e,async e=>{let r=t?.find(({name:t})=>t===e)||null;return r?r.value:null});if(!n)return null;let i=n;return"string"==typeof n&&n.startsWith(tZ)&&(i=tQ(n.substring(tZ.length))),i},setItem:async(t,i)=>{t.endsWith("-code-verifier")&&await t0({getAll:r,setAll:n,setItems:{[t]:i},removedItems:{}},{cookieOptions:e?.cookieOptions??null,cookieEncoding:o}),s[t]=i,delete a[t]},removeItem:async e=>{delete s[e],a[e]=!0}}}:{getAll:r,setAll:n,setItems:s,removedItems:a,storage:{isServer:!1,getItem:async e=>{let t=await r([e]),n=await tY(e,async e=>{let r=t?.find(({name:t})=>t===e)||null;return r?r.value:null});if(!n)return null;let i=n;return n.startsWith(tZ)&&(i=tQ(n.substring(tZ.length))),i},setItem:async(t,i)=>{let s=await r([t]),a=new Set((s?.map(({name:e})=>e)||[]).filter(e=>tW(e,t))),u=i;"base64url"===o&&(u=tZ+tX(i));let l=tJ(t,u);l.forEach(({name:e})=>{a.delete(e)});let c={...tF,...e?.cookieOptions,maxAge:0},h={...tF,...e?.cookieOptions,maxAge:tF.maxAge};delete c.name,delete h.name;let d=[...[...a].map(e=>({name:e,value:"",options:c})),...l.map(({name:e,value:t})=>({name:e,value:t,options:h}))];d.length>0&&await n(d)},removeItem:async t=>{let i=await r([t]),o=(i?.map(({name:e})=>e)||[]).filter(e=>tW(e,t)),s={...tF,...e?.cookieOptions,maxAge:0};delete s.name,o.length>0&&await n(o.map(e=>({name:e,value:"",options:s})))}}}}({...r,cookieEncoding:r?.cookieEncoding??"base64url"},!1),s=tq(e,t,{...r,global:{...r?.global,headers:{...r?.global?.headers,"X-Client-Info":"supabase-ssr/0.5.2"}},auth:{...r?.auth,...r?.cookieOptions?.name?{storageKey:r.cookieOptions.name}:null,flowType:"pkce",autoRefreshToken:tB(),detectSessionInUrl:tB(),persistSession:!0,storage:o}});return i&&(n=s),s}},11727:(e,t,r)=>{"use strict";r.d(t,{P:()=>s,v:()=>u});var n=r(93467),i=r(49803);let o=e=>e;function s(e,t=o){let r=n.useSyncExternalStore(e.subscribe,n.useCallback(()=>t(e.getState()),[e,t]),n.useCallback(()=>t(e.getInitialState()),[e,t]));return n.useDebugValue(r),r}let a=e=>{let t=(0,i.y)(e),r=e=>s(t,e);return Object.assign(r,t),r},u=e=>e?a(e):a},12029:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PostgrestError=t.PostgrestBuilder=t.PostgrestTransformBuilder=t.PostgrestFilterBuilder=t.PostgrestQueryBuilder=t.PostgrestClient=void 0;let i=n(r(30955));t.PostgrestClient=i.default;let o=n(r(42491));t.PostgrestQueryBuilder=o.default;let s=n(r(74753));t.PostgrestFilterBuilder=s.default;let a=n(r(51719));t.PostgrestTransformBuilder=a.default;let u=n(r(77647));t.PostgrestBuilder=u.default;let l=n(r(66906));t.PostgrestError=l.default,t.default={PostgrestClient:i.default,PostgrestQueryBuilder:o.default,PostgrestFilterBuilder:s.default,PostgrestTransformBuilder:a.default,PostgrestBuilder:u.default,PostgrestError:l.default}},18891:(e,t,r)=>{"use strict";function n(){let e,t;let r=new Promise((r,n)=>{e=r,t=n});function n(e){Object.assign(r,e),delete r.resolve,delete r.reject}return r.status="pending",r.catch(()=>{}),r.resolve=t=>{n({status:"fulfilled",value:t}),e(t)},r.reject=e=>{n({status:"rejected",reason:e}),t(e)},r}r.d(t,{T:()=>n})},29924:(e,t,r)=>{"use strict";r.d(t,{Se:()=>u,T$:()=>a});var n,i=r(73728),o=r(5383),s=r(85558),a=function(){function e(){this._propertySet=new Set,this._properties={}}return e.prototype.getUserProperties=function(){return(0,i.Cl)({},this._properties)},e.prototype.set=function(e,t){return this._safeSet(n.SET,e,t),this},e.prototype.setOnce=function(e,t){return this._safeSet(n.SET_ONCE,e,t),this},e.prototype.append=function(e,t){return this._safeSet(n.APPEND,e,t),this},e.prototype.prepend=function(e,t){return this._safeSet(n.PREPEND,e,t),this},e.prototype.postInsert=function(e,t){return this._safeSet(n.POSTINSERT,e,t),this},e.prototype.preInsert=function(e,t){return this._safeSet(n.PREINSERT,e,t),this},e.prototype.remove=function(e,t){return this._safeSet(n.REMOVE,e,t),this},e.prototype.add=function(e,t){return this._safeSet(n.ADD,e,t),this},e.prototype.unset=function(e){return this._safeSet(n.UNSET,e,o.mG),this},e.prototype.clearAll=function(){return this._properties={},this._properties[n.CLEAR_ALL]=o.mG,this},e.prototype._safeSet=function(e,t,r){if(this._validate(e,t,r)){var n=this._properties[e];return void 0===n&&(n={},this._properties[e]=n),n[t]=r,this._propertySet.add(t),!0}return!1},e.prototype._validate=function(e,t,r){return!(void 0!==this._properties[n.CLEAR_ALL]||this._propertySet.has(t))&&(e===n.ADD?"number"==typeof r:e===n.UNSET||e===n.REMOVE||(0,s.E)(t,r))},e}();!function(e){e.SET="$set",e.SET_ONCE="$setOnce",e.ADD="$add",e.APPEND="$append",e.PREPEND="$prepend",e.REMOVE="$remove",e.PREINSERT="$preInsert",e.POSTINSERT="$postInsert",e.UNSET="$unset",e.CLEAR_ALL="$clearAll"}(n||(n={}));var u=[n.CLEAR_ALL,n.UNSET,n.SET,n.SET_ONCE,n.ADD,n.APPEND,n.PREPEND,n.PREINSERT,n.POSTINSERT,n.REMOVE]},30955:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let i=n(r(42491)),o=n(r(74753));class s{constructor(e,{headers:t={},schema:r,fetch:n}={}){this.url=e,this.headers=new Headers(t),this.schemaName=r,this.fetch=n}from(e){let t=new URL(`${this.url}/${e}`);return new i.default(t,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new s(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:r=!1,get:n=!1,count:i}={}){var s;let a,u;let l=new URL(`${this.url}/rpc/${e}`);r||n?(a=r?"HEAD":"GET",Object.entries(t).filter(([e,t])=>void 0!==t).map(([e,t])=>[e,Array.isArray(t)?`{${t.join(",")}}`:`${t}`]).forEach(([e,t])=>{l.searchParams.append(e,t)})):(a="POST",u=t);let c=new Headers(this.headers);return i&&c.set("Prefer",`count=${i}`),new o.default({method:a,url:l,headers:c,schema:this.schemaName,body:u,fetch:null!==(s=this.fetch)&&void 0!==s?s:fetch})}}t.default=s},31790:(e,t,r)=>{"use strict";r.d(t,{Ht:()=>a,jE:()=>s});var n=r(93467),i=r(12939),o=n.createContext(void 0),s=e=>{let t=n.useContext(o);if(e)return e;if(!t)throw Error("No QueryClient set, use QueryClientProvider to set one");return t},a=e=>{let{client:t,children:r}=e;return n.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),(0,i.jsx)(o.Provider,{value:t,children:r})}},32420:(e,t,r)=>{"use strict";r.d(t,{A:()=>u});var n=r(93467);let i=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),o=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()};var s={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let a=(0,n.forwardRef)((e,t)=>{let{color:r="currentColor",size:i=24,strokeWidth:a=2,absoluteStrokeWidth:u,className:l="",children:c,iconNode:h,...d}=e;return(0,n.createElement)("svg",{ref:t,...s,width:i,height:i,stroke:r,strokeWidth:u?24*Number(a)/Number(i):a,className:o("lucide",l),...d},[...h.map(e=>{let[t,r]=e;return(0,n.createElement)(t,r)}),...Array.isArray(c)?c:[c]])}),u=(e,t)=>{let r=(0,n.forwardRef)((r,s)=>{let{className:u,...l}=r;return(0,n.createElement)(a,{ref:s,iconNode:t,className:o("lucide-".concat(i(e)),u),...l})});return r.displayName="".concat(e),r}},35795:(e,t,r)=>{"use strict";r.d(t,{m:()=>o});var n=r(77917),i=r(68593),o=new class extends n.Q{#e;#t;#r;constructor(){super(),this.#r=e=>{if(!i.S$&&window.addEventListener){let t=()=>e();return window.addEventListener("visibilitychange",t,!1),()=>{window.removeEventListener("visibilitychange",t)}}}}onSubscribe(){this.#t||this.setEventListener(this.#r)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(e){this.#r=e,this.#t?.(),this.#t=e(e=>{"boolean"==typeof e?this.setFocused(e):this.onFocus()})}setFocused(e){this.#e!==e&&(this.#e=e,this.onFocus())}onFocus(){let e=this.isFocused();this.listeners.forEach(t=>{t(e)})}isFocused(){return"boolean"==typeof this.#e?this.#e:globalThis.document?.visibilityState!=="hidden"}}},41738:(e,t,r)=>{"use strict";r.d(t,{n:()=>c});var n=r(93467),i=r(67471),o=r(85900),s=r(77917),a=r(68593),u=class extends s.Q{#n;#i=void 0;#o;#s;constructor(e,t){super(),this.#n=e,this.setOptions(t),this.bindMethods(),this.#a()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){let t=this.options;this.options=this.#n.defaultMutationOptions(e),(0,a.f8)(this.options,t)||this.#n.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#o,observer:this}),t?.mutationKey&&this.options.mutationKey&&(0,a.EN)(t.mutationKey)!==(0,a.EN)(this.options.mutationKey)?this.reset():this.#o?.state.status==="pending"&&this.#o.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#o?.removeObserver(this)}onMutationUpdate(e){this.#a(),this.#u(e)}getCurrentResult(){return this.#i}reset(){this.#o?.removeObserver(this),this.#o=void 0,this.#a(),this.#u()}mutate(e,t){return this.#s=t,this.#o?.removeObserver(this),this.#o=this.#n.getMutationCache().build(this.#n,this.options),this.#o.addObserver(this),this.#o.execute(e)}#a(){let e=this.#o?.state??(0,i.$)();this.#i={...e,isPending:"pending"===e.status,isSuccess:"success"===e.status,isError:"error"===e.status,isIdle:"idle"===e.status,mutate:this.mutate,reset:this.reset}}#u(e){o.jG.batch(()=>{if(this.#s&&this.hasListeners()){let t=this.#i.variables,r=this.#i.context;e?.type==="success"?(this.#s.onSuccess?.(e.data,t,r),this.#s.onSettled?.(e.data,null,t,r)):e?.type==="error"&&(this.#s.onError?.(e.error,t,r),this.#s.onSettled?.(void 0,e.error,t,r))}this.listeners.forEach(e=>{e(this.#i)})})}},l=r(31790);function c(e,t){let r=(0,l.jE)(t),[i]=n.useState(()=>new u(r,e));n.useEffect(()=>{i.setOptions(e)},[i,e]);let s=n.useSyncExternalStore(n.useCallback(e=>i.subscribe(o.jG.batchCalls(e)),[i]),()=>i.getCurrentResult(),()=>i.getCurrentResult()),c=n.useCallback((e,t)=>{i.mutate(e,t).catch(a.lQ)},[i]);if(s.error&&(0,a.GU)(i.options.throwOnError,[s.error]))throw s.error;return{...s,mutate:c,mutateAsync:s.mutate}}},42491:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let i=n(r(74753));class o{constructor(e,{headers:t={},schema:r,fetch:n}){this.url=e,this.headers=new Headers(t),this.schema=r,this.fetch=n}select(e,{head:t=!1,count:r}={}){let n=!1,o=(null!=e?e:"*").split("").map(e=>/\s/.test(e)&&!n?"":('"'===e&&(n=!n),e)).join("");return this.url.searchParams.set("select",o),r&&this.headers.append("Prefer",`count=${r}`),new i.default({method:t?"HEAD":"GET",url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(e,{count:t,defaultToNull:r=!0}={}){var n;if(t&&this.headers.append("Prefer",`count=${t}`),r||this.headers.append("Prefer","missing=default"),Array.isArray(e)){let t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){let e=[...new Set(t)].map(e=>`"${e}"`);this.url.searchParams.set("columns",e.join(","))}}return new i.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:null!==(n=this.fetch)&&void 0!==n?n:fetch})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:n,defaultToNull:o=!0}={}){var s;if(this.headers.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),void 0!==t&&this.url.searchParams.set("on_conflict",t),n&&this.headers.append("Prefer",`count=${n}`),o||this.headers.append("Prefer","missing=default"),Array.isArray(e)){let t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){let e=[...new Set(t)].map(e=>`"${e}"`);this.url.searchParams.set("columns",e.join(","))}}return new i.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:null!==(s=this.fetch)&&void 0!==s?s:fetch})}update(e,{count:t}={}){var r;return t&&this.headers.append("Prefer",`count=${t}`),new i.default({method:"PATCH",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:null!==(r=this.fetch)&&void 0!==r?r:fetch})}delete({count:e}={}){var t;return e&&this.headers.append("Prefer",`count=${e}`),new i.default({method:"DELETE",url:this.url,headers:this.headers,schema:this.schema,fetch:null!==(t=this.fetch)&&void 0!==t?t:fetch})}}t.default=o},49803:(e,t,r)=>{"use strict";r.d(t,{y:()=>i});let n=e=>{let t;let r=new Set,n=(e,n)=>{let i="function"==typeof e?e(t):e;if(!Object.is(i,t)){let e=t;t=(null!=n?n:"object"!=typeof i||null===i)?i:Object.assign({},t,i),r.forEach(r=>r(t,e))}},i=()=>t,o={setState:n,getState:i,getInitialState:()=>s,subscribe:e=>(r.add(e),()=>r.delete(e))},s=t=e(n,i,o);return o},i=e=>e?n(e):n},51719:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let i=n(r(77647));class o extends i.default{select(e){let t=!1,r=(null!=e?e:"*").split("").map(e=>/\s/.test(e)&&!t?"":('"'===e&&(t=!t),e)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:n,referencedTable:i=n}={}){let o=i?`${i}.order`:"order",s=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${s?`${s},`:""}${e}.${t?"asc":"desc"}${void 0===r?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){let n=void 0===r?"limit":`${r}.limit`;return this.url.searchParams.set(n,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:n=r}={}){let i=void 0===n?"offset":`${n}.offset`,o=void 0===n?"limit":`${n}.limit`;return this.url.searchParams.set(i,`${e}`),this.url.searchParams.set(o,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return"GET"===this.method?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:n=!1,wal:i=!1,format:o="text"}={}){var s;let a=[e?"analyze":null,t?"verbose":null,r?"settings":null,n?"buffers":null,i?"wal":null].filter(Boolean).join("|"),u=null!==(s=this.headers.get("Accept"))&&void 0!==s?s:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${o}; for="${u}"; options=${a};`),this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}}t.default=o},54605:(e,t,r)=>{"use strict";let n;r.d(t,{ls:()=>iP,Ts:()=>ix,do:()=>iR,u4:()=>ij});var i,o,s,a,u,l,c,h,d,f,p,v,g,y=r(73728);!function(e){e[e.None=0]="None",e[e.Error=1]="Error",e[e.Warn=2]="Warn",e[e.Verbose=3]="Verbose",e[e.Debug=4]="Debug"}(i||(i={}));var m=function(e){return function(){var t=(0,y.Cl)({},e.config);return{logger:t.loggerProvider,logLevel:t.logLevel}}},b=function(e,t){var r,n;t=(t=t.replace(/\[(\w+)\]/g,".$1")).replace(/^\./,"");try{for(var i=(0,y.Ju)(t.split(".")),o=i.next();!o.done;o=i.next()){var s=o.value;if(!(s in e))return;e=e[s]}}catch(e){r={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return e},w=function(e,t){return function(){var r,n,i={};try{for(var o=(0,y.Ju)(t),s=o.next();!s.done;s=o.next()){var a=s.value;i[a]=b(e,a)}}catch(e){r={error:e}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return i}},_=function(e,t,r,n,o){return void 0===o&&(o=null),function(){for(var s=[],a=0;a<arguments.length;a++)s[a]=arguments[a];var u=r(),l=u.logger,c=u.logLevel;if(c&&c<i.Debug||!c||!l)return e.apply(o,s);var h={type:"invoke public method",name:t,args:s,stacktrace:(Error().stack||"").split("\n").slice(3).map(function(e){return e.trim()}),time:{start:new Date().toISOString()},states:{}};n&&h.states&&(h.states.before=n());var d=e.apply(o,s);return d&&d.promise?d.promise.then(function(){n&&h.states&&(h.states.after=n()),h.time&&(h.time.end=new Date().toISOString()),l.debug(JSON.stringify(h,null,2))}):(n&&h.states&&(h.states.after=n()),h.time&&(h.time.end=new Date().toISOString()),l.debug(JSON.stringify(h,null,2))),d}},k=function(e){return{promise:e||Promise.resolve()}},S=function(){function e(e,t){this.key="AMP_remote_config_".concat(e.substring(0,10)),this.logger=t}return e.prototype.fetchConfig=function(){var e=null,t={remoteConfig:null,lastFetch:new Date};try{e=localStorage.getItem(this.key)}catch(e){return this.logger.debug("Remote config localstorage failed to access: ",e),Promise.resolve(t)}if(null===e)return this.logger.debug("Remote config localstorage gets null because the key does not exist"),Promise.resolve(t);try{var r=JSON.parse(e);return this.logger.debug("Remote config localstorage parsed successfully: ".concat(JSON.stringify(r))),Promise.resolve({remoteConfig:r.remoteConfig,lastFetch:new Date(r.lastFetch)})}catch(e){return this.logger.debug("Remote config localstorage failed to parse: ",e),localStorage.removeItem(this.key),Promise.resolve(t)}},e.prototype.setConfig=function(e){try{return localStorage.setItem(this.key,JSON.stringify(e)),this.logger.debug("Remote config localstorage set successfully."),Promise.resolve(!0)}catch(e){this.logger.debug("Remote config localstorage failed to set: ",e)}return Promise.resolve(!1)},e}(),E=function(){var e="ampIntegrationContext";return"undefined"!=typeof globalThis&&void 0!==globalThis[e]?globalThis[e]:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof self?self:void 0!==r.g?r.g:void 0},T=(0,y.fX)([],(0,y.zs)(Array(256).keys()),!1).map(function(e){return e.toString(16).padStart(2,"0")}),C=function(e){var t,r=E();if(!(null===(t=null==r?void 0:r.crypto)||void 0===t?void 0:t.getRandomValues))return e?(e^16*Math.random()>>e/4).toString(16):(String(1e7)+String(-1e3)+String(-4e3)+String(-8e3)+String(-1e11)).replace(/[018]/g,C);var n=r.crypto.getRandomValues(new Uint8Array(16));return n[6]=15&n[6]|64,n[8]=63&n[8]|128,(0,y.fX)([],(0,y.zs)(n.entries()),!1).map(function(e){var t=(0,y.zs)(e,2),r=t[0],n=t[1];return[4,6,8,10].includes(r)?"-".concat(T[n]):T[n]}).join("")},O=function(){function e(e,t,r){void 0===r&&(r="US"),this.callbackInfos=[],this.apiKey=e,this.serverUrl="US"===r?"https://sr-client-cfg.amplitude.com/config":"https://sr-client-cfg.eu.amplitude.com/config",this.logger=t,this.storage=new S(e,t)}return e.prototype.subscribe=function(e,t,r){var n=C(),i={id:n,key:e,deliveryMode:t,callback:r};return this.callbackInfos.push(i),"all"===t?this.subscribeAll(i):this.subscribeWaitForRemote(i,t.timeout),n},e.prototype.unsubscribe=function(e){var t=this.callbackInfos.findIndex(function(t){return t.id===e});return -1===t?(this.logger.debug("Remote config client unsubscribe failed because callback with id ".concat(e," doesn't exist.")),!1):(this.callbackInfos.splice(t,1),this.logger.debug("Remote config client unsubscribe succeeded removing callback with id ".concat(e,".")),!0)},e.prototype.updateConfigs=function(){return(0,y.sH)(this,void 0,void 0,function(){var e,t=this;return(0,y.YH)(this,function(r){switch(r.label){case 0:return[4,this.fetch()];case 1:return e=r.sent(),this.storage.setConfig(e),this.callbackInfos.forEach(function(r){t.sendCallback(r,e,"remote")}),[2]}})})},e.prototype.subscribeAll=function(e){return(0,y.sH)(this,void 0,void 0,function(){var t,r,n,i=this;return(0,y.YH)(this,function(o){switch(o.label){case 0:return t=this.fetch().then(function(t){i.logger.debug("Remote config client subscription all mode fetched from remote: ".concat(JSON.stringify(t))),i.sendCallback(e,t,"remote"),i.storage.setConfig(t)}),r=this.storage.fetchConfig().then(function(e){return e}),[4,Promise.race([t,r])];case 1:return void 0!==(n=o.sent())&&(this.logger.debug("Remote config client subscription all mode fetched from cache: ".concat(JSON.stringify(n))),this.sendCallback(e,n,"cache")),[4,t];case 2:return o.sent(),[2]}})})},e.prototype.subscribeWaitForRemote=function(e,t){return(0,y.sH)(this,void 0,void 0,function(){var r,n;return(0,y.YH)(this,function(i){switch(i.label){case 0:r=new Promise(function(e,r){setTimeout(function(){r("Timeout exceeded")},t)}),i.label=1;case 1:return i.trys.push([1,3,,5]),[4,Promise.race([this.fetch(),r])];case 2:return n=i.sent(),this.logger.debug("Remote config client subscription wait for remote mode returns from remote."),this.sendCallback(e,n,"remote"),this.storage.setConfig(n),[3,5];case 3:return i.sent(),this.logger.debug("Remote config client subscription wait for remote mode exceeded timeout. Try to fetch from cache."),[4,this.storage.fetchConfig()];case 4:return null!==(n=i.sent()).remoteConfig?(this.logger.debug("Remote config client subscription wait for remote mode returns a cached copy."),this.sendCallback(e,n,"cache")):(this.logger.debug("Remote config client subscription wait for remote mode failed to fetch cache."),this.sendCallback(e,n,"remote")),[3,5];case 5:return[2]}})})},e.prototype.sendCallback=function(e,t,r){var n;e.lastCallback=new Date,n=e.key?e.key.split(".").reduce(function(e,t){return null===e?e:t in e?e[t]:null},t.remoteConfig):t.remoteConfig,e.callback(n,r,t.lastFetch)},e.prototype.fetch=function(e,t){return void 0===e&&(e=3),void 0===t&&(t=1e3),(0,y.sH)(this,void 0,void 0,function(){var r,n,i,o,s,a,u=this;return(0,y.YH)(this,function(l){switch(l.label){case 0:r=t/e,n={remoteConfig:null,lastFetch:new Date},i=function(n){var i,s,a,l,c;return(0,y.YH)(this,function(h){switch(h.label){case 0:i=new AbortController,s=setTimeout(function(){return i.abort()},t),h.label=1;case 1:return h.trys.push([1,7,8,9]),[4,fetch(o.getUrlParams(),{method:"GET",headers:{Accept:"*/*"},signal:i.signal})];case 2:if((a=h.sent()).ok)return[3,4];return[4,a.text()];case 3:return l=h.sent(),o.logger.debug("Remote config client fetch with retry time ".concat(e," failed with ").concat(a.status,": ").concat(l)),[3,6];case 4:return[4,a.json()];case 5:return[2,{value:{remoteConfig:h.sent(),lastFetch:new Date}}];case 6:return[3,9];case 7:return(c=h.sent())instanceof Error&&"AbortError"===c.name?o.logger.debug("Remote config client fetch with retry time ".concat(e," timed out after ").concat(t,"ms")):o.logger.debug("Remote config client fetch with retry time ".concat(e," is rejected because: "),c),[3,9];case 8:return clearTimeout(s),[7];case 9:if(!(n<e-1))return[3,11];return[4,new Promise(function(e){return setTimeout(e,u.getJitterDelay(r))})];case 10:h.sent(),h.label=11;case 11:return[2]}})},o=this,s=0,l.label=1;case 1:if(!(s<e))return[3,4];return[5,i(s)];case 2:if("object"==typeof(a=l.sent()))return[2,a.value];l.label=3;case 3:return s++,[3,1];case 4:return[2,n]}})})},e.prototype.getJitterDelay=function(e){return Math.floor(Math.random()*e)},e.prototype.getUrlParams=function(){var t=encodeURIComponent(this.apiKey),r=new URLSearchParams;return r.append("config_group",e.CONFIG_GROUP),"".concat(this.serverUrl,"/").concat(t,"?").concat(r.toString())},e.CONFIG_GROUP="browser",e}(),A=function(){var e,t=E();return(null===(e=null==t?void 0:t.location)||void 0===e?void 0:e.search)?t.location.search.substring(1).split("&").filter(Boolean).reduce(function(e,t){var r=t.split("=",2),n=I(r[0]),i=I(r[1]);return i&&(e[n]=i),e},{}):{}},I=function(e){void 0===e&&(e="");try{return decodeURIComponent(e)}catch(e){return""}},P=function(){function e(){}return e.prototype.getApplicationContext=function(){return{versionName:this.versionName,language:x(),platform:"Web",os:void 0,deviceModel:void 0}},e}(),x=function(){return"undefined"!=typeof navigator&&(navigator.languages&&navigator.languages[0]||navigator.language)||""},R=function(){function e(){this.queue=[]}return e.prototype.logEvent=function(e){this.receiver?this.receiver(e):this.queue.length<512&&this.queue.push(e)},e.prototype.setEventReceiver=function(e){this.receiver=e,this.queue.length>0&&(this.queue.forEach(function(t){e(t)}),this.queue=[])},e}(),j=function(){return(j=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function U(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function L(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return s}"function"==typeof SuppressedError&&SuppressedError;var N=function(e,t){var r,n,i=typeof e;if(i!==typeof t)return!1;try{for(var o=U(["string","number","boolean","undefined"]),s=o.next();!s.done;s=o.next())if(s.value===i)return e===t}catch(e){r={error:e}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}if(null==e&&null==t)return!0;if(null==e||null==t||e.length!==t.length)return!1;var a=Array.isArray(e),u=Array.isArray(t);if(a!==u)return!1;if(a&&u){for(var l=0;l<e.length;l++)if(!N(e[l],t[l]))return!1}else{if(!N(Object.keys(e).sort(),Object.keys(t).sort()))return!1;var c=!0;return Object.keys(e).forEach(function(r){N(e[r],t[r])||(c=!1)}),c}return!0};Object.entries||(Object.entries=function(e){for(var t=Object.keys(e),r=t.length,n=Array(r);r--;)n[r]=[t[r],e[t[r]]];return n});var $=function(){function e(){this.identity={userProperties:{}},this.listeners=new Set}return e.prototype.editIdentity=function(){var e=this,t=j({},this.identity.userProperties),r=j(j({},this.identity),{userProperties:t});return{setUserId:function(e){return r.userId=e,this},setDeviceId:function(e){return r.deviceId=e,this},setUserProperties:function(e){return r.userProperties=e,this},setOptOut:function(e){return r.optOut=e,this},updateUserProperties:function(e){var t,n,i,o,s,a,u=r.userProperties||{};try{for(var l=U(Object.entries(e)),c=l.next();!c.done;c=l.next()){var h=L(c.value,2),d=h[0],f=h[1];switch(d){case"$set":try{for(var p=(i=void 0,U(Object.entries(f))),v=p.next();!v.done;v=p.next()){var g=L(v.value,2),y=g[0],m=g[1];u[y]=m}}catch(e){i={error:e}}finally{try{v&&!v.done&&(o=p.return)&&o.call(p)}finally{if(i)throw i.error}}break;case"$unset":try{for(var b=(s=void 0,U(Object.keys(f))),w=b.next();!w.done;w=b.next()){var y=w.value;delete u[y]}}catch(e){s={error:e}}finally{try{w&&!w.done&&(a=b.return)&&a.call(b)}finally{if(s)throw s.error}}break;case"$clearAll":u={}}}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=l.return)&&n.call(l)}finally{if(t)throw t.error}}return r.userProperties=u,this},commit:function(){return e.setIdentity(r),this}}},e.prototype.getIdentity=function(){return j({},this.identity)},e.prototype.setIdentity=function(e){var t=j({},this.identity);this.identity=j({},e),N(t,this.identity)||this.listeners.forEach(function(t){t(e)})},e.prototype.addIdentityListener=function(e){this.listeners.add(e)},e.prototype.removeIdentityListener=function(e){this.listeners.delete(e)},e}(),D="undefined"!=typeof globalThis?globalThis:void 0!==r.g?r.g:self,H=function(){function e(){this.identityStore=new $,this.eventBridge=new R,this.applicationContextProvider=new P}return e.getInstance=function(t){return D.analyticsConnectorInstances||(D.analyticsConnectorInstances={}),D.analyticsConnectorInstances[t]||(D.analyticsConnectorInstances[t]=new e),D.analyticsConnectorInstances[t]},e}(),q=r(5383),M=function(e){return void 0===e&&(e=q.e5),H.getInstance(e)},B=function(e,t){M(t).identityStore.editIdentity().setUserId(e).commit()},F=function(e,t){M(t).identityStore.editIdentity().setDeviceId(e).commit()};!function(e){e.Unknown="unknown",e.Skipped="skipped",e.Success="success",e.RateLimit="rate_limit",e.PayloadTooLarge="payload_too_large",e.Invalid="invalid",e.Failed="failed",e.Timeout="Timeout",e.SystemError="SystemError"}(o||(o={}));var z=function(e,t){var r=Math.max(t,1);return e.reduce(function(e,t,n){var i=Math.floor(n/r);return e[i]||(e[i]=[]),e[i].push(t),e},[])},W=function(e,t,r){return void 0===t&&(t=0),void 0===r&&(r=o.Unknown),{event:e,code:t,message:r}},J="Amplitude Logger ",Y=function(){function e(){this.logLevel=i.None}return e.prototype.disable=function(){this.logLevel=i.None},e.prototype.enable=function(e){void 0===e&&(e=i.Warn),this.logLevel=e},e.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];!(this.logLevel<i.Verbose)&&console.log("".concat(J,"[Log]: ").concat(e.join(" ")))},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];!(this.logLevel<i.Warn)&&console.warn("".concat(J,"[Warn]: ").concat(e.join(" ")))},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];!(this.logLevel<i.Error)&&console.error("".concat(J,"[Error]: ").concat(e.join(" ")))},e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];!(this.logLevel<i.Debug)&&console.log("".concat(J,"[Debug]: ").concat(e.join(" ")))},e}(),K=function(){return{flushMaxRetries:12,flushQueueSize:200,flushIntervalMillis:1e4,instanceName:q.e5,logLevel:i.Warn,loggerProvider:new Y,offline:!1,optOut:!1,serverUrl:q.mJ,serverZone:"US",useBatch:!1}},V=function(){function e(e){this._optOut=!1;var t,r,n,i,o=K();this.apiKey=e.apiKey,this.flushIntervalMillis=null!==(t=e.flushIntervalMillis)&&void 0!==t?t:o.flushIntervalMillis,this.flushMaxRetries=e.flushMaxRetries||o.flushMaxRetries,this.flushQueueSize=e.flushQueueSize||o.flushQueueSize,this.instanceName=e.instanceName||o.instanceName,this.loggerProvider=e.loggerProvider||o.loggerProvider,this.logLevel=null!==(r=e.logLevel)&&void 0!==r?r:o.logLevel,this.minIdLength=e.minIdLength,this.plan=e.plan,this.ingestionMetadata=e.ingestionMetadata,this.offline=void 0!==e.offline?e.offline:o.offline,this.optOut=null!==(n=e.optOut)&&void 0!==n?n:o.optOut,this.serverUrl=e.serverUrl,this.serverZone=e.serverZone||o.serverZone,this.storageProvider=e.storageProvider,this.transportProvider=e.transportProvider,this.useBatch=null!==(i=e.useBatch)&&void 0!==i?i:o.useBatch,this.loggerProvider.enable(this.logLevel);var s=G(e.serverUrl,e.serverZone,e.useBatch);this.serverZone=s.serverZone,this.serverUrl=s.serverUrl}return Object.defineProperty(e.prototype,"optOut",{get:function(){return this._optOut},set:function(e){this._optOut=e},enumerable:!1,configurable:!0}),e}(),G=function(e,t,r){if(void 0===e&&(e=""),void 0===t&&(t=K().serverZone),void 0===r&&(r=K().useBatch),e)return{serverUrl:e,serverZone:void 0};var n,i=["US","EU"].includes(t)?t:K().serverZone;return{serverZone:i,serverUrl:(n=r,"EU"===i?n?q.OP:q.bu:n?q.pL:q.mJ)}},X=function(){function e(){this.sdk={metrics:{histogram:{}}}}return e.prototype.recordHistogram=function(e,t){this.sdk.metrics.histogram[e]=t},e}();function Q(e){var t="";try{"body"in e&&(t=JSON.stringify(e.body,null,2))}catch(e){}return t}var Z=function(){function e(){this.name="amplitude",this.type="destination",this.retryTimeout=1e3,this.throttleTimeout=3e4,this.storageKey="",this.scheduleId=null,this.scheduledTimeout=0,this.flushId=null,this.queue=[]}return e.prototype.setup=function(e){var t;return(0,y.sH)(this,void 0,void 0,function(){var r,n=this;return(0,y.YH)(this,function(i){switch(i.label){case 0:return this.config=e,this.storageKey="".concat(q.fS,"_").concat(this.config.apiKey.substring(0,10)),[4,null===(t=this.config.storageProvider)||void 0===t?void 0:t.get(this.storageKey)];case 1:return(r=i.sent())&&r.length>0&&Promise.all(r.map(function(e){return n.execute(e)})).catch(),[2,Promise.resolve(void 0)]}})})},e.prototype.execute=function(e){var t=this;return e.insert_id||(e.insert_id=C()),new Promise(function(r){t.queue.push({event:e,attempts:0,callback:function(e){return r(e)},timeout:0}),t.schedule(t.config.flushIntervalMillis),t.saveEvents()})},e.prototype.removeEventsExceedFlushMaxRetries=function(e){var t=this;return e.filter(function(e){return e.attempts+=1,e.attempts<t.config.flushMaxRetries||(t.fulfillRequest([e],500,"Event rejected due to exceeded retry count"),!1)})},e.prototype.scheduleEvents=function(e){var t=this;e.forEach(function(e){t.schedule(0===e.timeout?t.config.flushIntervalMillis:e.timeout)})},e.prototype.schedule=function(e){var t=this;if(!this.config.offline&&(null===this.scheduleId||this.scheduleId&&e>this.scheduledTimeout)){this.scheduleId&&clearTimeout(this.scheduleId),this.scheduledTimeout=e,this.scheduleId=setTimeout(function(){t.queue=t.queue.map(function(e){return e.timeout=0,e}),t.flush(!0)},e);return}},e.prototype.resetSchedule=function(){this.scheduleId=null,this.scheduledTimeout=0},e.prototype.flush=function(e){return void 0===e&&(e=!1),(0,y.sH)(this,void 0,void 0,function(){var t,r,n=this;return(0,y.YH)(this,function(i){switch(i.label){case 0:if(this.config.offline)return this.resetSchedule(),this.config.loggerProvider.debug("Skipping flush while offline."),[2];if(this.flushId)return this.resetSchedule(),this.config.loggerProvider.debug("Skipping flush because previous flush has not resolved."),[2];return this.flushId=this.scheduleId,this.resetSchedule(),t=[],r=[],this.queue.forEach(function(e){return 0===e.timeout?t.push(e):r.push(e)}),[4,z(t,this.config.flushQueueSize).reduce(function(t,r){return(0,y.sH)(n,void 0,void 0,function(){return(0,y.YH)(this,function(n){switch(n.label){case 0:return[4,t];case 1:return n.sent(),[4,this.send(r,e)];case 2:return[2,n.sent()]}})})},Promise.resolve())];case 1:return i.sent(),this.flushId=null,this.scheduleEvents(this.queue),[2]}})})},e.prototype.send=function(e,t){return void 0===t&&(t=!0),(0,y.sH)(this,void 0,void 0,function(){var r,n,i,s;return(0,y.YH)(this,function(a){switch(a.label){case 0:if(!this.config.apiKey)return[2,this.fulfillRequest(e,400,"Event rejected due to missing API key")];r={api_key:this.config.apiKey,events:e.map(function(e){var t=e.event;return t.extra,(0,y.Tt)(t,["extra"])}),options:{min_id_length:this.config.minIdLength},client_upload_time:new Date().toISOString(),request_metadata:this.config.requestMetadata},this.config.requestMetadata=new X,a.label=1;case 1:return a.trys.push([1,3,,4]),n=G(this.config.serverUrl,this.config.serverZone,this.config.useBatch).serverUrl,[4,this.config.transportProvider.send(n,r)];case 2:if(null===(i=a.sent()))return this.fulfillRequest(e,0,"Unexpected error occurred"),[2];if(!t)return"body"in i?this.fulfillRequest(e,i.statusCode,"".concat(i.status,": ").concat(Q(i))):this.fulfillRequest(e,i.statusCode,i.status),[2];return this.handleResponse(i,e),[3,4];case 3:var u;return s=(u=a.sent())instanceof Error?u.message:String(u),this.config.loggerProvider.error(s),this.handleResponse({status:o.Failed,statusCode:0},e),[3,4];case 4:return[2]}})})},e.prototype.handleResponse=function(e,t){var r=e.status;switch(r){case o.Success:this.handleSuccessResponse(e,t);break;case o.Invalid:this.handleInvalidResponse(e,t);break;case o.PayloadTooLarge:this.handlePayloadTooLargeResponse(e,t);break;case o.RateLimit:this.handleRateLimitResponse(e,t);break;default:this.config.loggerProvider.warn("{code: 0, error: \"Status '".concat(r,"' provided for ").concat(t.length,' events"}')),this.handleOtherResponse(t)}},e.prototype.handleSuccessResponse=function(e,t){this.fulfillRequest(t,e.statusCode,"Event tracked successfully")},e.prototype.handleInvalidResponse=function(e,t){var r=this;if(e.body.missingField||e.body.error.startsWith("Invalid API key")){this.fulfillRequest(t,e.statusCode,e.body.error);return}var n=new Set((0,y.fX)((0,y.fX)((0,y.fX)((0,y.fX)([],(0,y.zs)(Object.values(e.body.eventsWithInvalidFields)),!1),(0,y.zs)(Object.values(e.body.eventsWithMissingFields)),!1),(0,y.zs)(Object.values(e.body.eventsWithInvalidIdLengths)),!1),(0,y.zs)(e.body.silencedEvents),!1).flat()),i=t.filter(function(t,i){if(n.has(i)){r.fulfillRequest([t],e.statusCode,e.body.error);return}return!0});i.length>0&&this.config.loggerProvider.warn(Q(e));var o=this.removeEventsExceedFlushMaxRetries(i);this.scheduleEvents(o)},e.prototype.handlePayloadTooLargeResponse=function(e,t){if(1===t.length){this.fulfillRequest(t,e.statusCode,e.body.error);return}this.config.loggerProvider.warn(Q(e)),this.config.flushQueueSize/=2;var r=this.removeEventsExceedFlushMaxRetries(t);this.scheduleEvents(r)},e.prototype.handleRateLimitResponse=function(e,t){var r=this,n=Object.keys(e.body.exceededDailyQuotaUsers),i=Object.keys(e.body.exceededDailyQuotaDevices),o=e.body.throttledEvents,s=new Set(n),a=new Set(i),u=new Set(o),l=t.filter(function(t,n){if(t.event.user_id&&s.has(t.event.user_id)||t.event.device_id&&a.has(t.event.device_id)){r.fulfillRequest([t],e.statusCode,e.body.error);return}return u.has(n)&&(t.timeout=r.throttleTimeout),!0});l.length>0&&this.config.loggerProvider.warn(Q(e));var c=this.removeEventsExceedFlushMaxRetries(l);this.scheduleEvents(c)},e.prototype.handleOtherResponse=function(e){var t=this,r=e.map(function(e){return e.timeout=e.attempts*t.retryTimeout,e}),n=this.removeEventsExceedFlushMaxRetries(r);this.scheduleEvents(n)},e.prototype.fulfillRequest=function(e,t,r){this.removeEvents(e),e.forEach(function(e){return e.callback(W(e.event,t,r))})},e.prototype.saveEvents=function(){if(this.config.storageProvider){var e=this.queue.map(function(e){return e.event});this.config.storageProvider.set(this.storageKey,e)}},e.prototype.removeEvents=function(e){this.queue=this.queue.filter(function(t){return!e.some(function(e){return e.event.insert_id===t.event.insert_id})}),this.saveEvents()},e}(),ee=function(){function e(){this.name="identity",this.type="before",this.identityStore=M().identityStore}return e.prototype.execute=function(e){return(0,y.sH)(this,void 0,void 0,function(){var t;return(0,y.YH)(this,function(r){return(t=e.user_properties)&&this.identityStore.editIdentity().updateUserProperties(t).commit(),[2,e]})})},e.prototype.setup=function(e){return(0,y.sH)(this,void 0,void 0,function(){return(0,y.YH)(this,function(t){return e.instanceName&&(this.identityStore=M(e.instanceName).identityStore),[2]})})},e}(),et=r(29924),er=r(85558),en=function(){function e(){this.productId="",this.quantity=1,this.price=0}return e.prototype.setProductId=function(e){return this.productId=e,this},e.prototype.setQuantity=function(e){return e>0&&(this.quantity=e),this},e.prototype.setPrice=function(e){return this.price=e,this},e.prototype.setRevenueType=function(e){return this.revenueType=e,this},e.prototype.setCurrency=function(e){return this.currency=e,this},e.prototype.setRevenue=function(e){return this.revenue=e,this},e.prototype.setReceipt=function(e){return this.receipt=e,this},e.prototype.setReceiptSig=function(e){return this.receiptSig=e,this},e.prototype.setEventProperties=function(e){return(0,er.a)(e)&&(this.properties=e),this},e.prototype.getEventProperties=function(){var e=this.properties?(0,y.Cl)({},this.properties):{};return e[s.REVENUE_PRODUCT_ID]=this.productId,e[s.REVENUE_QUANTITY]=this.quantity,e[s.REVENUE_PRICE]=this.price,e[s.REVENUE_TYPE]=this.revenueType,e[s.REVENUE_CURRENCY]=this.currency,e[s.REVENUE]=this.revenue,e[s.RECEIPT]=this.receipt,e[s.RECEIPT_SIG]=this.receiptSig,e},e}();!function(e){e.REVENUE_PRODUCT_ID="$productId",e.REVENUE_QUANTITY="$quantity",e.REVENUE_PRICE="$price",e.REVENUE_TYPE="$revenueType",e.REVENUE_CURRENCY="$currency",e.REVENUE="$revenue",e.RECEIPT="$receipt",e.RECEIPT_SIG="$receiptSig"}(s||(s={}));var ei=function(e,t){return void 0===t&&(t=Date.now()),Date.now()-t>e};!function(e){e.SET="$set",e.SET_ONCE="$setOnce",e.ADD="$add",e.APPEND="$append",e.PREPEND="$prepend",e.REMOVE="$remove",e.PREINSERT="$preInsert",e.POSTINSERT="$postInsert",e.UNSET="$unset",e.CLEAR_ALL="$clearAll"}(a||(a={})),function(e){e.IDENTIFY="$identify",e.GROUP_IDENTIFY="$groupidentify",e.REVENUE="revenue_amount"}(u||(u={}));var eo=function(){function e(e){this.client=e,this.queue=[],this.applying=!1,this.plugins=[]}return e.prototype.register=function(e,t){var r,n;return(0,y.sH)(this,void 0,void 0,function(){return(0,y.YH)(this,function(i){switch(i.label){case 0:if(this.plugins.some(function(t){return t.name===e.name}))return this.loggerProvider.warn("Plugin with name ".concat(e.name," already exists, skipping registration")),[2];return void 0===e.name&&(e.name=C(),this.loggerProvider.warn("Plugin name is undefined. \n      Generating a random UUID for plugin name: ".concat(e.name,". \n      Set a name for the plugin to prevent it from being added multiple times."))),e.type=null!==(r=e.type)&&void 0!==r?r:"enrichment",[4,null===(n=e.setup)||void 0===n?void 0:n.call(e,t,this.client)];case 1:return i.sent(),this.plugins.push(e),[2]}})})},e.prototype.deregister=function(e,t){var r;return(0,y.sH)(this,void 0,void 0,function(){var n,i;return(0,y.YH)(this,function(o){switch(o.label){case 0:if(-1===(n=this.plugins.findIndex(function(t){return t.name===e})))return t.loggerProvider.warn("Plugin with name ".concat(e," does not exist, skipping deregistration")),[2];return i=this.plugins[n],this.plugins.splice(n,1),[4,null===(r=i.teardown)||void 0===r?void 0:r.call(i)];case 1:return o.sent(),[2]}})})},e.prototype.reset=function(e){this.applying=!1,this.plugins.map(function(e){var t;return null===(t=e.teardown)||void 0===t?void 0:t.call(e)}),this.plugins=[],this.client=e},e.prototype.push=function(e){var t=this;return new Promise(function(r){t.queue.push([e,r]),t.scheduleApply(0)})},e.prototype.scheduleApply=function(e){var t=this;this.applying||(this.applying=!0,setTimeout(function(){t.apply(t.queue.shift()).then(function(){t.applying=!1,t.queue.length>0&&t.scheduleApply(0)})},e))},e.prototype.apply=function(e){return(0,y.sH)(this,void 0,void 0,function(){var t,r,n,i,o,s,a,u,l,c,h,d,f,p,v;return(0,y.YH)(this,function(g){switch(g.label){case 0:if(!e)return[2];t=(0,y.zs)(e,1)[0],r=(0,y.zs)(e,2)[1],this.loggerProvider.log("Timeline.apply: Initial event",t),n=this.plugins.filter(function(e){return"before"===e.type}),g.label=1;case 1:g.trys.push([1,6,7,8]),o=(i=(0,y.Ju)(n)).next(),g.label=2;case 2:if(o.done)return[3,5];if(!(s=o.value).execute)return[3,4];return[4,s.execute((0,y.Cl)({},t))];case 3:if(null===(a=g.sent()))return this.loggerProvider.log("Timeline.apply: Event filtered out by before plugin '".concat(String(s.name),"', event: ").concat(JSON.stringify(t))),r({event:t,code:0,message:""}),[2];t=a,this.loggerProvider.log("Timeline.apply: Event after before plugin '".concat(String(s.name),"', event: ").concat(JSON.stringify(t))),g.label=4;case 4:return o=i.next(),[3,2];case 5:return[3,8];case 6:return d={error:g.sent()},[3,8];case 7:try{o&&!o.done&&(f=i.return)&&f.call(i)}finally{if(d)throw d.error}return[7];case 8:u=this.plugins.filter(function(e){return"enrichment"===e.type||void 0===e.type}),g.label=9;case 9:g.trys.push([9,14,15,16]),c=(l=(0,y.Ju)(u)).next(),g.label=10;case 10:if(c.done)return[3,13];if(!(s=c.value).execute)return[3,12];return[4,s.execute((0,y.Cl)({},t))];case 11:if(null===(a=g.sent()))return this.loggerProvider.log("Timeline.apply: Event filtered out by enrichment plugin '".concat(String(s.name),"', event: ").concat(JSON.stringify(t))),r({event:t,code:0,message:""}),[2];t=a,this.loggerProvider.log("Timeline.apply: Event after enrichment plugin '".concat(String(s.name),"', event: ").concat(JSON.stringify(t))),g.label=12;case 12:return c=l.next(),[3,10];case 13:return[3,16];case 14:return p={error:g.sent()},[3,16];case 15:try{c&&!c.done&&(v=l.return)&&v.call(l)}finally{if(p)throw p.error}return[7];case 16:return h=this.plugins.filter(function(e){return"destination"===e.type}),this.loggerProvider.log("Timeline.apply: Final event before destinations, event: ".concat(JSON.stringify(t))),Promise.all(h.map(function(e){var r=(0,y.Cl)({},t);return e.execute(r).catch(function(e){return W(r,0,String(e))})})).then(function(e){var n=(0,y.zs)(e,1)[0]||W(t,100,"Event not tracked, no destination plugins on the instance");r(n)}),[2]}})})},e.prototype.flush=function(){return(0,y.sH)(this,void 0,void 0,function(){var e,t=this;return(0,y.YH)(this,function(r){switch(r.label){case 0:return e=this.queue,this.queue=[],[4,Promise.all(e.map(function(e){return t.apply(e)}))];case 1:return r.sent(),[4,Promise.all(this.plugins.filter(function(e){return"destination"===e.type}).map(function(e){return e.flush&&e.flush()}))];case 2:return r.sent(),[2]}})})},e.prototype.onIdentityChanged=function(e){this.plugins.forEach(function(t){var r;null===(r=t.onIdentityChanged)||void 0===r||r.call(t,e)})},e.prototype.onSessionIdChanged=function(e){this.plugins.forEach(function(t){var r;null===(r=t.onSessionIdChanged)||void 0===r||r.call(t,e)})},e.prototype.onOptOutChanged=function(e){this.plugins.forEach(function(t){var r;null===(r=t.onOptOutChanged)||void 0===r||r.call(t,e)})},e}(),es=function(e,t){return(0,y.Cl)((0,y.Cl)({},t),{event_type:u.IDENTIFY,user_properties:e.getUserProperties()})},ea=function(e,t,r,n){var i;return(0,y.Cl)((0,y.Cl)({},n),{event_type:u.GROUP_IDENTIFY,group_properties:r.getUserProperties(),groups:((i={})[e]=t,i)})},eu=function(e,t,r){var n,i=new et.T$;return i.set(e,t),(0,y.Cl)((0,y.Cl)({},r),{event_type:u.IDENTIFY,user_properties:i.getUserProperties(),groups:((n={})[e]=t,n)})},el=function(){function e(e){void 0===e&&(e="$default"),this.initializing=!1,this.isReady=!1,this.q=[],this.dispatchQ=[],this.logEvent=this.track.bind(this),this.timeline=new eo(this),this.name=e}return e.prototype._init=function(e){return(0,y.sH)(this,void 0,void 0,function(){return(0,y.YH)(this,function(t){switch(t.label){case 0:return this.config=e,this.timeline.reset(this),this.timeline.loggerProvider=this.config.loggerProvider,[4,this.runQueuedFunctions("q")];case 1:return t.sent(),this.isReady=!0,[2]}})})},e.prototype.runQueuedFunctions=function(e){return(0,y.sH)(this,void 0,void 0,function(){var t,r,n,i,o,s;return(0,y.YH)(this,function(a){switch(a.label){case 0:t=this[e],this[e]=[],a.label=1;case 1:a.trys.push([1,8,9,10]),n=(r=(0,y.Ju)(t)).next(),a.label=2;case 2:if(n.done)return[3,7];if(!((i=(0,n.value)())&&"promise"in i))return[3,4];return[4,i.promise];case 3:return a.sent(),[3,6];case 4:return[4,i];case 5:a.sent(),a.label=6;case 6:return n=r.next(),[3,2];case 7:return[3,10];case 8:return o={error:a.sent()},[3,10];case 9:try{n&&!n.done&&(s=r.return)&&s.call(r)}finally{if(o)throw o.error}return[7];case 10:if(!this[e].length)return[3,12];return[4,this.runQueuedFunctions(e)];case 11:a.sent(),a.label=12;case 12:return[2]}})})},e.prototype.track=function(e,t,r){var n=(0,y.Cl)((0,y.Cl)((0,y.Cl)({},"string"==typeof e?{event_type:e}:e),r),t&&{event_properties:t});return k(this.dispatch(n))},e.prototype.identify=function(e,t){var r=es(e,t);return k(this.dispatch(r))},e.prototype.groupIdentify=function(e,t,r,n){var i=ea(e,t,r,n);return k(this.dispatch(i))},e.prototype.setGroup=function(e,t,r){var n=eu(e,t,r);return k(this.dispatch(n))},e.prototype.revenue=function(e,t){var r=(0,y.Cl)((0,y.Cl)({},t),{event_type:u.REVENUE,event_properties:e.getEventProperties()});return k(this.dispatch(r))},e.prototype.add=function(e){return this.isReady?this._addPlugin(e):(this.q.push(this._addPlugin.bind(this,e)),k())},e.prototype._addPlugin=function(e){return k(this.timeline.register(e,this.config))},e.prototype.remove=function(e){return this.isReady?this._removePlugin(e):(this.q.push(this._removePlugin.bind(this,e)),k())},e.prototype._removePlugin=function(e){return k(this.timeline.deregister(e,this.config))},e.prototype.dispatchWithCallback=function(e,t){if(!this.isReady)return t(W(e,0,"Client not initialized"));this.process(e).then(t)},e.prototype.dispatch=function(e){return(0,y.sH)(this,void 0,void 0,function(){var t=this;return(0,y.YH)(this,function(r){return this.isReady?[2,this.process(e)]:[2,new Promise(function(r){t.dispatchQ.push(t.dispatchWithCallback.bind(t,e,r))})]})})},e.prototype.getOperationAppliedUserProperties=function(e){var t={};if(void 0===e)return t;var r={};return Object.keys(e).forEach(function(t){Object.values(a).includes(t)||(r[t]=e[t])}),et.Se.forEach(function(r){if(Object.keys(e).includes(r)){var n=e[r];switch(r){case a.CLEAR_ALL:Object.keys(t).forEach(function(e){delete t[e]});break;case a.UNSET:Object.keys(n).forEach(function(e){delete t[e]});break;case a.SET:Object.assign(t,n)}}}),Object.assign(t,r),t},e.prototype.process=function(e){return(0,y.sH)(this,void 0,void 0,function(){var t,r,n;return(0,y.YH)(this,function(i){switch(i.label){case 0:if(i.trys.push([0,2,,3]),this.config.optOut)return[2,W(e,0,"Event skipped due to optOut config")];return e.event_type===u.IDENTIFY&&(t=this.getOperationAppliedUserProperties(e.user_properties),this.timeline.onIdentityChanged({userProperties:t})),[4,this.timeline.push(e)];case 1:return 200===(r=i.sent()).code?this.config.loggerProvider.log(r.message):100===r.code?this.config.loggerProvider.warn(r.message):this.config.loggerProvider.error(r.message),[2,r];case 2:return n=String(i.sent()),this.config.loggerProvider.error(n),[2,r=W(e,0,n)];case 3:return[2]}})})},e.prototype.setOptOut=function(e){if(!this.isReady){this.q.push(this._setOptOut.bind(this,!!e));return}this._setOptOut(e)},e.prototype._setOptOut=function(e){this.config.optOut!==e&&(this.timeline.onOptOutChanged(e),this.config.optOut=!!e)},e.prototype.flush=function(){return k(this.timeline.flush())},e.prototype.plugin=function(e){var t=this.timeline.plugins.find(function(t){return t.name===e});if(void 0===t){this.config.loggerProvider.debug("Cannot find plugin with name ".concat(e));return}return t},e.prototype.plugins=function(e){return this.timeline.plugins.filter(function(t){return t instanceof e})},e}(),ec=function(e,t){return"boolean"==typeof e?e:(null==e?void 0:e[t])!==!1},eh=function(e){return ec(e,"attribution")},ed=function(e){return ec(e,"pageViews")},ef=function(e){return ec(e,"sessions")},ep=function(e){return"object"==typeof e&&(!0===e.networkTracking||"object"==typeof e.networkTracking)},ev=function(e){return"boolean"==typeof e?e:"object"==typeof e&&(!0===e.elementInteractions||"object"==typeof e.elementInteractions)},eg=function(e){return"object"==typeof e&&(!0===e.frustrationInteractions||"object"==typeof e.frustrationInteractions)},ey=function(e){if(ev(e.autocapture)&&"object"==typeof e.autocapture&&"object"==typeof e.autocapture.elementInteractions)return e.autocapture.elementInteractions},em=function(e){if(eg(e.autocapture)&&"object"==typeof e.autocapture&&"object"==typeof e.autocapture.frustrationInteractions)return e.autocapture.frustrationInteractions},eb=function(e){var t;if(ep(e.autocapture)){var r=void 0;return"object"==typeof e.autocapture&&"object"==typeof e.autocapture.networkTracking?r=e.autocapture.networkTracking:e.networkTrackingOptions&&(r=e.networkTrackingOptions),(0,y.Cl)((0,y.Cl)({},r),{captureRules:null===(t=null==r?void 0:r.captureRules)||void 0===t?void 0:t.map(function(t){var r;if(t.urls&&t.hosts){var n=JSON.stringify(t.hosts),i=JSON.stringify(t.urls);return null===(r=e.loggerProvider)||void 0===r||r.warn("Found network capture rule with both urls='".concat(i,"' and hosts='").concat(n,"' set. ")+"Definition of urls takes precedence over hosts, so ignoring hosts."),(0,y.Cl)((0,y.Cl)({},t),{hosts:void 0})}return t})})}},ew=function(e){var t,r=function(){return!1},n=void 0,i=e.pageCounter;return ed(e.defaultTracking)&&(r=void 0,t=void 0,e.defaultTracking&&"object"==typeof e.defaultTracking&&e.defaultTracking.pageViews&&"object"==typeof e.defaultTracking.pageViews&&("trackOn"in e.defaultTracking.pageViews&&(r=e.defaultTracking.pageViews.trackOn),"trackHistoryChanges"in e.defaultTracking.pageViews&&(n=e.defaultTracking.pageViews.trackHistoryChanges),"eventType"in e.defaultTracking.pageViews&&e.defaultTracking.pageViews.eventType&&(t=e.defaultTracking.pageViews.eventType))),{trackOn:r,trackHistoryChanges:n,eventType:t,pageCounter:i}},e_=function(e,t){for(var r=0;r<t.length;r++){var n=t[r],i=n.name,o=n.args,s=n.resolve,a=e&&e[i];if("function"==typeof a){var u=a.apply(e,o);"function"==typeof s&&s(null==u?void 0:u.promise)}}return e},ek=function(e){return e&&void 0!==e._q},eS=function(){if("undefined"==typeof navigator)return"";var e,t,r,n,i=navigator.userLanguage;return null!==(n=null!==(r=null!==(t=null===(e=navigator.languages)||void 0===e?void 0:e[0])&&void 0!==t?t:navigator.language)&&void 0!==r?r:i)&&void 0!==n?n:""},eE="2.23.1",eT=function(){function e(){this.name="@amplitude/plugin-context-browser",this.type="before",this.library="".concat("amplitude-ts","/").concat(eE),"undefined"!=typeof navigator&&(this.userAgent=navigator.userAgent)}return e.prototype.setup=function(e){return this.config=e,Promise.resolve(void 0)},e.prototype.execute=function(e){var t,r;return(0,y.sH)(this,void 0,void 0,function(){var n,i,o;return(0,y.YH)(this,function(s){return n=new Date().getTime(),i=null!==(t=this.config.lastEventId)&&void 0!==t?t:-1,o=null!==(r=e.event_id)&&void 0!==r?r:i+1,this.config.lastEventId=o,e.time||(this.config.lastEventTime=n),[2,(0,y.Cl)((0,y.Cl)((0,y.Cl)((0,y.Cl)((0,y.Cl)((0,y.Cl)((0,y.Cl)((0,y.Cl)({user_id:this.config.userId,device_id:this.config.deviceId,session_id:this.config.sessionId,time:n},this.config.appVersion&&{app_version:this.config.appVersion}),this.config.trackingOptions.platform&&{platform:"Web"}),this.config.trackingOptions.language&&{language:eS()}),this.config.trackingOptions.ipAddress&&{ip:"$remote"}),{insert_id:C(),partner_id:this.config.partnerId,plan:this.config.plan}),this.config.ingestionMetadata&&{ingestion_metadata:{source_name:this.config.ingestionMetadata.sourceName,source_version:this.config.ingestionMetadata.sourceVersion}}),e),{event_id:o,library:this.library,user_agent:this.userAgent})]})})},e}(),eC=function(){function e(){this.memoryStorage=new Map}return e.prototype.isEnabled=function(){return(0,y.sH)(this,void 0,void 0,function(){return(0,y.YH)(this,function(e){return[2,!0]})})},e.prototype.get=function(e){return(0,y.sH)(this,void 0,void 0,function(){return(0,y.YH)(this,function(t){return[2,this.memoryStorage.get(e)]})})},e.prototype.getRaw=function(e){return(0,y.sH)(this,void 0,void 0,function(){var t;return(0,y.YH)(this,function(r){switch(r.label){case 0:return[4,this.get(e)];case 1:return[2,(t=r.sent())?JSON.stringify(t):void 0]}})})},e.prototype.set=function(e,t){return(0,y.sH)(this,void 0,void 0,function(){return(0,y.YH)(this,function(r){return this.memoryStorage.set(e,t),[2]})})},e.prototype.remove=function(e){return(0,y.sH)(this,void 0,void 0,function(){return(0,y.YH)(this,function(t){return this.memoryStorage.delete(e),[2]})})},e.prototype.reset=function(){return(0,y.sH)(this,void 0,void 0,function(){return(0,y.YH)(this,function(e){return this.memoryStorage.clear(),[2]})})},e}(),eO=function(e,t,r){return void 0===t&&(t=""),void 0===r&&(r=10),[q.r,t,e.substring(0,r)].filter(Boolean).join("_")},eA=function(){function e(e){this.options=(0,y.Cl)({},e)}return e.prototype.isEnabled=function(){return(0,y.sH)(this,void 0,void 0,function(){var t,r;return(0,y.YH)(this,function(n){switch(n.label){case 0:if(!E())return[2,!1];e.testValue=String(Date.now()),t=new e(this.options),r="AMP_TEST",n.label=1;case 1:return n.trys.push([1,4,5,7]),[4,t.set(r,e.testValue)];case 2:return n.sent(),[4,t.get(r)];case 3:return[2,n.sent()===e.testValue];case 4:return n.sent(),[2,!1];case 5:return[4,t.remove(r)];case 6:return n.sent(),[7];case 7:return[2]}})})},e.prototype.get=function(e){var t;return(0,y.sH)(this,void 0,void 0,function(){var r,n;return(0,y.YH)(this,function(i){switch(i.label){case 0:return[4,this.getRaw(e)];case 1:if(!(r=i.sent()))return[2,void 0];try{if(n=null!==(t=eI(r))&&void 0!==t?t:eP(r),void 0===n)return console.error("Amplitude Logger [Error]: Failed to decode cookie value for key: ".concat(e,", value: ").concat(r)),[2,void 0];return[2,JSON.parse(n)]}catch(t){return console.error("Amplitude Logger [Error]: Failed to parse cookie value for key: ".concat(e,", value: ").concat(r)),[2,void 0]}return[2]}})})},e.prototype.getRaw=function(e){var t,r;return(0,y.sH)(this,void 0,void 0,function(){var n,i;return(0,y.YH)(this,function(o){return(i=(null!==(r=null===(t=null==(n=E())?void 0:n.document)||void 0===t?void 0:t.cookie.split("; "))&&void 0!==r?r:[]).find(function(t){return 0===t.indexOf(e+"=")}))?[2,i.substring(e.length+1)]:[2,void 0]})})},e.prototype.set=function(e,t){var r;return(0,y.sH)(this,void 0,void 0,function(){var n,i,o,s,a,u,l;return(0,y.YH)(this,function(c){try{n=null!==(r=this.options.expirationDays)&&void 0!==r?r:0,i=null!==t?n:-1,o=void 0,i&&((s=new Date).setTime(s.getTime()+864e5*i),o=s),a="".concat(e,"=").concat(btoa(encodeURIComponent(JSON.stringify(t)))),o&&(a+="; expires=".concat(o.toUTCString())),a+="; path=/",this.options.domain&&(a+="; domain=".concat(this.options.domain)),this.options.secure&&(a+="; Secure"),this.options.sameSite&&(a+="; SameSite=".concat(this.options.sameSite)),(u=E())&&(u.document.cookie=a)}catch(t){l=t instanceof Error?t.message:String(t),console.error("Amplitude Logger [Error]: Failed to set cookie for key: ".concat(e,". Error: ").concat(l))}return[2]})})},e.prototype.remove=function(e){return(0,y.sH)(this,void 0,void 0,function(){return(0,y.YH)(this,function(t){switch(t.label){case 0:return[4,this.set(e,null)];case 1:return t.sent(),[2]}})})},e.prototype.reset=function(){return(0,y.sH)(this,void 0,void 0,function(){return(0,y.YH)(this,function(e){return[2]})})},e}(),eI=function(e){try{return decodeURIComponent(atob(e))}catch(e){return}},eP=function(e){try{return decodeURIComponent(atob(decodeURIComponent(e)))}catch(e){return}},ex=function(){function e(){}return e.prototype.send=function(e,t){return Promise.resolve(null)},e.prototype.buildResponse=function(e){if("object"!=typeof e)return null;var t,r,n,i,s,a,u,l,c,h,d,f,p,v,g,y,m,b,w,_,k,S,E=e.code||0,T=this.buildStatus(E);switch(T){case o.Success:return{status:T,statusCode:E,body:{eventsIngested:null!==(t=e.events_ingested)&&void 0!==t?t:0,payloadSizeBytes:null!==(r=e.payload_size_bytes)&&void 0!==r?r:0,serverUploadTime:null!==(n=e.server_upload_time)&&void 0!==n?n:0}};case o.Invalid:return{status:T,statusCode:E,body:{error:null!==(i=e.error)&&void 0!==i?i:"",missingField:null!==(s=e.missing_field)&&void 0!==s?s:"",eventsWithInvalidFields:null!==(a=e.events_with_invalid_fields)&&void 0!==a?a:{},eventsWithMissingFields:null!==(u=e.events_with_missing_fields)&&void 0!==u?u:{},eventsWithInvalidIdLengths:null!==(l=e.events_with_invalid_id_lengths)&&void 0!==l?l:{},epsThreshold:null!==(c=e.eps_threshold)&&void 0!==c?c:0,exceededDailyQuotaDevices:null!==(h=e.exceeded_daily_quota_devices)&&void 0!==h?h:{},silencedDevices:null!==(d=e.silenced_devices)&&void 0!==d?d:[],silencedEvents:null!==(f=e.silenced_events)&&void 0!==f?f:[],throttledDevices:null!==(p=e.throttled_devices)&&void 0!==p?p:{},throttledEvents:null!==(v=e.throttled_events)&&void 0!==v?v:[]}};case o.PayloadTooLarge:return{status:T,statusCode:E,body:{error:null!==(g=e.error)&&void 0!==g?g:""}};case o.RateLimit:return{status:T,statusCode:E,body:{error:null!==(y=e.error)&&void 0!==y?y:"",epsThreshold:null!==(m=e.eps_threshold)&&void 0!==m?m:0,throttledDevices:null!==(b=e.throttled_devices)&&void 0!==b?b:{},throttledUsers:null!==(w=e.throttled_users)&&void 0!==w?w:{},exceededDailyQuotaDevices:null!==(_=e.exceeded_daily_quota_devices)&&void 0!==_?_:{},exceededDailyQuotaUsers:null!==(k=e.exceeded_daily_quota_users)&&void 0!==k?k:{},throttledEvents:null!==(S=e.throttled_events)&&void 0!==S?S:[]}};case o.Timeout:default:return{status:T,statusCode:E}}},e.prototype.buildStatus=function(e){return e>=200&&e<300?o.Success:429===e?o.RateLimit:413===e?o.PayloadTooLarge:408===e?o.Timeout:e>=400&&e<500?o.Invalid:e>=500?o.Failed:o.Unknown},e}(),eR=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,y.C6)(t,e),t.prototype.send=function(e,t){return(0,y.sH)(this,void 0,void 0,function(){var r,n;return(0,y.YH)(this,function(i){switch(i.label){case 0:if("undefined"==typeof fetch)throw Error("FetchTransport is not supported");return[4,fetch(e,{headers:{"Content-Type":"application/json",Accept:"*/*"},body:JSON.stringify(t),method:"POST"})];case 1:return[4,(r=i.sent()).text()];case 2:n=i.sent();try{return[2,this.buildResponse(JSON.parse(n))]}catch(e){return[2,this.buildResponse({code:r.status})]}return[2]}})})},t}(ex),ej=function(){function e(e){this.storage=e}return e.prototype.isEnabled=function(){return(0,y.sH)(this,void 0,void 0,function(){var t,r,n;return(0,y.YH)(this,function(i){switch(i.label){case 0:if(!this.storage)return[2,!1];t=String(Date.now()),r=new e(this.storage),n="AMP_TEST",i.label=1;case 1:return i.trys.push([1,4,5,7]),[4,r.set(n,t)];case 2:return i.sent(),[4,r.get(n)];case 3:return[2,i.sent()===t];case 4:return i.sent(),[2,!1];case 5:return[4,r.remove(n)];case 6:return i.sent(),[7];case 7:return[2]}})})},e.prototype.get=function(e){return(0,y.sH)(this,void 0,void 0,function(){var t;return(0,y.YH)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.getRaw(e)];case 1:if(!(t=r.sent()))return[2,void 0];return[2,JSON.parse(t)];case 2:return r.sent(),console.error("[Amplitude] Error: Could not get value from storage"),[2,void 0];case 3:return[2]}})})},e.prototype.getRaw=function(e){var t;return(0,y.sH)(this,void 0,void 0,function(){return(0,y.YH)(this,function(r){return[2,(null===(t=this.storage)||void 0===t?void 0:t.getItem(e))||void 0]})})},e.prototype.set=function(e,t){var r;return(0,y.sH)(this,void 0,void 0,function(){return(0,y.YH)(this,function(n){try{null===(r=this.storage)||void 0===r||r.setItem(e,JSON.stringify(t))}catch(e){}return[2]})})},e.prototype.remove=function(e){var t;return(0,y.sH)(this,void 0,void 0,function(){return(0,y.YH)(this,function(r){try{null===(t=this.storage)||void 0===t||t.removeItem(e)}catch(e){}return[2]})})},e.prototype.reset=function(){var e;return(0,y.sH)(this,void 0,void 0,function(){return(0,y.YH)(this,function(t){try{null===(e=this.storage)||void 0===e||e.clear()}catch(e){}return[2]})})},e}(),eU=function(e){function t(t){var r,n,i,o=this;try{i=null===(r=E())||void 0===r?void 0:r.localStorage}catch(e){null===(n=null==t?void 0:t.loggerProvider)||void 0===n||n.debug("Failed to access localStorage. error=".concat(JSON.stringify(e))),i=void 0}return(o=e.call(this,i)||this).loggerProvider=null==t?void 0:t.loggerProvider,o}return(0,y.C6)(t,e),t.prototype.set=function(t,r){var n;return(0,y.sH)(this,void 0,void 0,function(){var i;return(0,y.YH)(this,function(o){switch(o.label){case 0:if(!(Array.isArray(r)&&r.length>1e3))return[3,2];return i=r.length-1e3,[4,e.prototype.set.call(this,t,r.slice(0,1e3))];case 1:return o.sent(),null===(n=this.loggerProvider)||void 0===n||n.error("Failed to save ".concat(i," events because the queue length exceeded ").concat(1e3,".")),[3,4];case 2:return[4,e.prototype.set.call(this,t,r)];case 3:o.sent(),o.label=4;case 4:return[2]}})})},t}(ej),eL=function(e){function t(){var t;return e.call(this,null===(t=E())||void 0===t?void 0:t.sessionStorage)||this}return(0,y.C6)(t,e),t}(ej),eN=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={done:4},t}return(0,y.C6)(t,e),t.prototype.send=function(e,t){return(0,y.sH)(this,void 0,void 0,function(){var r=this;return(0,y.YH)(this,function(n){return[2,new Promise(function(n,i){"undefined"==typeof XMLHttpRequest&&i(Error("XHRTransport is not supported."));var o=new XMLHttpRequest;o.open("POST",e,!0),o.onreadystatechange=function(){if(o.readyState===r.state.done){var e=o.responseText;try{n(r.buildResponse(JSON.parse(e)))}catch(e){n(r.buildResponse({code:o.status}))}}},o.setRequestHeader("Content-Type","application/json"),o.setRequestHeader("Accept","*/*"),o.send(JSON.stringify(t))})]})})},t}(ex),e$=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,y.C6)(t,e),t.prototype.send=function(e,t){return(0,y.sH)(this,void 0,void 0,function(){var r=this;return(0,y.YH)(this,function(n){return[2,new Promise(function(n,i){var o=E();if(!(null==o?void 0:o.navigator.sendBeacon))throw Error("SendBeaconTransport is not supported");try{var s=JSON.stringify(t);if(o.navigator.sendBeacon(e,JSON.stringify(t)))return n(r.buildResponse({code:200,events_ingested:t.events.length,payload_size_bytes:s.length,server_upload_time:Date.now()}));return n(r.buildResponse({code:500}))}catch(e){i(e)}})]})})},t}(ex),eD=function(e){var t=parseInt(e,32);if(!isNaN(t))return t},eH=function(e){if(atob&&escape&&e)try{return decodeURIComponent(escape(atob(e)))}catch(e){return}},eq="[Amplitude]",eM="".concat(eq," Form Started"),eB="".concat(eq," Form Submitted"),eF="".concat(eq," File Downloaded"),ez="session_start",eW="session_end",eJ="".concat(eq," File Extension"),eY="".concat(eq," File Name"),eK="".concat(eq," Link ID"),eV="".concat(eq," Link Text"),eG="".concat(eq," Link URL"),eX="".concat(eq," Form ID"),eQ="".concat(eq," Form Name"),eZ="".concat(eq," Form Destination"),e0="cookie",e1=function(e){function t(t,r,n,o,s,a,u,l,c,h,d,f,p,v,g,y,m,b,w,_,k,S,E,T,C,O,A,I,P,x,R,j,U,L,N){void 0===n&&(n=new eC),void 0===o&&(o={domain:"",expiration:365,sameSite:"Lax",secure:!1,upgrade:!0}),void 0===l&&(l=1e3),void 0===c&&(c=5),void 0===h&&(h=30),void 0===d&&(d=e0),void 0===y&&(y=new Y),void 0===m&&(m=i.Warn),void 0===w&&(w=!1),void 0===_&&(_=!1),void 0===E&&(E=""),void 0===T&&(T="US"),void 0===O&&(O=18e5),void 0===A&&(A=new eU({loggerProvider:y})),void 0===I&&(I={ipAddress:!0,language:!0,platform:!0}),void 0===P&&(P="fetch"),void 0===x&&(x=!1),void 0===R&&(R=!0);var $=e.call(this,{apiKey:t,storageProvider:A,transportProvider:e3(P)})||this;return $.apiKey=t,$.appVersion=r,$.cookieOptions=o,$.defaultTracking=s,$.autocapture=a,$.flushIntervalMillis=l,$.flushMaxRetries=c,$.flushQueueSize=h,$.identityStorage=d,$.ingestionMetadata=f,$.instanceName=p,$.loggerProvider=y,$.logLevel=m,$.minIdLength=b,$.offline=w,$.partnerId=k,$.plan=S,$.serverUrl=E,$.serverZone=T,$.sessionTimeout=O,$.storageProvider=A,$.trackingOptions=I,$.transport=P,$.useBatch=x,$.fetchRemoteConfig=R,$.networkTrackingOptions=N,$.version=eE,$._optOut=!1,$._cookieStorage=n,$.deviceId=u,$.lastEventId=v,$.lastEventTime=g,$.optOut=_,$.sessionId=C,$.pageCounter=U,$.userId=j,$.debugLogsEnabled=L,$.loggerProvider.enable(L?i.Debug:$.logLevel),$.networkTrackingOptions=N,$}return(0,y.C6)(t,e),Object.defineProperty(t.prototype,"cookieStorage",{get:function(){return this._cookieStorage},set:function(e){this._cookieStorage!==e&&(this._cookieStorage=e,this.updateStorage())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"deviceId",{get:function(){return this._deviceId},set:function(e){this._deviceId!==e&&(this._deviceId=e,this.updateStorage())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userId",{get:function(){return this._userId},set:function(e){this._userId!==e&&(this._userId=e,this.updateStorage())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sessionId",{get:function(){return this._sessionId},set:function(e){this._sessionId!==e&&(this._sessionId=e,this.updateStorage())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"optOut",{get:function(){return this._optOut},set:function(e){this._optOut!==e&&(this._optOut=e,this.updateStorage())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lastEventTime",{get:function(){return this._lastEventTime},set:function(e){this._lastEventTime!==e&&(this._lastEventTime=e,this.updateStorage())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lastEventId",{get:function(){return this._lastEventId},set:function(e){this._lastEventId!==e&&(this._lastEventId=e,this.updateStorage())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pageCounter",{get:function(){return this._pageCounter},set:function(e){this._pageCounter!==e&&(this._pageCounter=e,this.updateStorage())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"debugLogsEnabled",{set:function(e){this._debugLogsEnabled!==e&&(this._debugLogsEnabled=e,this.updateStorage())},enumerable:!1,configurable:!0}),t.prototype.updateStorage=function(){var e={deviceId:this._deviceId,userId:this._userId,sessionId:this._sessionId,optOut:this._optOut,lastEventTime:this._lastEventTime,lastEventId:this._lastEventId,pageCounter:this._pageCounter,debugLogsEnabled:this._debugLogsEnabled};this.cookieStorage.set(eO(this.apiKey),e)},t}(V),e2=function(e,t){switch(void 0===e&&(e=e0),void 0===t&&(t={}),e){case"localStorage":return new eU;case"sessionStorage":return new eL;case"none":return new eC;default:return new eA((0,y.Cl)((0,y.Cl)({},t),{expirationDays:t.expiration}))}},e3=function(e){return"xhr"===e?new eN:"beacon"===e?new e$:new eR},e4=function(){var e="ampIntegrationContext";return"undefined"!=typeof globalThis&&void 0!==globalThis[e]?globalThis[e]:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof self?self:void 0!==r.g?r.g:void 0},e5=function(){var e,t=e4();return(null===(e=null==t?void 0:t.location)||void 0===e?void 0:e.search)?t.location.search.substring(1).split("&").filter(Boolean).reduce(function(e,t){var r=t.split("=",2),n=e6(r[0]),i=e6(r[1]);return i&&(e[n]=i),e},{}):{}},e6=function(e){void 0===e&&(e="");try{return decodeURIComponent(e)}catch(e){return""}},e8="dclid",e9="fbclid",e7="gbraid",te="gclid",tt="ko_click_id",tr="li_fat_id",tn="msclkid",ti="rdt_cid",to="ttclid",ts="twclid",ta="wbraid",tu={utm_campaign:void 0,utm_content:void 0,utm_id:void 0,utm_medium:void 0,utm_source:void 0,utm_term:void 0,referrer:void 0,referring_domain:void 0,dclid:void 0,gbraid:void 0,gclid:void 0,fbclid:void 0,ko_click_id:void 0,li_fat_id:void 0,msclkid:void 0,rdt_cid:void 0,ttclid:void 0,twclid:void 0,wbraid:void 0},tl=function(){function e(){}return e.prototype.parse=function(){return(0,y.sH)(this,void 0,void 0,function(){return(0,y.YH)(this,function(e){return[2,(0,y.Cl)((0,y.Cl)((0,y.Cl)((0,y.Cl)({},tu),this.getUtmParam()),this.getReferrer()),this.getClickIds())]})})},e.prototype.getUtmParam=function(){var e=e5();return{utm_campaign:e.utm_campaign,utm_content:e.utm_content,utm_id:e.utm_id,utm_medium:e.utm_medium,utm_source:e.utm_source,utm_term:e.utm_term}},e.prototype.getReferrer=function(){var e,t,r={referrer:void 0,referring_domain:void 0};try{r.referrer=document.referrer||void 0,r.referring_domain=null!==(t=null===(e=r.referrer)||void 0===e?void 0:e.split("/")[2])&&void 0!==t?t:void 0}catch(e){}return r},e.prototype.getClickIds=function(){var e,t=e5();return(e={})[e8]=t[e8],e[e9]=t[e9],e[e7]=t[e7],e[te]=t[te],e[tt]=t[tt],e[tr]=t[tr],e[tn]=t[tn],e[ti]=t[ti],e[to]=t[to],e[ts]=t[ts],e[ta]=t[ta],e},e}();!function(e){e.SET="$set",e.SET_ONCE="$setOnce",e.ADD="$add",e.APPEND="$append",e.PREPEND="$prepend",e.REMOVE="$remove",e.PREINSERT="$preInsert",e.POSTINSERT="$postInsert",e.UNSET="$unset",e.CLEAR_ALL="$clearAll"}(l||(l={})),function(e){e.REVENUE_PRODUCT_ID="$productId",e.REVENUE_QUANTITY="$quantity",e.REVENUE_PRICE="$price",e.REVENUE_TYPE="$revenueType",e.REVENUE_CURRENCY="$currency",e.REVENUE="$revenue"}(c||(c={})),function(e){e.IDENTIFY="$identify",e.GROUP_IDENTIFY="$groupidentify",e.REVENUE="revenue_amount"}(h||(h={}));var tc=function(e){var t={};for(var r in e){var n=e[r];n&&(t[r]=n)}return t},th=function(e){void 0===e&&(e={});var t,r,n=e4(),i=void 0,o=!1,s=e.trackOn,a=e.trackHistoryChanges,u=e.eventType,l=void 0===u?"[Amplitude] Page Viewed":u,c=function(e){var t=e;try{t=decodeURI(e)}catch(e){null==i||i.error("Malformed URI sequence: ",e)}return t},h=function(){return(0,y.sH)(void 0,void 0,void 0,function(){var e,t,r;return(0,y.YH)(this,function(n){switch(n.label){case 0:return e=c("undefined"!=typeof location&&location.href||""),r={event_type:l},t=[{}],[4,td()];case 1:return[2,(r.event_properties=y.Cl.apply(void 0,[y.Cl.apply(void 0,t.concat([n.sent()])),{"[Amplitude] Page Domain":"undefined"!=typeof location&&location.hostname||"","[Amplitude] Page Location":e,"[Amplitude] Page Path":"undefined"!=typeof location&&c(location.pathname)||"","[Amplitude] Page Title":"undefined"!=typeof document&&document.title||"","[Amplitude] Page URL":e.split("?")[0]}]),r)]}})})},d=function(){return void 0===s||"function"==typeof s&&s()},f="undefined"!=typeof location?location.href:null,p=function(){return(0,y.sH)(void 0,void 0,void 0,function(){var e,r,n,o;return(0,y.YH)(this,function(s){switch(s.label){case 0:if(r=tp(a,e=location.href,f||"")&&d(),f=e,!r)return[3,4];if(null==i||i.log("Tracking page view event"),null!=t)return[3,1];return[3,3];case 1:return o=(n=t).track,[4,h()];case 2:o.apply(n,[s.sent()]),s.label=3;case 3:s.label=4;case 4:return[2]}})})},v=function(){p()};return{name:"@amplitude/plugin-page-view-tracking-browser",type:"enrichment",setup:function(e,s){return(0,y.sH)(void 0,void 0,void 0,function(){var a,u;return(0,y.YH)(this,function(l){switch(l.label){case 0:if(t=s,r=e,(i=e.loggerProvider).log("Installing @amplitude/plugin-page-view-tracking-browser"),o=!0,n&&(n.addEventListener("popstate",v),n.history.pushState=new Proxy(n.history.pushState,{apply:function(e,t,r){var n=(0,y.zs)(r,3),i=n[0],s=n[1],a=n[2];e.apply(t,[i,s,a]),o&&p()}})),!d())return[3,2];return i.log("Tracking page view event"),u=(a=t).track,[4,h()];case 1:u.apply(a,[l.sent()]),l.label=2;case 2:return[2]}})})},execute:function(e){return(0,y.sH)(void 0,void 0,void 0,function(){var t;return(0,y.YH)(this,function(n){switch(n.label){case 0:if(!("attribution"===s&&tf(e)))return[3,2];return null==i||i.log("Enriching campaign event to page view event with campaign parameters"),[4,h()];case 1:t=n.sent(),e.event_type=t.event_type,e.event_properties=(0,y.Cl)((0,y.Cl)({},e.event_properties),t.event_properties),n.label=2;case 2:return r&&e.event_type===l&&(r.pageCounter=r.pageCounter?r.pageCounter+1:1,e.event_properties=(0,y.Cl)((0,y.Cl)({},e.event_properties),{"[Amplitude] Page Counter":r.pageCounter})),[2,e]}})})},teardown:function(){return(0,y.sH)(void 0,void 0,void 0,function(){return(0,y.YH)(this,function(e){return n&&(n.removeEventListener("popstate",v),o=!1),[2]})})}}},td=function(){return(0,y.sH)(void 0,void 0,void 0,function(){var e;return(0,y.YH)(this,function(t){switch(t.label){case 0:return e=tc,[4,new tl().parse()];case 1:return[2,e.apply(void 0,[t.sent()])]}})})},tf=function(e){if("$identify"===e.event_type&&e.user_properties){var t=e.user_properties,r=t[l.SET]||{},n=t[l.UNSET]||{},i=(0,y.fX)((0,y.fX)([],(0,y.zs)(Object.keys(r)),!1),(0,y.zs)(Object.keys(n)),!1);return Object.keys(tu).every(function(e){return i.includes(e)})}return!1},tp=function(e,t,r){if("pathOnly"===e){if(""==r)return!0;var n=new URL(t),i=new URL(r);return n.origin+n.pathname!==i.origin+i.pathname}return t!==r},tv=function(){var e,t=[],r=function(e,r,n){e.addEventListener(r,n),t.push({element:e,type:r,handler:n})},n=function(){t.forEach(function(e){var t=e.element,r=e.type,n=e.handler;null==t||t.removeEventListener(r,n)}),t=[]};return{name:"@amplitude/plugin-form-interaction-tracking-browser",type:"enrichment",setup:function(t,n){return(0,y.sH)(void 0,void 0,void 0,function(){var i,o;return(0,y.YH)(this,function(s){return i=function(){if(!n){t.loggerProvider.warn("Form interaction tracking requires a later version of @amplitude/analytics-browser. Form interaction events are not tracked.");return}if("undefined"!=typeof document){var i=function(e){var t=!1;r(e,"change",function(){var r,i=ty(e);t||n.track(eM,((r={})[eX]=tg(e.id),r[eQ]=tg(e.name),r[eZ]=i,r)),t=!0}),r(e,"submit",function(){var r,i,o=ty(e);t||n.track(eM,((r={})[eX]=tg(e.id),r[eQ]=tg(e.name),r[eZ]=o,r)),n.track(eB,((i={})[eX]=tg(e.id),i[eQ]=tg(e.name),i[eZ]=o,i)),t=!1})};Array.from(document.getElementsByTagName("form")).forEach(i),"undefined"!=typeof MutationObserver&&(e=new MutationObserver(function(e){e.forEach(function(e){e.addedNodes.forEach(function(e){"FORM"===e.nodeName&&i(e),"querySelectorAll"in e&&"function"==typeof e.querySelectorAll&&Array.from(e.querySelectorAll("form")).map(i)})})})).observe(document.body,{subtree:!0,childList:!0})}},"complete"===document.readyState?i():(o=E())?o.addEventListener("load",i):t.loggerProvider.debug("Form interaction tracking is not installed because global is undefined."),[2]})})},execute:function(e){return(0,y.sH)(void 0,void 0,void 0,function(){return(0,y.YH)(this,function(t){return[2,e]})})},teardown:function(){return(0,y.sH)(void 0,void 0,void 0,function(){return(0,y.YH)(this,function(t){return null==e||e.disconnect(),n(),[2]})})}}},tg=function(e){if("string"==typeof e)return e},ty=function(e){var t=e.getAttribute("action");try{t=new URL(encodeURI(null!=t?t:""),window.location.href).href}catch(e){}return t},tm=function(){var e,t=[],r=function(e,r,n){e.addEventListener(r,n),t.push({element:e,type:r,handler:n})},n=function(){t.forEach(function(e){var t=e.element,r=e.type,n=e.handler;null==t||t.removeEventListener(r,n)}),t=[]};return{name:"@amplitude/plugin-file-download-tracking-browser",type:"enrichment",setup:function(t,n){return(0,y.sH)(void 0,void 0,void 0,function(){var i,o;return(0,y.YH)(this,function(s){return i=function(){if(!n){t.loggerProvider.warn("File download tracking requires a later version of @amplitude/analytics-browser. File download events are not tracked.");return}if("undefined"!=typeof document){var i=function(e){try{t=new URL(e.href,window.location.href)}catch(e){return}var t,i=o.exec(t.href),s=null==i?void 0:i[1];s&&r(e,"click",function(){var r;s&&n.track(eF,((r={})[eJ]=s,r[eY]=t.pathname,r[eK]=e.id,r[eV]=e.text,r[eG]=e.href,r))})},o=/\.(pdf|xlsx?|docx?|txt|rtf|csv|exe|key|pp(s|t|tx)|7z|pkg|rar|gz|zip|avi|mov|mp4|mpe?g|wmv|midi?|mp3|wav|wma)(\?.+)?$/;Array.from(document.getElementsByTagName("a")).forEach(i),"undefined"!=typeof MutationObserver&&(e=new MutationObserver(function(e){e.forEach(function(e){e.addedNodes.forEach(function(e){"A"===e.nodeName&&i(e),"querySelectorAll"in e&&"function"==typeof e.querySelectorAll&&Array.from(e.querySelectorAll("a")).map(i)})})})).observe(document.body,{subtree:!0,childList:!0})}},"complete"===document.readyState?i():(o=E())?o.addEventListener("load",i):t.loggerProvider.debug("File download tracking is not installed because global is undefined."),[2]})})},execute:function(e){return(0,y.sH)(void 0,void 0,void 0,function(){return(0,y.YH)(this,function(t){return[2,e]})})},teardown:function(){return(0,y.sH)(void 0,void 0,void 0,function(){return(0,y.YH)(this,function(t){return null==e||e.disconnect(),n(),[2]})})}}},tb=!1,tw=function(e){!tb&&void 0===e.defaultTracking&&(e.loggerProvider.warn("`options.defaultTracking` is set to undefined. This implicitly configures your Amplitude instance to track Page Views, Sessions, File Downloads, and Form Interactions. You can suppress this warning by explicitly setting a value to `options.defaultTracking`. The value must either be a boolean, to enable and disable all default events, or an object, for advanced configuration. For example:\n\namplitude.init(<YOUR_API_KEY>, {\n  defaultTracking: true,\n});\n\nVisit https://www.docs.developers.amplitude.com/data/sdks/browser-2/#tracking-default-events for more details."),tb=!0)},t_=function(){var e=E(),t=[],r=function(r,n){(null==e?void 0:e.addEventListener)&&(null==e||e.addEventListener(r,n),t.push({type:r,handler:n}))},n=function(){t.forEach(function(t){var r=t.type,n=t.handler;null==e||e.removeEventListener(r,n)}),t=[]};return{name:"@amplitude/plugin-network-checker-browser",type:"before",setup:function(e,t){return(0,y.sH)(void 0,void 0,void 0,function(){return(0,y.YH)(this,function(n){return"undefined"==typeof navigator?(e.loggerProvider.debug("Network connectivity checker plugin is disabled because navigator is not available."),e.offline=!1):(e.offline=!navigator.onLine,r("online",function(){e.loggerProvider.debug("Network connectivity changed to online."),e.offline=!1,setTimeout(function(){t.flush()},e.flushIntervalMillis)}),r("offline",function(){e.loggerProvider.debug("Network connectivity changed to offline."),e.offline=!0})),[2]})})},teardown:function(){return(0,y.sH)(void 0,void 0,void 0,function(){return(0,y.YH)(this,function(e){return n(),[2]})})}}},tk=["a","button","input","select","textarea","label","video","audio",'[contenteditable="true" i]',"[data-amp-default-track]",".amp-default-track"],tS="data-amp-track-",tE=["div","span","h1","h2","h3","h4","h5","h6"];!function(e){e.Unknown="unknown",e.Skipped="skipped",e.Success="success",e.RateLimit="rate_limit",e.PayloadTooLarge="payload_too_large",e.Invalid="invalid",e.Failed="failed",e.Timeout="Timeout",e.SystemError="SystemError"}(d||(d={}));var tT=function(){function e(){}return e.prototype.send=function(e,t){return Promise.resolve(null)},e.prototype.buildResponse=function(e){if("object"!=typeof e)return null;var t,r,n,i,o,s,a,u,l,c,h,f,p,v,g,y,m,b,w,_,k,S,E=e.code||0,T=this.buildStatus(E);switch(T){case d.Success:return{status:T,statusCode:E,body:{eventsIngested:null!==(t=e.events_ingested)&&void 0!==t?t:0,payloadSizeBytes:null!==(r=e.payload_size_bytes)&&void 0!==r?r:0,serverUploadTime:null!==(n=e.server_upload_time)&&void 0!==n?n:0}};case d.Invalid:return{status:T,statusCode:E,body:{error:null!==(i=e.error)&&void 0!==i?i:"",missingField:null!==(o=e.missing_field)&&void 0!==o?o:"",eventsWithInvalidFields:null!==(s=e.events_with_invalid_fields)&&void 0!==s?s:{},eventsWithMissingFields:null!==(a=e.events_with_missing_fields)&&void 0!==a?a:{},eventsWithInvalidIdLengths:null!==(u=e.events_with_invalid_id_lengths)&&void 0!==u?u:{},epsThreshold:null!==(l=e.eps_threshold)&&void 0!==l?l:0,exceededDailyQuotaDevices:null!==(c=e.exceeded_daily_quota_devices)&&void 0!==c?c:{},silencedDevices:null!==(h=e.silenced_devices)&&void 0!==h?h:[],silencedEvents:null!==(f=e.silenced_events)&&void 0!==f?f:[],throttledDevices:null!==(p=e.throttled_devices)&&void 0!==p?p:{},throttledEvents:null!==(v=e.throttled_events)&&void 0!==v?v:[]}};case d.PayloadTooLarge:return{status:T,statusCode:E,body:{error:null!==(g=e.error)&&void 0!==g?g:""}};case d.RateLimit:return{status:T,statusCode:E,body:{error:null!==(y=e.error)&&void 0!==y?y:"",epsThreshold:null!==(m=e.eps_threshold)&&void 0!==m?m:0,throttledDevices:null!==(b=e.throttled_devices)&&void 0!==b?b:{},throttledUsers:null!==(w=e.throttled_users)&&void 0!==w?w:{},exceededDailyQuotaDevices:null!==(_=e.exceeded_daily_quota_devices)&&void 0!==_?_:{},exceededDailyQuotaUsers:null!==(k=e.exceeded_daily_quota_users)&&void 0!==k?k:{},throttledEvents:null!==(S=e.throttled_events)&&void 0!==S?S:[]}};case d.Timeout:default:return{status:T,statusCode:E}}},e.prototype.buildStatus=function(e){return e>=200&&e<300?d.Success:429===e?d.RateLimit:413===e?d.PayloadTooLarge:408===e?d.Timeout:e>=400&&e<500?d.Invalid:e>=500?d.Failed:d.Unknown},e}();!function(e){e.US="US",e.EU="EU",e.STAGING="STAGING"}(f||(f={}));var tC="Remote config fetch rejected due to timeout after 5 seconds",tO="Unexpected error occurred",tA=function(){function e(e){var t=e.localConfig,r=e.configKeys,n=this;this.retryTimeout=1e3,this.attempts=0,this.sessionTargetingMatch=!1,this.metrics={},this.getRemoteNamespaceConfig=function(e,t){return(0,y.sH)(n,void 0,void 0,function(){var r,n,i;return(0,y.YH)(this,function(o){switch(o.label){case 0:return r=Date.now(),[4,this.fetchWithTimeout(t)];case 1:if((n=o.sent())&&(i=n.configs&&n.configs[e]))return this.metrics.fetchTimeAPISuccess=Date.now()-r,[2,i];return this.metrics.fetchTimeAPIFail=Date.now()-r,[2,void 0]}})})},this.getRemoteConfig=function(e,t,r){return(0,y.sH)(n,void 0,void 0,function(){var n;return(0,y.YH)(this,function(i){switch(i.label){case 0:return[4,this.getRemoteNamespaceConfig(e,r)];case 1:return[2,null==(n=i.sent())?void 0:n[t]]}})})},this.fetchWithTimeout=function(e){return(0,y.sH)(n,void 0,void 0,function(){var t,r,n;return(0,y.YH)(this,function(i){switch(i.label){case 0:return t=new AbortController,r=setTimeout(function(){return t.abort()},5e3),[4,this.fetchRemoteConfig(t.signal,e)];case 1:return n=i.sent(),clearTimeout(r),[2,n]}})})},this.fetchRemoteConfig=function(e,t){return(0,y.sH)(n,void 0,void 0,function(){var r,n,i,o,s,a,u,l,c,h,f;return(0,y.YH)(this,function(p){switch(p.label){case 0:if(t===this.lastFetchedSessionId&&this.attempts>=this.localConfig.flushMaxRetries)return[2,this.completeRequest({err:"Remote config fetch rejected due to exceeded retry count"})];if(e.aborted)return[2,this.completeRequest({err:tC})];t!==this.lastFetchedSessionId&&(this.lastFetchedSessionId=t,this.attempts=0);p.label=1;case 1:p.trys.push([1,3,,4]),r=new URLSearchParams({api_key:this.localConfig.apiKey});try{for(i=(n=(0,y.Ju)(this.configKeys)).next();!i.done;i=n.next())o=i.value,r.append("config_keys",o)}catch(e){c={error:e}}finally{try{i&&!i.done&&(h=n.return)&&h.call(n)}finally{if(c)throw c.error}}return t&&r.set("session_id",String(t)),s={headers:{Accept:"*/*"},method:"GET"},a="".concat(this.getServerUrl(),"?").concat(r.toString()),this.attempts+=1,[4,fetch(a,(0,y.Cl)((0,y.Cl)({},s),{signal:e}))];case 2:if(null===(u=p.sent()))return[2,this.completeRequest({err:tO})];switch(new tT().buildStatus(u.status)){case d.Success:return this.attempts=0,[2,this.parseAndStoreConfig(u)];case d.Failed:return[2,this.retryFetch(e,t)];default:return[2,this.completeRequest({err:"Network error occurred, remote config fetch failed"})]}return[3,4];case 3:if(l=p.sent(),e.aborted)return[2,this.completeRequest({err:tC})];return[2,this.completeRequest({err:null!==(f=l.message)&&void 0!==f?f:tO})];case 4:return[2]}})})},this.retryFetch=function(e,t){return(0,y.sH)(n,void 0,void 0,function(){var r=this;return(0,y.YH)(this,function(n){switch(n.label){case 0:return[4,new Promise(function(e){return setTimeout(e,r.attempts*r.retryTimeout)})];case 1:return n.sent(),[2,this.fetchRemoteConfig(e,t)]}})})},this.parseAndStoreConfig=function(e){return(0,y.sH)(n,void 0,void 0,function(){var t;return(0,y.YH)(this,function(r){switch(r.label){case 0:return[4,e.json()];case 1:return t=r.sent(),this.completeRequest({success:"Remote config successfully fetched"}),[2,t]}})})},this.localConfig=t,this.configKeys=r}return e.prototype.getServerUrl=function(){return this.localConfig.configServerUrl?this.localConfig.configServerUrl:this.localConfig.serverZone===f.STAGING?"https://sr-client-cfg.stag2.amplitude.com/config":this.localConfig.serverZone===f.EU?"https://sr-client-cfg.eu.amplitude.com/config":"https://sr-client-cfg.amplitude.com/config"},e.prototype.completeRequest=function(e){var t=e.err,r=e.success;if(t)throw Error(t);r&&this.localConfig.loggerProvider.log(r)},e}(),tI=function(e){var t=e.localConfig,r=e.configKeys;return(0,y.sH)(void 0,void 0,void 0,function(){return(0,y.YH)(this,function(e){return[2,new tA({localConfig:t,configKeys:r})]})})},tP="[Amplitude] Element Clicked",tx="[Amplitude] Element Tag",tR="[Amplitude] Element Text",tj="[Amplitude] Page URL",tU="https://app.amplitude.com",tL={US:tU,EU:"https://app.eu.amplitude.com",STAGING:"https://apps.stag2.amplitude.com"};function tN(e){return"function"==typeof e}function t$(e){return function(t){if(tN(null==t?void 0:t.lift))return t.lift(function(t){try{return e(t,this)}catch(e){this.error(e)}});throw TypeError("Unable to lift unknown Observable type")}}function tD(e){var t=e(function(e){Error.call(e),e.stack=Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var tH=tD(function(e){return function(t){e(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map(function(e,t){return t+1+") "+e.toString()}).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t}});function tq(e,t){if(e){var r=e.indexOf(t);0<=r&&e.splice(r,1)}}var tM=function(){var e;function t(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return t.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var e,t,r,n,i,o=this._parentage;if(o){if(this._parentage=null,Array.isArray(o))try{for(var s=(0,y.Ju)(o),a=s.next();!a.done;a=s.next())a.value.remove(this)}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=s.return)&&t.call(s)}finally{if(e)throw e.error}}else o.remove(this)}var u=this.initialTeardown;if(tN(u))try{u()}catch(e){i=e instanceof tH?e.errors:[e]}var l=this._finalizers;if(l){this._finalizers=null;try{for(var c=(0,y.Ju)(l),h=c.next();!h.done;h=c.next()){var d=h.value;try{tz(d)}catch(e){i=null!=i?i:[],e instanceof tH?i=(0,y.fX)((0,y.fX)([],(0,y.zs)(i)),(0,y.zs)(e.errors)):i.push(e)}}}catch(e){r={error:e}}finally{try{h&&!h.done&&(n=c.return)&&n.call(c)}finally{if(r)throw r.error}}}if(i)throw new tH(i)}},t.prototype.add=function(e){var r;if(e&&e!==this){if(this.closed)tz(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(r=this._finalizers)&&void 0!==r?r:[]).push(e)}}},t.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},t.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},t.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&tq(t,e)},t.prototype.remove=function(e){var r=this._finalizers;r&&tq(r,e),e instanceof t&&e._removeParent(this)},t.EMPTY=((e=new t).closed=!0,e),t}(),tB=tM.EMPTY;function tF(e){return e instanceof tM||e&&"closed"in e&&tN(e.remove)&&tN(e.add)&&tN(e.unsubscribe)}function tz(e){tN(e)?e():e.unsubscribe()}var tW={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},tJ={setTimeout:function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var i=tJ.delegate;return(null==i?void 0:i.setTimeout)?i.setTimeout.apply(i,(0,y.fX)([e,t],(0,y.zs)(r))):setTimeout.apply(void 0,(0,y.fX)([e,t],(0,y.zs)(r)))},clearTimeout:function(e){var t=tJ.delegate;return((null==t?void 0:t.clearTimeout)||clearTimeout)(e)},delegate:void 0};function tY(e){tJ.setTimeout(function(){var t=tW.onUnhandledError;if(t)t(e);else throw e})}function tK(){}var tV=tG("C",void 0,void 0);function tG(e,t,r){return{kind:e,value:t,error:r}}var tX=null;function tQ(e){if(tW.useDeprecatedSynchronousErrorHandling){var t=!tX;if(t&&(tX={errorThrown:!1,error:null}),e(),t){var r=tX,n=r.errorThrown,i=r.error;if(tX=null,n)throw i}}else e()}var tZ=function(e){function t(t){var r=e.call(this)||this;return r.isStopped=!1,t?(r.destination=t,tF(t)&&t.add(r)):r.destination=t6,r}return(0,y.C6)(t,e),t.create=function(e,t,r){return new t3(e,t,r)},t.prototype.next=function(e){this.isStopped?t5(tG("N",e,void 0),this):this._next(e)},t.prototype.error=function(e){this.isStopped?t5(tG("E",void 0,e),this):(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped?t5(tV,this):(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(tM),t0=Function.prototype.bind;function t1(e,t){return t0.call(e,t)}var t2=function(){function e(e){this.partialObserver=e}return e.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(e){t4(e)}},e.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(e){t4(e)}else t4(e)},e.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(e){t4(e)}},e}(),t3=function(e){function t(t,r,n){var i,o,s=e.call(this)||this;return tN(t)||!t?i={next:null!=t?t:void 0,error:null!=r?r:void 0,complete:null!=n?n:void 0}:s&&tW.useDeprecatedNextContext?((o=Object.create(t)).unsubscribe=function(){return s.unsubscribe()},i={next:t.next&&t1(t.next,o),error:t.error&&t1(t.error,o),complete:t.complete&&t1(t.complete,o)}):i=t,s.destination=new t2(i),s}return(0,y.C6)(t,e),t}(tZ);function t4(e){if(tW.useDeprecatedSynchronousErrorHandling)tW.useDeprecatedSynchronousErrorHandling&&tX&&(tX.errorThrown=!0,tX.error=e);else tY(e)}function t5(e,t){var r=tW.onStoppedNotification;r&&tJ.setTimeout(function(){return r(e,t)})}var t6={closed:!0,next:tK,error:function(e){throw e},complete:tK};function t8(e,t,r,n,i){return new t9(e,t,r,n,i)}var t9=function(e){function t(t,r,n,i,o,s){var a=e.call(this,t)||this;return a.onFinalize=o,a.shouldUnsubscribe=s,a._next=r?function(e){try{r(e)}catch(e){t.error(e)}}:e.prototype._next,a._error=i?function(e){try{i(e)}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._error,a._complete=n?function(){try{n()}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._complete,a}return(0,y.C6)(t,e),t.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;e.prototype.unsubscribe.call(this),r||null===(t=this.onFinalize)||void 0===t||t.call(this)}},t}(tZ);function t7(e,t){return t$(function(r,n){var i=0;r.subscribe(t8(n,function(r){n.next(e.call(t,r,i++))}))})}var re=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e};function rt(e){return tN(null==e?void 0:e.then)}var rr="function"==typeof Symbol&&Symbol.observable||"@@observable";function rn(e){return e}var ri=function(){function e(e){e&&(this._subscribe=e)}return e.prototype.lift=function(t){var r=new e;return r.source=this,r.operator=t,r},e.prototype.subscribe=function(e,t,r){var n=this,i=!function(e){return e&&e instanceof tZ||e&&tN(e.next)&&tN(e.error)&&tN(e.complete)&&tF(e)}(e)?new t3(e,t,r):e;return tQ(function(){var e=n.operator,t=n.source;i.add(e?e.call(i,t):t?n._subscribe(i):n._trySubscribe(i))}),i},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},e.prototype.forEach=function(e,t){var r=this;return new(t=ro(t))(function(t,n){var i=new t3({next:function(t){try{e(t)}catch(e){n(e),i.unsubscribe()}},error:n,complete:t});r.subscribe(i)})},e.prototype._subscribe=function(e){var t;return null===(t=this.source)||void 0===t?void 0:t.subscribe(e)},e.prototype[rr]=function(){return this},e.prototype.pipe=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return(0===(e=t).length?rn:1===e.length?e[0]:function(t){return e.reduce(function(e,t){return t(e)},t)})(this)},e.prototype.toPromise=function(e){var t=this;return new(e=ro(e))(function(e,r){var n;t.subscribe(function(e){return n=e},function(e){return r(e)},function(){return e(n)})})},e.create=function(t){return new e(t)},e}();function ro(e){var t;return null!==(t=null!=e?e:tW.Promise)&&void 0!==t?t:Promise}function rs(e){return Symbol.asyncIterator&&tN(null==e?void 0:e[Symbol.asyncIterator])}function ra(e){return TypeError("You provided "+(null!==e&&"object"==typeof e?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}var ru="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator";function rl(e){return tN(null==e?void 0:e[ru])}function rc(e){return(0,y.AQ)(this,arguments,function(){var t,r,n;return(0,y.YH)(this,function(i){switch(i.label){case 0:t=e.getReader(),i.label=1;case 1:i.trys.push([1,,9,10]),i.label=2;case 2:return[4,(0,y.N3)(t.read())];case 3:if(n=(r=i.sent()).value,!r.done)return[3,5];return[4,(0,y.N3)(void 0)];case 4:return[2,i.sent()];case 5:return[4,(0,y.N3)(n)];case 6:return[4,i.sent()];case 7:return i.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}})})}function rh(e){return tN(null==e?void 0:e.getReader)}function rd(e){if(e instanceof ri)return e;if(null!=e){var t,r,n,i;if(tN(e[rr])){return t=e,new ri(function(e){var r=t[rr]();if(tN(r.subscribe))return r.subscribe(e);throw TypeError("Provided object does not correctly implement Symbol.observable")})}if(re(e)){return r=e,new ri(function(e){for(var t=0;t<r.length&&!e.closed;t++)e.next(r[t]);e.complete()})}if(rt(e)){return n=e,new ri(function(e){n.then(function(t){e.closed||(e.next(t),e.complete())},function(t){return e.error(t)}).then(null,tY)})}if(rs(e))return rf(e);if(rl(e)){return i=e,new ri(function(e){var t,r;try{for(var n=(0,y.Ju)(i),o=n.next();!o.done;o=n.next()){var s=o.value;if(e.next(s),e.closed)return}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}e.complete()})}if(rh(e))return rf(rc(e))}throw ra(e)}function rf(e){return new ri(function(t){(function(e,t){var r,n,i,o;return(0,y.sH)(this,void 0,void 0,function(){var s;return(0,y.YH)(this,function(a){switch(a.label){case 0:a.trys.push([0,5,6,11]),r=(0,y.xN)(e),a.label=1;case 1:return[4,r.next()];case 2:if((n=a.sent()).done)return[3,4];if(s=n.value,t.next(s),t.closed)return[2];a.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return i={error:a.sent()},[3,11];case 6:if(a.trys.push([6,,9,10]),!(n&&!n.done&&(o=r.return)))return[3,8];return[4,o.call(r)];case 7:a.sent(),a.label=8;case 8:return[3,10];case 9:if(i)throw i.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}})})})(e,t).catch(function(e){return t.error(e)})})}var rp=tD(function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),rv=function(e){function t(){var t=e.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return(0,y.C6)(t,e),t.prototype.lift=function(e){var t=new rg(this,this);return t.operator=e,t},t.prototype._throwIfClosed=function(){if(this.closed)throw new rp},t.prototype.next=function(e){var t=this;tQ(function(){var r,n;if(t._throwIfClosed(),!t.isStopped){t.currentObservers||(t.currentObservers=Array.from(t.observers));try{for(var i=(0,y.Ju)(t.currentObservers),o=i.next();!o.done;o=i.next())o.value.next(e)}catch(e){r={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}}})},t.prototype.error=function(e){var t=this;tQ(function(){if(t._throwIfClosed(),!t.isStopped){t.hasError=t.isStopped=!0,t.thrownError=e;for(var r=t.observers;r.length;)r.shift().error(e)}})},t.prototype.complete=function(){var e=this;tQ(function(){if(e._throwIfClosed(),!e.isStopped){e.isStopped=!0;for(var t=e.observers;t.length;)t.shift().complete()}})},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(t){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)},t.prototype._innerSubscribe=function(e){var t=this,r=this.hasError,n=this.isStopped,i=this.observers;return r||n?tB:(this.currentObservers=null,i.push(e),new tM(function(){t.currentObservers=null,tq(i,e)}))},t.prototype._checkFinalizedStatuses=function(e){var t=this.hasError,r=this.thrownError,n=this.isStopped;t?e.error(r):n&&e.complete()},t.prototype.asObservable=function(){var e=new ri;return e.source=this,e},t.create=function(e,t){return new rg(e,t)},t}(ri),rg=function(e){function t(t,r){var n=e.call(this)||this;return n.destination=t,n.source=r,n}return(0,y.C6)(t,e),t.prototype.next=function(e){var t,r;null===(r=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===r||r.call(t,e)},t.prototype.error=function(e){var t,r;null===(r=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===r||r.call(t,e)},t.prototype.complete=function(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)},t.prototype._subscribe=function(e){var t,r;return null!==(r=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==r?r:tB},t}(rv);function ry(e){void 0===e&&(e={});var t=e.connector,r=void 0===t?function(){return new rv}:t,n=e.resetOnError,i=void 0===n||n,o=e.resetOnComplete,s=void 0===o||o,a=e.resetOnRefCountZero,u=void 0===a||a;return function(e){var t,n,o,a=0,l=!1,c=!1,h=function(){null==n||n.unsubscribe(),n=void 0},d=function(){h(),t=o=void 0,l=c=!1},f=function(){var e=t;d(),null==e||e.unsubscribe()};return t$(function(e,p){a++,c||l||h();var v=o=null!=o?o:r();p.add(function(){0!=--a||c||l||(n=rm(f,u))}),v.subscribe(p),!t&&a>0&&(t=new t3({next:function(e){return v.next(e)},error:function(e){c=!0,h(),n=rm(d,i,e),v.error(e)},complete:function(){l=!0,h(),n=rm(d,s),v.complete()}}),rd(e).subscribe(t))})(e)}}function rm(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];if(!0===t){e();return}if(!1!==t){var i=new t3({next:function(){i.unsubscribe(),e()}});return rd(t.apply(void 0,(0,y.fX)([],(0,y.zs)(r)))).subscribe(i)}}function rb(e,t,r,n,i){void 0===n&&(n=0),void 0===i&&(i=!1);var o=t.schedule(function(){r(),i?e.add(this.schedule(null,n)):this.unsubscribe()},n);if(e.add(o),!i)return o}function rw(e,t,r){return(void 0===r&&(r=1/0),tN(t))?rw(function(r,n){return t7(function(e,i){return t(r,e,n,i)})(rd(e(r,n)))},r):("number"==typeof t&&(r=t),t$(function(t,n){var i,o,s,a,u,l,c,h,d;return i=r,s=[],a=0,u=0,l=!1,c=function(){!l||s.length||a||n.complete()},h=function(e){return a<i?d(e):s.push(e)},d=function(t){a++;var r=!1;rd(e(t,u++)).subscribe(t8(n,function(e){o?h(e):n.next(e)},function(){r=!0},void 0,function(){if(r)try{for(a--;s.length&&a<i;)!function(){var e=s.shift();d(e)}();c()}catch(e){n.error(e)}}))},t.subscribe(t8(n,h,function(){l=!0,c()})),function(){}}))}var r_=Array.isArray,rk=["addListener","removeListener"],rS=["addEventListener","removeEventListener"],rE=["on","off"];function rT(e,t,r,n){if(tN(r)&&(n=r,r=void 0),n){return rT(e,t,r).pipe((i=n,t7(function(e){return r_(e)?i.apply(void 0,(0,y.fX)([],(0,y.zs)(e))):i(e)})))}var i,o,s,a,u=(0,y.zs)(tN((o=e).addEventListener)&&tN(o.removeEventListener)?rS.map(function(n){return function(i){return e[n](t,i,r)}}):tN((s=e).addListener)&&tN(s.removeListener)?rk.map(rC(e,t)):tN((a=e).on)&&tN(a.off)?rE.map(rC(e,t)):[],2),l=u[0],c=u[1];if(!l&&re(e))return rw(function(e){return rT(e,t,r)})(rd(e));if(!l)throw TypeError("Invalid event target");return new ri(function(e){var t=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return e.next(1<t.length?t:t[0])};return l(t),function(){return c(t)}})}function rC(e,t){return function(r){return function(n){return e[r](t,n)}}}var rO=function(e,t){return!t||!t.length||t.some(function(t){return"string"==typeof t?e===t:e.match(t)})},rA=["id","class","style","value","onclick","onchange","oninput","onblur","onsubmit","onfocus","onkeydown","onkeyup","onkeypress","data-reactid","data-react-checksum","data-reactroot"],rI=["type"],rP=["svg","path","g"],rx=["password","hidden"],rR=function(e){var t=[];return e?function(e,t){for(var r=0,n=0;n<e.length;n++){var i=e[n];if(null===i)r+=4;else{var o=function e(t,r){void 0===r&&(r=!1);try{if(null==t){if(r)return"None";return null}if("string"==typeof t){if(r){if((t=t.replace(/\\/g,"\\\\").replace(/\n/g,"\\n").replace(/\t/g,"\\t").replace(/\r/g,"\\r")).includes('"'))return"'".concat(t,"'");if(t.includes("'"))return'"'.concat(t.replace(/'/g,"\\'"),'"');return"'".concat(t,"'")}return t}if("boolean"==typeof t)return t?"True":"False";else if(Array.isArray(t)){var n=t.map(function(t){return e(t,!0)});return"[".concat(n.join(", "),"]")}else if("object"==typeof t){var i=Object.entries(t).filter(function(e){var t=(0,y.zs)(e,1)[0];return null!=t}).map(function(t){var r=(0,y.zs)(t,2),n=r[0],i=r[1];return"".concat(String(e(n,!0)),": ").concat(String(e(i,!0)))}),o="{".concat(i.join(", "),"}");return o.includes("\\'")&&(o=o.replace(/'/g,"'").replace(/'/g,"\\'")),o}return t.toString()}catch(e){return null}}(i);r+=o?Array.from(o).length:4}if(r>1024)return e.slice(0,n)}return e}((function(e){var t=[];if(!e)return t;t.push(e);for(var r=e.parentElement;r&&"HTML"!==r.tagName;)t.push(r),r=r.parentElement;return t})(e).map(function(e){return function(e){if(null===e)return null;var t,r,n,i,o,s,a=String(e.tagName).toLowerCase(),u={tag:a},l=Array.from(null!==(i=null===(n=e.parentElement)||void 0===n?void 0:n.children)&&void 0!==i?i:[]);l.length&&(u.index=l.indexOf(e),u.indexOfType=l.filter(function(t){return t.tagName===e.tagName}).indexOf(e));var c=null===(s=null===(o=e.previousElementSibling)||void 0===o?void 0:o.tagName)||void 0===s?void 0:s.toLowerCase();c&&(u.prevSib=String(c));var h=e.getAttribute("id");h&&(u.id=String(h));var d=Array.from(e.classList);d.length&&(u.classes=d);var f={},p=Array.from(e.attributes).filter(function(e){return!rA.includes(e.name)}),v=!r$(e);if(!rx.includes(String(e.getAttribute("type")))&&!rP.includes(a))try{for(var g=(0,y.Ju)(p),m=g.next();!m.done;m=g.next()){var b=m.value;(!v||rI.includes(b.name))&&(f[b.name]=String(b.value).substring(0,128))}}catch(e){t={error:e}}finally{try{m&&!m.done&&(r=g.return)&&r.call(g)}finally{if(t)throw t.error}}return Object.keys(f).length&&(u.attrs=f),u}(e)}),1024):[]},rj=["input","select","textarea"],rU=function(e,t){var r,n=null===(r=null==window?void 0:window.getComputedStyle)||void 0===r?void 0:r.call(window,e);return(null==n?void 0:n.getPropertyValue("cursor"))==="pointer"&&"click"===t},rL=function(e,t,r){return void 0===r&&(r=!1),function(n,i){var o,s,a=e.pageUrlAllowlist,u=e.shouldTrackEventResolver,l=null===(s=null===(o=null==i?void 0:i.tagName)||void 0===o?void 0:o.toLowerCase)||void 0===s?void 0:s.call(o);if(!l)return!1;if(u)return u(n,i);if(!rO(window.location.href,a))return!1;var c=String(null==i?void 0:i.getAttribute("type"))||"";if("string"==typeof c)switch(c.toLowerCase()){case"hidden":case"password":return!1}var h=rU(i,n);if(r&&h)return!0;if(t&&!t.some(function(e){var t;return!!(null===(t=null==i?void 0:i.matches)||void 0===t?void 0:t.call(i,e))}))return!1;switch(l){case"input":case"select":case"textarea":return"change"===n||"click"===n;default:if(h)return!0;return"click"===n}}},rN=function(e){return!(null==e||"string"==typeof e&&(/^(?:(4[0-9]{12}(?:[0-9]{3})?)|(5[1-5][0-9]{14})|(6(?:011|5[0-9]{2})[0-9]{12})|(3[47][0-9]{13})|(3(?:0[0-5]|[68][0-9])[0-9]{11})|((?:2131|1800|35[0-9]{3})[0-9]{11}))$/.test((e||"").replace(/[- ]/g,""))||/(^\d{3}-?\d{2}-?\d{4}$)/.test(e)||/[^\s@]+@[^\s@.]+\.[^\s@]+/.test(e)))},r$=function(e){var t,r,n,i=null===(r=null===(t=null==e?void 0:e.tagName)||void 0===t?void 0:t.toLowerCase)||void 0===r?void 0:r.call(t),o=e instanceof HTMLElement&&(null===(n=e.getAttribute("contenteditable"))||void 0===n?void 0:n.toLowerCase())==="true";return!rj.includes(i)&&!o},rD=function(e){var t="";return r$(e)&&e.childNodes&&e.childNodes.length&&e.childNodes.forEach(function(e){var r="";e&&3===e.nodeType?e.textContent&&(r=e.textContent):r=rD(e),t+=r.split(/(\s+)/).filter(rN).join("").replace(/[\r\n]/g," ").replace(/[ ]+/g," ").substring(0,255)}),t},rH=function(e){return Object.keys(e).reduce(function(t,r){var n=e[r];return null!=n&&("object"!=typeof n||0!==Object.keys(n).length)&&("string"!=typeof n||0!==n.trim().length)&&(t[r]=n),t},{})},rq=function(e){var t,r=e.parentElement;if(!r)return"";try{t=r.querySelector(":scope>span,h1,h2,h3,h4,h5,h6")}catch(e){t=null}if(t){var n=t.textContent||"";return rN(n)?n:""}return rq(r)},rM=function(e,t){return e?t.some(function(t){var r;return null===(r=null==e?void 0:e.matches)||void 0===r?void 0:r.call(e,t)})?e:rM(null==e?void 0:e.parentElement,t):null},rB=function(e){if(!e)return{};var t,r,n,i=null===(n=null===(r=null==e?void 0:e.tagName)||void 0===r?void 0:r.toLowerCase)||void 0===n?void 0:n.call(r);return rH(((t={})[tx]=i,t[tR]=rD(e),t[tj]=window.location.href.split("?")[0],t))},rF=function(e){return null!==e.event.target&&!!e.closestTrackedAncestor},rz=function(e,t,r){var n,i,o,s=null===(o=null===(i=null==t?void 0:t.tagName)||void 0===i?void 0:i.toLowerCase)||void 0===o?void 0:o.call(i),a="function"==typeof t.getBoundingClientRect?t.getBoundingClientRect():{left:null,top:null},u=t.getAttribute("aria-label"),l=t.getAttributeNames().reduce(function(e,n){if(n.startsWith(r)){var i=n.replace(r,""),o=t.getAttribute(n);i&&(e[i]=o||"")}return e},{}),c=rq(t),h=((n={})["[Amplitude] Element ID"]=t.getAttribute("id")||"",n["[Amplitude] Element Class"]=t.getAttribute("class"),n["[Amplitude] Element Hierarchy"]=rR(t),n[tx]=s,n[tR]=rD(t),n["[Amplitude] Element Position Left"]=null==a.left?null:Math.round(a.left),n["[Amplitude] Element Position Top"]=null==a.top?null:Math.round(a.top),n["[Amplitude] Element Aria Label"]=u,n["[Amplitude] Element Attributes"]=l,n["[Amplitude] Element Parent Label"]=c,n[tj]=window.location.href.split("?")[0],n["[Amplitude] Page Title"]="undefined"!=typeof document&&document.title||"",n["[Amplitude] Viewport Height"]=window.innerHeight,n["[Amplitude] Viewport Width"]=window.innerWidth,n);return"a"===s&&"click"===e&&t instanceof HTMLAnchorElement&&(h["[Amplitude] Element Href"]=t.href),rH(h)},rW=function(e,t,r,n,i){void 0===i&&(i=!1);var o,s={event:e,timestamp:Date.now(),type:t};if(("click"===(o=s).type||"change"===o.type)&&null!==s.event.target){if(i&&rU(s.event.target,s.type))return s.closestTrackedAncestor=s.event.target,s.targetElementProperties=rz(s.type,s.closestTrackedAncestor,n),s;var a=rM(s.event.target,r);a&&(s.closestTrackedAncestor=a,s.targetElementProperties=rz(s.type,a,n))}return s},rJ=function(e,t){try{if("DOM_ELEMENT"===e.sourceType){var r=document.documentElement;if(e.scope&&t&&(r=t.closest(e.scope)),r&&e.selector)return r.querySelector(e.selector);return r}}catch(e){}},rY=function(e,t){if("DOM_ELEMENT"===e.sourceType){var r=rJ(e,t);if(r){if("TEXT"===e.elementExtractType)return r.textContent;if("ATTRIBUTE"===e.elementExtractType&&e.attribute)return r.getAttribute(e.attribute)}}},rK=function(e,t){e.forEach(function(e){if("string"!=typeof e&&"ATTACH_EVENT_PROPERTY"===e.actionType){var r=rY(e.dataSource,t.closestTrackedAncestor);t.targetElementProperties[e.destinationKey]=r}})},rV=function(){function e(e){var t=(void 0===e?{}:e).origin,r=this;this.endpoint=tU,this.requestCallbacks={},this.onSelect=function(e){r.notify({action:"element-selected",data:e})},this.onTrack=function(e,t){"selector-mode-changed"===e?r.notify({action:"track-selector-mode-changed",data:t}):"selector-moved"===e&&r.notify({action:"track-selector-moved",data:t})},this.endpoint=void 0===t?tU:t}return e.prototype.notify=function(e){var t,r,n,i;null===(r=null===(t=this.logger)||void 0===t?void 0:t.debug)||void 0===r||r.call(t,"Message sent: ",JSON.stringify(e)),null===(i=null===(n=window.opener)||void 0===n?void 0:n.postMessage)||void 0===i||i.call(n,e,this.endpoint)},e.prototype.sendRequest=function(e,t,r){var n=this;void 0===r&&(r={timeout:15e3});var i="".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9)),o={id:i,action:e,args:t};return new Promise(function(t,s){n.requestCallbacks[i]={resolve:t,reject:s},n.notify(o),(null==r?void 0:r.timeout)>0&&setTimeout(function(){s(Error("".concat(e," timed out (id: ").concat(i,")"))),delete n.requestCallbacks[i]},r.timeout)})},e.prototype.handleResponse=function(e){var t;if(!this.requestCallbacks[e.id]){null===(t=this.logger)||void 0===t||t.warn("No callback found for request id: ".concat(e.id));return}this.requestCallbacks[e.id].resolve(e.responseData),delete this.requestCallbacks[e.id]},e.prototype.setup=function(e){var t=this,r=void 0===e?{}:e,n=r.logger,i=r.endpoint,o=r.isElementSelectable,s=r.cssSelectorAllowlist,a=r.actionClickAllowlist;this.logger=n,i&&this.endpoint===tU&&(this.endpoint=i);var u=null;window.addEventListener("message",function(e){if(null===(n=null===(r=t.logger)||void 0===r?void 0:r.debug)||void 0===n||n.call(r,"Message received: ",JSON.stringify(e)),t.endpoint===e.origin){var r,n,i,l,c,h=null==e?void 0:e.data,d=null==h?void 0:h.action;if(d){if("id"in h)null===(l=null===(i=t.logger)||void 0===i?void 0:i.debug)||void 0===l||l.call(i,"Received Response to previous request: ",JSON.stringify(e)),t.handleResponse(h);else if("ping"===d)t.notify({action:"pong"});else if("initialize-visual-tagging-selector"===d){var f,p=null==h?void 0:h.data;(f="https://cdn.amplitude.com/libs/visual-tagging-selector-1.0.0-alpha.js.gz",new Promise(function(e,t){var r;try{var n=document.createElement("script");n.type="text/javascript",n.async=!0,n.src=f,n.addEventListener("load",function(){e({status:!0})},{once:!0}),n.addEventListener("error",function(){t({status:!1,message:"Failed to load the script ".concat(f)})}),null===(r=document.head)||void 0===r||r.appendChild(n)}catch(e){t(e)}})).then(function(){var e;u=null===(e=null==window?void 0:window.amplitudeVisualTaggingSelector)||void 0===e?void 0:e.call(window,{getEventTagProps:rB,isElementSelectable:function(e){return!o||o((null==p?void 0:p.actionType)||"click",e)},onTrack:t.onTrack,onSelect:t.onSelect,visualHighlightClass:"amp-visual-tagging-selector-highlight",messenger:t,cssSelectorAllowlist:s,actionClickAllowlist:a,extractDataFromDataSource:rY,diagnostics:{autocapture:{version:"1.10.1"}}}),t.notify({action:"selector-loaded"})}).catch(function(){var e;null===(e=t.logger)||void 0===e||e.warn("Failed to initialize visual tagging selector")})}else"close-visual-tagging-selector"===d&&(null===(c=null==u?void 0:u.close)||void 0===c||c.call(u))}}}),this.notify({action:"page-loaded"})},e}();function rG(e,t){return t$(function(r,n){var i=0;r.subscribe(t8(n,function(r){return e.call(t,r,i++)&&n.next(r)}))})}var rX=function(e){function t(t,r){return e.call(this)||this}return(0,y.C6)(t,e),t.prototype.schedule=function(e,t){return void 0===t&&(t=0),this},t}(tM),rQ={setInterval:function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var i=rQ.delegate;return(null==i?void 0:i.setInterval)?i.setInterval.apply(i,(0,y.fX)([e,t],(0,y.zs)(r))):setInterval.apply(void 0,(0,y.fX)([e,t],(0,y.zs)(r)))},clearInterval:function(e){var t=rQ.delegate;return((null==t?void 0:t.clearInterval)||clearInterval)(e)},delegate:void 0},rZ=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.scheduler=t,n.work=r,n.pending=!1,n}return(0,y.C6)(t,e),t.prototype.schedule=function(e,t){if(void 0===t&&(t=0),this.closed)return this;this.state=e;var r,n=this.id,i=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(i,n,t)),this.pending=!0,this.delay=t,this.id=null!==(r=this.id)&&void 0!==r?r:this.requestAsyncId(i,this.id,t),this},t.prototype.requestAsyncId=function(e,t,r){return void 0===r&&(r=0),rQ.setInterval(e.flush.bind(e,this),r)},t.prototype.recycleAsyncId=function(e,t,r){if(void 0===r&&(r=0),null!=r&&this.delay===r&&!1===this.pending)return t;null!=t&&rQ.clearInterval(t)},t.prototype.execute=function(e,t){if(this.closed)return Error("executing a cancelled action");this.pending=!1;var r=this._execute(e,t);if(r)return r;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(e,t){var r,n=!1;try{this.work(e)}catch(e){n=!0,r=e||Error("Scheduled action threw falsy error")}if(n)return this.unsubscribe(),r},t.prototype.unsubscribe=function(){if(!this.closed){var t=this.id,r=this.scheduler,n=r.actions;this.work=this.state=this.scheduler=null,this.pending=!1,tq(n,this),null!=t&&(this.id=this.recycleAsyncId(r,t,null)),this.delay=null,e.prototype.unsubscribe.call(this)}},t}(rX),r0={now:function(){return(r0.delegate||Date).now()},delegate:void 0},r1=function(){function e(t,r){void 0===r&&(r=e.now),this.schedulerActionCtor=t,this.now=r}return e.prototype.schedule=function(e,t,r){return void 0===t&&(t=0),new this.schedulerActionCtor(this,e).schedule(r,t)},e.now=r0.now,e}(),r2=new(function(e){function t(t,r){void 0===r&&(r=r1.now);var n=e.call(this,t,r)||this;return n.actions=[],n._active=!1,n}return(0,y.C6)(t,e),t.prototype.flush=function(e){var t,r=this.actions;if(this._active){r.push(e);return}this._active=!0;do if(t=e.execute(e.state,e.delay))break;while(e=r.shift());if(this._active=!1,t){for(;e=r.shift();)e.unsubscribe();throw t}},t}(r1))(rZ);function r3(e){return void 0===e&&(e=1/0),rw(rn,e)}var r4=new ri(function(e){return e.complete()});function r5(e){return e&&tN(e.schedule)}function r6(e){return e[e.length-1]}function r8(e){return r5(r6(e))?e.pop():void 0}function r9(e,t){return void 0===t&&(t=0),t$(function(r,n){r.subscribe(t8(n,function(r){return rb(n,e,function(){return n.next(r)},t)},function(){return rb(n,e,function(){return n.complete()},t)},function(r){return rb(n,e,function(){return n.error(r)},t)}))})}function r7(e,t){return void 0===t&&(t=0),t$(function(r,n){n.add(e.schedule(function(){return r.subscribe(n)},t))})}function ne(e,t){if(!e)throw Error("Iterable cannot be null");return new ri(function(r){rb(r,t,function(){var n=e[Symbol.asyncIterator]();rb(r,t,function(){n.next().then(function(e){e.done?r.complete():r.next(e.value)})},0,!0)})})}function nt(e,t){return t?function(e,t){if(null!=e){if(tN(e[rr]))return rd(e).pipe(r7(t),r9(t));if(re(e))return new ri(function(r){var n=0;return t.schedule(function(){n===e.length?r.complete():(r.next(e[n++]),r.closed||this.schedule())})});if(rt(e))return rd(e).pipe(r7(t),r9(t));if(rs(e))return ne(e,t);if(rl(e))return new ri(function(r){var n;return rb(r,t,function(){n=e[ru](),rb(r,t,function(){var e,t,i;try{t=(e=n.next()).value,i=e.done}catch(e){r.error(e);return}i?r.complete():r.next(t)},0,!0)}),function(){return tN(null==n?void 0:n.return)&&n.return()}});if(rh(e))return ne(rc(e),t)}throw ra(e)}(e,t):rd(e)}function nr(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=r8(t),i=(e=1/0,"number"==typeof r6(t)?t.pop():e);return t.length?1===t.length?rd(t[0]):r3(i)(nt(t,n)):r4}function nn(e){return e<=0?function(){return r4}:t$(function(t,r){var n=0;t.subscribe(t8(r,function(t){++n<=e&&(r.next(t),e<=n&&r.complete())}))})}function ni(e){return e instanceof Date&&!isNaN(e)}function no(e,t,r){void 0===e&&(e=0),void 0===r&&(r=r2);var n=-1;return null!=t&&(r5(t)?r=t:n=t),new ri(function(t){var i=ni(e)?+e-r.now():e;i<0&&(i=0);var o=0;return r.schedule(function(){t.closed||(t.next(o++),0<=n?this.schedule(void 0,n):t.complete())},i)})}var ns=tD(function(e){return function(t){void 0===t&&(t=null),e(this),this.message="Timeout has occurred",this.name="TimeoutError",this.info=t}});function na(e){throw new ns(e)}var nu=function(){return new ri(function(e){var t=new MutationObserver(function(t){e.next(t)});return t.observe(document.body,{childList:!0,attributes:!0,characterData:!0,subtree:!0}),function(){return t.disconnect()}})},nl=function(e){return void 0===e&&(e="click"),rT(document,e,{capture:!0})},nc=function(e,t){try{if("[Amplitude] Element Text"===t.subprop_key)return"is"===t.subprop_op&&t.subprop_value.includes(e.targetElementProperties["[Amplitude] Element Text"]);if("[Amplitude] Element Hierarchy"===t.subprop_key)return"autotrack css match"===t.subprop_op&&!!e.closestTrackedAncestor.closest(t.subprop_value.toString())}catch(e){console.error("Error matching event to filter",e)}return!1},nh={"[Amplitude] Element Clicked":"click","[Amplitude] Element Changed":"change"},nd=function(e){var t,r,n,i,o=Object.values(nh).reduce(function(e,t){return e[t]=new Set,e},{});if(!e)return o;try{for(var s=(0,y.Ju)(e),a=s.next();!a.done;a=s.next()){var u=a.value;try{try{for(var l=(n=void 0,(0,y.Ju)(u.definition)),c=l.next();!c.done;c=l.next()){var h=nh[c.value.event_type];h&&o[h].add(u.id)}}catch(e){n={error:e}}finally{try{c&&!c.done&&(i=l.return)&&i.call(l)}finally{if(n)throw n.error}}}catch(e){console.warn("Skipping Labeled Event due to malformed definition",null==u?void 0:u.id,e)}}}catch(e){t={error:e}}finally{try{a&&!a.done&&(r=s.return)&&r.call(s)}finally{if(t)throw t.error}}return o},nf=function(e){var t,r,n,i,o=new Map;try{for(var s=(0,y.Ju)(e),a=s.next();!a.done;a=s.next()){var u=a.value;try{for(var l=(n=void 0,(0,y.Ju)(u.conditions)),c=l.next();!c.done;c=l.next()){var h=c.value;if("LABELED_EVENT"===h.type){var d=h.match.eventId,f=o.get(d);f||(f=[],o.set(d,f)),f.push(u)}}}catch(e){n={error:e}}finally{try{c&&!c.done&&(i=l.return)&&i.call(l)}finally{if(n)throw n.error}}}}catch(e){t={error:e}}finally{try{a&&!a.done&&(r=s.return)&&r.call(s)}finally{if(t)throw t.error}}return o},np=function(e,t){var r,n,i,o,s=new Set;try{for(var a=(0,y.Ju)(e),u=a.next();!u.done;u=a.next()){var l=u.value,c=t.get(l.id);if(c)try{for(var h=(i=void 0,(0,y.Ju)(c)),d=h.next();!d.done;d=h.next()){var f=d.value;s.add(f)}}catch(e){i={error:e}}finally{try{d&&!d.done&&(o=h.return)&&o.call(h)}finally{if(i)throw i.error}}}}catch(e){r={error:e}}finally{try{u&&!u.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}return Array.from(s)},nv=function(){function e(e,t,r){this.groupedLabeledEvents=e,this.labeledEventToTriggerMap=t,this.options=r}return e.prototype.evaluate=function(e){var t,r,n=this.options.pageActions;if(!n)return e;var i=np(Array.from(this.groupedLabeledEvents[e.type]).map(function(e){return n.labeledEvents[e]}).filter(function(t){return t.definition.some(function(t){return nh[t.event_type]===e.type&&t.filters.every(function(t){return nc(e,t)})})}),this.labeledEventToTriggerMap);try{for(var o=(0,y.Ju)(i),s=o.next();!s.done;s=o.next()){var a=s.value;rK(a.actions,e)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}return e},e.prototype.update=function(e,t,r){this.groupedLabeledEvents=e,this.labeledEventToTriggerMap=t,this.options=r},e}();!function(e){e.ClickObservable="clickObservable",e.ChangeObservable="changeObservable",e.NavigateObservable="navigateObservable",e.MutationObservable="mutationObservable"}(p||(p={}));var ng=function(e){void 0===e&&(e={});var t,r,n,i,o,s,a,u=e.dataAttributePrefix,l=void 0===u?tS:u,c=e.visualTaggingOptions,h=void 0===c?{enabled:!0,messenger:new rV}:c;e.cssSelectorAllowlist=null!==(t=e.cssSelectorAllowlist)&&void 0!==t?t:tk,e.actionClickAllowlist=null!==(r=e.actionClickAllowlist)&&void 0!==r?r:tE,e.debounceTime=null!==(n=e.debounceTime)&&void 0!==n?n:0;var d="@amplitude/plugin-autocapture-browser",f=[],v=function(){var t,r,n=nl().pipe(t7(function(t){return rW(t,"click",e.cssSelectorAllowlist,l)}),ry()),i=rT(document,"change",{capture:!0}).pipe(t7(function(t){return rW(t,"change",e.cssSelectorAllowlist,l)}),ry());window.navigation&&(r=rT(window.navigation,"navigate").pipe(t7(function(t){return rW(t,"navigate",e.cssSelectorAllowlist,l)}),ry()));var o=nu().pipe(t7(function(t){return rW(t,"mutation",e.cssSelectorAllowlist,l)}),ry());return(t={})[p.ClickObservable]=n,t[p.ChangeObservable]=i,t[p.NavigateObservable]=r,t[p.MutationObservable]=o,t},g=nd(Object.values(null!==(o=null===(i=e.pageActions)||void 0===i?void 0:i.labeledEvents)&&void 0!==o?o:{})),m=nf(null!==(a=null===(s=e.pageActions)||void 0===s?void 0:s.triggers)&&void 0!==a?a:[]),b=new nv(g,m,e),w=function(t){var r,n;t&&(e.pageActions=(0,y.Cl)((0,y.Cl)({},e.pageActions),t),g=nd(Object.values(null!==(r=e.pageActions.labeledEvents)&&void 0!==r?r:{})),m=nf(null!==(n=e.pageActions.triggers)&&void 0!==n?n:[]),b.update(g,m,e))};return{name:d,type:"enrichment",setup:function(t,r){return(0,y.sH)(void 0,void 0,void 0,function(){var n,i,o,s,a,u,c,p,g,m;return(0,y.YH)(this,function(_){var k,S,E,T,C,O,A,I,P,x,R,j,U,L,N,$,D,H,q,M,B,F,z,W,J,Y,K,V,G,X,Q,Z;return"undefined"==typeof document?[2]:(t.fetchRemoteConfig&&tI({localConfig:t,configKeys:["analyticsSDK.pageActions"]}).then(function(e){return(0,y.sH)(void 0,void 0,void 0,function(){var r,n;return(0,y.YH)(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,e.getRemoteConfig("analyticsSDK","pageActions")];case 1:return w(i.sent()),[3,3];case 2:return r=i.sent(),null===(n=null==t?void 0:t.loggerProvider)||void 0===n||n.error("Failed to fetch remote config: ".concat(String(r))),[3,3];case 3:return[2]}})})}).catch(function(e){var r;null===(r=null==t?void 0:t.loggerProvider)||void 0===r||r.error("Failed to create remote config fetch: ".concat(String(e)))}),n=rL(e,e.cssSelectorAllowlist),i=rL(e,e.actionClickAllowlist),S=(k={allObservables:o=v(),options:e,amplitude:r,shouldTrackEvent:n,evaluateTriggers:b.evaluate.bind(b)}).amplitude,E=k.allObservables,T=k.options,C=k.shouldTrackEvent,O=k.evaluateTriggers,x=nr((A=E.clickObservable).pipe(t$(function(e,t){var r,n=!1;e.subscribe(t8(t,function(e){var i=r;r=e,n&&t.next([i,e]),n=!0}))}),rG(function(e){var t=(0,y.zs)(e,2),r=t[0],n=t[1],i=r.event.target!==n.event.target,o=20>=Math.abs(n.event.screenX-r.event.screenX)&&20>=Math.abs(n.event.screenY-r.event.screenY);return i&&!o})),A.pipe((I=T.debounceTime,void 0===P&&(P=r2),t$(function(e,t){var r=null,n=null,i=null,o=function(){if(r){r.unsubscribe(),r=null;var e=n;n=null,t.next(e)}};function s(){var e=i+I,n=P.now();if(n<e){r=this.schedule(void 0,e-n),t.add(r);return}o()}e.subscribe(t8(t,function(e){n=e,i=P.now(),r||(r=P.schedule(s,I),t.add(r))},function(){o(),t.complete()},void 0,function(){n=r=null}))})),t7(function(){return"timeout"}))),s=A.pipe((void 0===R&&(R=r2),j=no(0,R),function e(t,r){return r?function(n){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r3(1)(nt(e,r8(e)))}(r.pipe(nn(1),t$(function(e,t){e.subscribe(t8(t,tK))})),n.pipe(e(t)))}:rw(function(e,r){return rd(t(e,r)).pipe(nn(1),t7(function(){return e}))})}(function(){return j})),rG(rF),rG(function(e){return C("click",e.closestTrackedAncestor)}),t7(function(e){return O(e)}),t$(function(e,t){var r=[];return e.subscribe(t8(t,function(e){return r.push(e)},function(){t.next(r),t.complete()})),rd(x).subscribe(t8(t,function(){var e=r;r=[],t.next(e)},tK)),function(){r=null}})).subscribe(function(e){var t,r,n=(e.length,tP);try{for(var i=(0,y.Ju)(e),o=i.next();!o.done;o=i.next()){var s=o.value;null==S||S.track(n,s.targetElementProperties)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}}),f.push(s),L=(U={allObservables:o,getEventProperties:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return rz.apply(void 0,(0,y.fX)((0,y.fX)([],(0,y.zs)(e),!1),[l],!1))},amplitude:r,shouldTrackEvent:n,evaluateTriggers:b.evaluate.bind(b)}).amplitude,N=U.allObservables,$=U.getEventProperties,D=U.shouldTrackEvent,H=U.evaluateTriggers,a=N.changeObservable.pipe(rG(rF),rG(function(e){return D("change",e.closestTrackedAncestor)}),t7(function(e){return H(e)})).subscribe(function(e){null==L||L.track("[Amplitude] Element Changed",$("change",e.closestTrackedAncestor))}),f.push(a),M=(q={allObservables:o,options:e,getEventProperties:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return rz.apply(void 0,(0,y.fX)((0,y.fX)([],(0,y.zs)(e),!1),[l],!1))},amplitude:r,shouldTrackEvent:n,shouldTrackActionClick:i}).amplitude,B=q.allObservables,F=q.options,z=q.getEventProperties,W=q.shouldTrackEvent,J=q.shouldTrackActionClick,Y=B.clickObservable,K=B.mutationObservable,V=B.navigateObservable,G=Y.pipe(rG(function(e){return!W("click",e.closestTrackedAncestor)}),t7(function(e){var t=rM(e.event.target,F.actionClickAllowlist);return e.closestTrackedAncestor=t,null!==e.closestTrackedAncestor&&(e.targetElementProperties=z(e.type,e.closestTrackedAncestor)),e}),rG(rF),rG(function(e){return J("click",e.closestTrackedAncestor)})),X=[K],V&&X.push(V),Q=nr.apply(void 0,(0,y.fX)([],(0,y.zs)(X),!1)),u=G.pipe((Z=function(e){return Q.pipe(nn(1),function(e,t){var r=ni(e)?{first:e}:"number"==typeof e?{each:e}:e,n=r.first,i=r.each,o=r.with,s=void 0===o?na:o,a=r.scheduler,u=void 0===a?r2:a,l=r.meta,c=void 0===l?null:l;if(null==n&&null==i)throw TypeError("No timeout provided.");return t$(function(e,t){var r,o,a=null,l=0,h=function(e){o=rb(t,u,function(){try{r.unsubscribe(),rd(s({meta:c,lastValue:a,seen:l})).subscribe(t)}catch(e){t.error(e)}},e)};r=e.subscribe(t8(t,function(e){null==o||o.unsubscribe(),l++,t.next(a=e),i>0&&h(i)},void 0,void 0,function(){(null==o?void 0:o.closed)||null==o||o.unsubscribe(),a=null})),l||h(null!=n?"number"==typeof n?n:+n-u.now():i)})}({first:500,with:function(){return r4}}),t7(function(){return e}))},t$(function(e,t){var r=null,n=0,i=!1,o=function(){return i&&!r&&t.complete()};e.subscribe(t8(t,function(e){null==r||r.unsubscribe(),rd(Z(e,n++)).subscribe(r=t8(t,function(e){return t.next(e)},function(){r=null,o()}))},function(){i=!0,o()}))}))).subscribe(function(e){null==M||M.track(tP,z("click",e.closestTrackedAncestor))}),f.push(u),null===(g=null==t?void 0:t.loggerProvider)||void 0===g||g.log("".concat(d," has been successfully added.")),window.opener&&h.enabled&&(c=e.cssSelectorAllowlist,p=e.actionClickAllowlist,null===(m=h.messenger)||void 0===m||m.setup((0,y.Cl)((0,y.Cl)({logger:null==t?void 0:t.loggerProvider},(null==t?void 0:t.serverZone)&&{endpoint:tL[t.serverZone]}),{isElementSelectable:rL(e,(0,y.fX)((0,y.fX)([],(0,y.zs)(c),!1),(0,y.zs)(p),!1)),cssSelectorAllowlist:c,actionClickAllowlist:p}))),[2])})})},execute:function(e){return(0,y.sH)(void 0,void 0,void 0,function(){return(0,y.YH)(this,function(t){return[2,e]})})},teardown:function(){return(0,y.sH)(void 0,void 0,void 0,function(){var e,t,r,n;return(0,y.YH)(this,function(i){try{for(t=(e=(0,y.Ju)(f)).next();!t.done;t=e.next())t.value.unsubscribe()}catch(e){r={error:e}}finally{try{t&&!t.done&&(n=e.return)&&n.call(e)}finally{if(r)throw r.error}}return[2]})})}}},ny=(0,y.fX)(['input[type="button"]','input[type="submit"]','input[type="reset"]','input[type="image"]','input[type="file"]'],(0,y.zs)(["a","button",'[role="button"]','[role="link"]','[role="menuitem"]','[role="menuitemcheckbox"]','[role="menuitemradio"]','[role="option"]','[role="tab"]','[role="treeitem"]','[contenteditable="true" i]']),!1),nm=["*"],nb=Array.isArray,nw=function(e){void 0===e&&(e={});var t,r,n,i,o,s="@amplitude/plugin-frustration-browser",a=[],u=null!==(r=null===(t=e.rageClicks)||void 0===t?void 0:t.cssSelectorAllowlist)&&void 0!==r?r:nm,l=null!==(i=null===(n=e.deadClicks)||void 0===n?void 0:n.cssSelectorAllowlist)&&void 0!==i?i:ny,c=null!==(o=e.dataAttributePrefix)&&void 0!==o?o:tS,h=(0,y.fX)([],(0,y.zs)(new Set((0,y.fX)((0,y.fX)([],(0,y.zs)(u),!1),(0,y.zs)(l),!1))),!1),d=function(){var e,t,r=nl("pointerdown").pipe(t7(function(e){return rW(e,"click",h,c,!0)}),ry());window.navigation&&(t=rT(window.navigation,"navigate").pipe(t7(function(e){return rW(e,"navigate",h,c)}),ry()));var n=nu().pipe(t7(function(e){return rW(e,"mutation",h,c)}),ry());return(e={})[p.ClickObservable]=r,e[p.ChangeObservable]=new ri,e[p.NavigateObservable]=t,e[p.MutationObservable]=n,e};return{name:s,type:"enrichment",setup:function(t,r){return(0,y.sH)(void 0,void 0,void 0,function(){var n,i,o,h,f,p;return(0,y.YH)(this,function(v){var g,m,b,w,_,k,S,E,T,C,O,A,I,P,x,R,j,U,L,N,$;return"undefined"==typeof document?[2]:(n=rL(e,u),i=rL(e,l),m=(g={allObservables:o=d(),amplitude:r,shouldTrackRageClick:n}).amplitude,b=g.allObservables,w=g.shouldTrackRageClick,_=b.clickObservable,k=[],h=_.pipe(rG(rF),rG(function(e){return w("click",e.closestTrackedAncestor)}),t7(function(e){var t=e.timestamp;k.length>0&&k[k.length-1].closestTrackedAncestor!==e.closestTrackedAncestor&&k.splice(0,k.length);for(var r=0;r<k.length&&!(t-k[r].timestamp<1e3);r++);if(k.splice(0,r),k.push(e),k.length<4)return null;var n=k[0],i=k[k.length-1],o=(0,y.Cl)({"[Amplitude] Begin Time":new Date(n.timestamp).toISOString(),"[Amplitude] End Time":new Date(i.timestamp).toISOString(),"[Amplitude] Duration":i.timestamp-n.timestamp,"[Amplitude] Clicks":k.map(function(e){return{X:e.event.clientX,Y:e.event.clientY,Time:e.timestamp}}),"[Amplitude] Click Count":k.length},n.targetElementProperties);return k.splice(0,k.length),{rageClickEvent:o,time:n.timestamp}}),rG(function(e){return null!==e})).subscribe(function(e){null!==e&&m.track("[Amplitude] Rage Click",e.rageClickEvent,{time:e.time})}),a.push(h),E=(S={amplitude:r,allObservables:o,getEventProperties:function(e,t){return rz(e,t,c)},shouldTrackDeadClick:i}).amplitude,T=S.allObservables,C=S.getEventProperties,O=S.shouldTrackDeadClick,A=T.clickObservable,I=T.mutationObservable,P=T.navigateObservable,x=A.pipe(rG(rF),rG(function(e){return O("click",e.closestTrackedAncestor)})),R=[I],P&&R.push(P),j=nr.apply(void 0,(0,y.fX)([],(0,y.zs)(R),!1)),f=x.pipe(rw(function(e){var t;return(function(){for(var e,t,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return 1===(r=1===(t=r).length&&nb(t[0])?t[0]:t).length?rd(r[0]):new ri((e=r,function(t){for(var r=[],n=function(n){r.push(rd(e[n]).subscribe(t8(t,function(e){if(r){for(var i=0;i<r.length;i++)i!==n&&r[i].unsubscribe();r=null}t.next(e)})))},i=0;r&&!t.closed&&i<e.length;i++)n(i)}))})(new ri(function(r){return t=setTimeout(function(){return r.next(e)},3e3),function(){clearTimeout(t)}}),j.pipe(nn(1),t7(function(){return null}))).pipe(rG(function(e){return null!==e}))}),(void 0===U&&(U=r2),L=no(3e3,U),N=function(){return L},$=void 0,t$(function(e,t){var r=null!=$?$:{},n=r.leading,i=void 0===n||n,o=r.trailing,s=void 0!==o&&o,a=!1,u=null,l=null,c=!1,h=function(){null==l||l.unsubscribe(),l=null,s&&(p(),c&&t.complete())},d=function(){l=null,c&&t.complete()},f=function(e){return l=rd(N(e)).subscribe(t8(t,h,d))},p=function(){if(a){a=!1;var e=u;u=null,t.next(e),c||f(e)}};e.subscribe(t8(t,function(e){a=!0,u=e,l&&!l.closed||(i?p():f(e))},function(){c=!0,s&&a&&l&&!l.closed||t.complete()}))}))).subscribe(function(e){var t={"[Amplitude] X":e.event.clientX,"[Amplitude] Y":e.event.clientY};E.track("[Amplitude] Dead Click",(0,y.Cl)((0,y.Cl)({},C("click",e.closestTrackedAncestor)),t),{time:e.timestamp})}),a.push(f),null===(p=null==t?void 0:t.loggerProvider)||void 0===p||p.log("".concat(s," has been successfully added.")),[2])})})},execute:function(e){return(0,y.sH)(void 0,void 0,void 0,function(){return(0,y.YH)(this,function(t){return[2,e]})})},teardown:function(){return(0,y.sH)(void 0,void 0,void 0,function(){var e,t,r,n;return(0,y.YH)(this,function(i){try{for(t=(e=(0,y.Ju)(a)).next();!t.done;t=e.next())t.value.unsubscribe()}catch(e){r={error:e}}finally{try{t&&!t.done&&(n=e.return)&&n.call(e)}finally{if(r)throw r.error}}return[2]})})}}};function n_(e){return e.startsWith("/")&&(e=e.slice(1)),e.split("/").map(function(e){return e.replace(/~0/g,"~").replace(/~1/g,"/")})}function nk(e,t){return t.some(function(t){return function e(t,r,n,i){if(void 0===n&&(n=0),void 0===i&&(i=0),i===r.length)return n===t.length;if(n===t.length){for(;i<r.length&&"**"===r[i];)i++;return i===r.length}var o=r[i];if("**"===o){if(i+1===r.length)return!0;for(var s=n;s<=t.length;s++)if(e(t,r,s,i+1))return!0;return!1}return("*"===o||o===t[n])&&e(t,r,n+1,i+1)}(e,t)})}var nS=function(){function e(){this.headers=!1,this.body=!1}return e.prototype.consume=function(e){if(this[e])throw TypeError("".concat(e," has already been consumed"));this[e]=!0},e}(),nE=function(){function e(e){this.request=e,this.consumptionCheck=new nS}return e.prototype.headers=function(e){void 0===e&&(e=[]),this.consumptionCheck.consume("headers");var t,r,n=this.request.headers,i={};if(Array.isArray(n))n.forEach(function(e){var t=(0,y.zs)(e,2),r=t[0],n=t[1];i[r]=n});else if(n instanceof Headers)n.forEach(function(e,t){i[t]=e});else if("object"==typeof n&&null!==n)try{for(var o=(0,y.Ju)(Object.entries(n)),s=o.next();!s.done;s=o.next()){var a=(0,y.zs)(s.value,2),u=a[0],l=a[1];i[u]=l}}catch(e){t={error:e}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}return nx(i,{allow:e})},Object.defineProperty(e.prototype,"bodySize",{get:function(){if("number"==typeof this._bodySize)return this._bodySize;var e=E();if(null==e?void 0:e.TextEncoder){var t=this.request.body;return this._bodySize=nC(t,100),this._bodySize}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"method",{get:function(){return this.request.method},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"body",{get:function(){return(this.consumptionCheck.consume("body"),"string"==typeof this.request.body)?this.request.body:null},enumerable:!1,configurable:!0}),e.prototype.json=function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=[]),(0,y.sH)(this,void 0,void 0,function(){return(0,y.YH)(this,function(r){return 0===e.length?[2,null]:[2,nI(this.body,e,t)]})})},e}(),nT=function(){function e(e,t){this.bodyRaw=e,this.requestHeaders=t,this.consumptionCheck=new nS}return e.prototype.headers=function(e){return void 0===e&&(e=[]),this.consumptionCheck.consume("headers"),nx(this.requestHeaders,{allow:e})},Object.defineProperty(e.prototype,"bodySize",{get:function(){return nC(this.bodyRaw,100)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"body",{get:function(){return(this.consumptionCheck.consume("body"),"string"==typeof this.bodyRaw)?this.bodyRaw:null},enumerable:!1,configurable:!0}),e.prototype.json=function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=[]),(0,y.sH)(this,void 0,void 0,function(){return(0,y.YH)(this,function(r){return 0===e.length?[2,null]:[2,nI(this.body,e,t)]})})},e}();function nC(e,t){var r,n,i,o,s=E(),a=null==s?void 0:s.TextEncoder;if(a){if("string"==typeof e)o=e,i=new a().encode(o).length;else if(e instanceof Blob)i=(o=e).size;else if(e instanceof URLSearchParams)o=e,i=new a().encode(o.toString()).length;else if(ArrayBuffer.isView(e))i=(o=e).byteLength;else if(e instanceof ArrayBuffer)i=(o=e).byteLength;else if(e instanceof FormData){var u=0,l=0;try{for(var c=(0,y.Ju)(e.entries()),h=c.next();!h.done;h=c.next()){var d=(0,y.zs)(h.value,2),f=d[0],p=d[1];if(u+=f.length,"string"==typeof p)u+=new a().encode(p).length;else{if(!(p instanceof Blob))return;u+=p.size}if(++l>=t)return}}catch(e){r={error:e}}finally{try{h&&!h.done&&(n=c.return)&&n.call(c)}finally{if(r)throw r.error}}i=u}else if(e instanceof ReadableStream){o=e;return}return i}}var nO=function(){function e(e){this.response=e,this.consumptionCheck=new nS}return e.prototype.headers=function(e){var t;if(void 0===e&&(e=[]),this.consumptionCheck.consume("headers"),this.response.headers instanceof Headers){var r=this.response.headers,n={};return null===(t=null==r?void 0:r.forEach)||void 0===t||t.call(r,function(e,t){n[t]=e}),nx(n,{allow:e})}},Object.defineProperty(e.prototype,"bodySize",{get:function(){if(void 0!==this._bodySize)return this._bodySize;var e,t,r=null===(t=null===(e=this.response.headers)||void 0===e?void 0:e.get)||void 0===t?void 0:t.call(e,"content-length"),n=r?parseInt(r,10):void 0;return this._bodySize=n,n},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"status",{get:function(){return this.response.status},enumerable:!1,configurable:!0}),e.prototype.text=function(){return(0,y.sH)(this,void 0,void 0,function(){var e;return(0,y.YH)(this,function(t){switch(t.label){case 0:this.consumptionCheck.consume("body"),e=this.response.clone(),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,Promise.race([e.text(),new Promise(function(e){return setTimeout(function(){return e(null)},500)})])];case 2:return[2,t.sent()];case 3:return t.sent(),[2,null];case 4:return[2]}})})},e.prototype.json=function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=[]),(0,y.sH)(this,void 0,void 0,function(){return(0,y.YH)(this,function(r){switch(r.label){case 0:if(0===e.length)return[2,null];return[4,this.text()];case 1:return[2,nI(r.sent(),e,t)]}})})},e}(),nA=function(){function e(e,t,r,n){this.statusCode=e,this.headersString=t,this.size=r,this.responseText=n,this.consumptionCheck=new nS}return Object.defineProperty(e.prototype,"bodySize",{get:function(){return this.size},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"status",{get:function(){return this.statusCode},enumerable:!1,configurable:!0}),e.prototype.text=function(){return(0,y.sH)(this,void 0,void 0,function(){return(0,y.YH)(this,function(e){return this.consumptionCheck.consume("body"),[2,this.responseText]})})},e.prototype.headers=function(e){if(void 0===e&&(e=[]),this.consumptionCheck.consume("headers"),!this.headersString)return{};var t,r,n={},i=this.headersString.split("\r\n");try{for(var o=(0,y.Ju)(i),s=o.next();!s.done;s=o.next()){var a=s.value,u=(0,y.zs)(a.split(": "),2),l=u[0],c=u[1];l&&c&&(n[l]=c)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}return nx(n,{allow:e})},e.prototype.json=function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=[]),(0,y.sH)(this,void 0,void 0,function(){return(0,y.YH)(this,function(r){switch(r.label){case 0:if(0===e.length)return[2,null];return[4,this.text()];case 1:return[2,nI(r.sent(),e,t)]}})})},e}();function nI(e,t,r){if(!e)return null;try{var n=JSON.parse(e);return n&&function e(t){var r,n,i=t.json,o=t.targetObject,s=t.allowlist,a=t.excludelist,u=t.ancestors,l=t.parentObject,c=t.targetKey;o||(o=i);var h=Object.keys(o);try{for(var d=(0,y.Ju)(h),f=d.next();!f.done;f=d.next()){var p,v=f.value,g=(0,y.fX)((0,y.fX)([],(0,y.zs)(u),!1),[v],!1);(p=o[v],"string"==typeof p||"number"==typeof p||"boolean"==typeof p||null==p)?(!nk(g,s)||nk(g,a))&&delete o[v]:e({json:i,targetObject:o[v],allowlist:s,excludelist:a,ancestors:g,parentObject:o,targetKey:v})}}catch(e){r={error:e}}finally{try{f&&!f.done&&(n=d.return)&&n.call(d)}finally{if(r)throw r.error}}0===Object.keys(o).length&&l&&c&&delete l[c]}({json:n,allowlist:t.map(n_),excludelist:r.map(n_),ancestors:[]}),n}catch(e){return null}}!function(e){e.REDACT="redact",e.REMOVE="remove"}(v||(v={}));var nP="[REDACTED]",nx=function(e,t){var r,n,i=t.allow,o=void 0===i?[]:i,s=t.strategy,a=void 0===s?v.REMOVE:s,u=(0,y.fX)([],(0,y.zs)(q.L),!1),l={};try{for(var c=(0,y.Ju)(Object.keys(e)),h=c.next();!h.done;h=c.next()){var d=h.value;!function(t){var r=t.toLowerCase();u.find(function(e){return e.toLowerCase()===r})?a===v.REDACT&&(l[t]=nP):o.find(function(e){return e.toLowerCase()===r})?l[t]=e[t]:a===v.REDACT&&(l[t]=nP)}(d)}}catch(e){r={error:e}}finally{try{h&&!h.done&&(n=c.return)&&n.call(c)}finally{if(r)throw r.error}}return l},nR=function(){function e(e,t,r,n,i,o,s,a,u,l,c){void 0===s&&(s=0),this.type=e,this.method=t,this.timestamp=r,this.startTime=n,this.url=i,this.requestWrapper=o,this.status=s,this.duration=a,this.responseWrapper=u,this.error=l,this.endTime=c}return e.prototype.toSerializable=function(){var e,t,r,n;return Object.fromEntries(Object.entries({type:this.type,method:this.method,url:this.url,timestamp:this.timestamp,status:this.status,duration:this.duration,error:this.error,startTime:this.startTime,endTime:this.endTime,requestHeaders:null===(e=this.requestWrapper)||void 0===e?void 0:e.headers((0,y.fX)([],(0,y.zs)(q.j7),!1)),requestBodySize:null===(t=this.requestWrapper)||void 0===t?void 0:t.bodySize,responseHeaders:null===(r=this.responseWrapper)||void 0===r?void 0:r.headers((0,y.fX)([],(0,y.zs)(q.j7),!1)),responseBodySize:null===(n=this.responseWrapper)||void 0===n?void 0:n.bodySize}).filter(function(e){var t=(0,y.zs)(e,2);return void 0!==(t[0],t[1])}))},e}(),nj=function(e,t){void 0===t&&(t=C()),this.callback=e,this.id=t},nU=new(function(){function e(t){this.eventCallbacks=new Map,this.isObserving=!1,this.logger=t;var r=E();e.isSupported()&&(this.globalScope=r)}return e.isSupported=function(){var e=E();return!!e&&!!e.fetch},e.prototype.subscribe=function(e,t){var r,n,i,o,s,a,u,l,c,h;if(this.logger||(this.logger=t),this.eventCallbacks.set(e.id,e),!this.isObserving){var d=null===(i=null===(n=null===(r=this.globalScope)||void 0===r?void 0:r.XMLHttpRequest)||void 0===n?void 0:n.prototype)||void 0===i?void 0:i.open,f=null===(a=null===(s=null===(o=this.globalScope)||void 0===o?void 0:o.XMLHttpRequest)||void 0===s?void 0:s.prototype)||void 0===a?void 0:a.send,p=null===(c=null===(l=null===(u=this.globalScope)||void 0===u?void 0:u.XMLHttpRequest)||void 0===l?void 0:l.prototype)||void 0===c?void 0:c.setRequestHeader;d&&f&&p&&this.observeXhr(d,f,p);var v=null===(h=this.globalScope)||void 0===h?void 0:h.fetch;v&&this.observeFetch(v),this.isObserving=!0}},e.prototype.unsubscribe=function(e){this.eventCallbacks.delete(e.id)},e.prototype.triggerEventCallbacks=function(e){var t=this;this.eventCallbacks.forEach(function(r){var n;try{r.callback(e)}catch(e){null===(n=t.logger)||void 0===n||n.debug("an unexpected error occurred while triggering event callbacks",e)}})},e.prototype.handleNetworkRequestEvent=function(e,t,r,n,i,o,s){if(void 0!==o&&void 0!==s){var a,u,l,c,h="GET";"object"==typeof t&&null!==t&&"url"in t&&"method"in t?(u=t.url,h=t.method):u=null===(a=null==t?void 0:t.toString)||void 0===a?void 0:a.call(t),h=(null==r?void 0:r.method)||h,n&&(l=n.status),i&&(c={name:i.name||"UnknownError",message:i.message||"An unknown error occurred"},l=0);var d=Math.floor(performance.now()-s),f=Math.floor(o+d),p=new nR(e,h,o,o,u,r,l,d,n,c,f);this.triggerEventCallbacks(p)}},e.prototype.getTimestamps=function(){var e,t;return{startTime:null===(e=Date.now)||void 0===e?void 0:e.call(Date),durationStart:null===(t=null==performance?void 0:performance.now)||void 0===t?void 0:t.call(performance)}},e.prototype.observeFetch=function(e){var t=this;this.globalScope&&e&&(this.globalScope.fetch=function(r,n){return(0,y.sH)(t,void 0,void 0,function(){var t,i,o,s,a;return(0,y.YH)(this,function(u){switch(u.label){case 0:try{t=this.getTimestamps()}catch(e){null===(s=this.logger)||void 0===s||s.debug("an unexpected error occurred while retrieving timestamps",e)}u.label=1;case 1:return u.trys.push([1,3,,4]),[4,e(r,n)];case 2:return i=u.sent(),[3,4];case 3:return o=u.sent(),[3,4];case 4:try{this.handleNetworkRequestEvent("fetch",r,n?new nE(n):void 0,i?new nO(i):void 0,o,null==t?void 0:t.startTime,null==t?void 0:t.durationStart)}catch(e){null===(a=this.logger)||void 0===a||a.debug("an unexpected error occurred while handling fetch",e)}if(i)return[2,i];throw o}})})})},e.prototype.observeXhr=function(e,t,r){if(this.globalScope&&e&&t){var n=this.globalScope.XMLHttpRequest.prototype,i=this;n.open=function(){for(var t,r,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];var s=(0,y.zs)(n,2),a=s[0],u=s[1];try{this.$$AmplitudeAnalyticsEvent=(0,y.Cl)({method:a,url:null===(t=null==u?void 0:u.toString)||void 0===t?void 0:t.call(u),headers:{}},i.getTimestamps())}catch(e){null===(r=i.logger)||void 0===r||r.debug("an unexpected error occurred while calling xhr open",e)}return e.apply(this,n)},n.send=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var n=this,o=e[0],s=n.$$AmplitudeAnalyticsEvent;return n.addEventListener("loadend",function(){var e;try{var t=n.getAllResponseHeaders(),r=n.getResponseHeader("content-length"),a=new nA(n.status,t,r?parseInt(r,10):void 0,n.responseText),u=n.$$AmplitudeAnalyticsEvent.headers,l=new nT(o,u);s.status=n.status,i.handleNetworkRequestEvent("xhr",{url:s.url,method:s.method},l,a,void 0,s.startTime,s.durationStart)}catch(t){null===(e=i.logger)||void 0===e||e.debug("an unexpected error occurred while handling xhr send",t)}}),t.apply(n,e)},n.setRequestHeader=function(e,t){var n;try{this.$$AmplitudeAnalyticsEvent.headers[e]=t}catch(e){null===(n=i.logger)||void 0===n||n.debug("an unexpected error occurred while calling xhr setRequestHeader",e)}r.apply(this,[e,t])}}},e}()),nL="[Amplitude] Network Request",nN="500-599";function n$(e,t){return RegExp("^"+t.replace(/[-[\]{}()+?.,\\^$|#\s]/g,"\\$&").replace(/\*/g,".*")+"$").test(e)}function nD(e,t){var r,n,i=t.split(",");try{for(var o=(0,y.Ju)(i),s=o.next();!s.done;s=o.next()){var a=s.value,u=(0,y.zs)(a.split("-").map(Number),2),l=u[0],c=u[1];if(e===l&&void 0===c||e>=l&&e<=c)return!0}}catch(e){r={error:e}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return!1}function nH(e){var t;if(e)try{var r=null===(t=E())||void 0===t?void 0:t.location.href,n=new URL(e,r),i=n.searchParams.toString(),o=n.hash.replace("#",""),s=n.href,a=n.host;n.hash="",n.search="";var u=n.href;return{query:i,fragment:o,href:s,hrefWithoutQueryOrHash:u,host:a}}catch(e){return}}function nq(e){return"object"!=typeof e||null===e?e?(0,y.fX)([],(0,y.zs)(q.j7),!1):void 0:0!==e.length?e:void 0}function nM(e){var t,r;return!(null===(t=null==e?void 0:e.allowlist)||void 0===t?void 0:t.length)&&!(null===(r=null==e?void 0:e.blocklist)||void 0===r?void 0:r.length)}(g||(g={})).NetworkObservable="networkObservable";var nB=function(e){void 0===e&&(e={});var t,r="@amplitude/plugin-network-capture-browser",n=[],i=function(){var e,r=new ri(function(e){var r=new nj(function(t){var r={event:t,timestamp:Date.now(),type:"network"};e.next(r)});return nU.subscribe(r,t),function(){nU.unsubscribe(r)}});return(e={})[g.NetworkObservable]=r,e};return{name:r,type:"enrichment",setup:function(o,s){return(0,y.sH)(void 0,void 0,void 0,function(){var a;return(0,y.YH)(this,function(u){var l,c,h,d;return"undefined"==typeof document?[2]:(c=(l={allObservables:i(),networkTrackingOptions:e,amplitude:s}).allObservables,h=l.networkTrackingOptions,d=l.amplitude,a=c.networkObservable.pipe(rG(function(e){return function(e,t){void 0===t&&(t={});var r,n,i=nH(e.url);if(!i)return!1;var o=i.host;return!(!1!==t.ignoreAmplitudeRequests&&(n$(o,"*.amplitude.com")||n$(o,"amplitude.com"))||(null===(r=t.ignoreHosts)||void 0===r?void 0:r.find(function(e){return n$(o,e)}))||!t.captureRules&&void 0!==e.status&&!nD(e.status,nN)||t.captureRules&&((0,y.fX)([],(0,y.zs)(t.captureRules),!1).reverse().find(function(t){var r,i,s;if(r=e.status,i=e.url,s=e.method,n=t.hosts&&!t.hosts.find(function(e){return n$(o,e)})||i&&t.urls&&!rO(i,t.urls)||s&&t.methods&&!t.methods.find(function(e){return s.toLowerCase()===e.toLowerCase()||"*"===e})?void 0:!r&&0!==r||!!nD(r,t.statusCodeRange||nN)){var a=nq(t.responseHeaders);if(e.responseWrapper&&a){var u=e.responseWrapper.headers(a);u&&(e.responseHeaders=u)}var l=nq(t.requestHeaders);if(e.requestWrapper&&l){var c=e.requestWrapper.headers(l);c&&(e.requestHeaders=c)}e.responseWrapper&&t.responseBody&&!nM(t.responseBody)&&(e.responseBodyJson=e.responseWrapper.json(t.responseBody.allowlist,t.responseBody.blocklist)),e.requestWrapper&&t.requestBody&&!nM(t.requestBody)&&(e.requestBodyJson=e.requestWrapper.json(t.requestBody.allowlist,t.requestBody.blocklist))}return void 0!==n}),!n)||e.requestWrapper&&function(e,t){if(e.includes("amplitude.com"))try{var r=t.body;if("string"!=typeof r)return!1;if(JSON.parse(r).events.find(function(e){return e.event_type===nL}))return!0}catch(e){}return!1}(o,e.requestWrapper))}(e.event,h)})).subscribe(function(e){var t,r,n,i=e.event,o=nH(i.url);if(o){var s=null===(r=i.responseWrapper)||void 0===r?void 0:r.bodySize,a=null===(n=i.requestWrapper)||void 0===n?void 0:n.bodySize;(function(e,t,r){(0,y.sH)(this,void 0,void 0,function(){var n,i,o;return(0,y.YH)(this,function(s){switch(s.label){case 0:if(!(t.requestBodyJson||t.responseBodyJson))return[3,2];return[4,Promise.all([t.requestBodyJson,t.responseBodyJson])];case 1:i=(n=y.zs.apply(void 0,[s.sent(),2]))[0],o=n[1],i&&(e["[Amplitude] Request Body"]=i),o&&(e["[Amplitude] Response Body"]=o),s.label=2;case 2:return null==r||r.track(nL,e),[2]}})})})(((t={})["[Amplitude] URL"]=o.hrefWithoutQueryOrHash,t["[Amplitude] URL Query"]=o.query,t["[Amplitude] URL Fragment"]=o.fragment,t["[Amplitude] Request Method"]=i.method,t["[Amplitude] Status Code"]=i.status,t["[Amplitude] Start Time"]=i.startTime,t["[Amplitude] Completion Time"]=i.endTime,t["[Amplitude] Duration"]=i.duration,t["[Amplitude] Request Body Size"]=a,t["[Amplitude] Response Body Size"]=s,t["[Amplitude] Request Type"]=i.type,t["[Amplitude] Request Headers"]=i.requestHeaders,t["[Amplitude] Response Headers"]=i.responseHeaders,t),i,d)}}),n.push(a),null==(t=null==o?void 0:o.loggerProvider)||t.log("".concat(r," has been successfully added.")),[2])})})},execute:function(e){return(0,y.sH)(void 0,void 0,void 0,function(){return(0,y.YH)(this,function(t){return[2,e]})})},teardown:function(){return(0,y.sH)(void 0,void 0,void 0,function(){var e,t,r,i;return(0,y.YH)(this,function(o){try{for(t=(e=(0,y.Ju)(n)).next();!t.done;t=e.next())t.value.unsubscribe()}catch(e){r={error:e}}finally{try{t&&!t.done&&(i=e.return)&&i.call(e)}finally{if(r)throw r.error}}return[2]})})}}};let nF=-1,nz=e=>{addEventListener("pageshow",t=>{t.persisted&&(nF=t.timeStamp,e(t))},!0)},nW=(e,t,r,n)=>{let i,o;return s=>{t.value>=0&&(s||n)&&((o=t.value-(i??0))||void 0===i)&&(i=t.value,t.delta=o,t.rating=((e,t)=>e>t[1]?"poor":e>t[0]?"needs-improvement":"good")(t.value,r),e(t))}},nJ=e=>{requestAnimationFrame(()=>requestAnimationFrame(()=>e()))},nY=()=>{let e=performance.getEntriesByType("navigation")[0];if(e&&e.responseStart>0&&e.responseStart<performance.now())return e},nK=()=>{let e=nY();return e?.activationStart??0},nV=(e,t=-1)=>{let r=nY(),n="navigate";return nF>=0?n="back-forward-cache":r&&(document.prerendering||nK()>0?n="prerender":document.wasDiscarded?n="restore":r.type&&(n=r.type.replace(/_/g,"-"))),{name:e,value:t,rating:"good",delta:0,entries:[],id:`v5-${Date.now()}-${Math.floor(0x82f79cd8fff*Math.random())+1e12}`,navigationType:n}},nG=new WeakMap;function nX(e,t){return nG.get(e)||nG.set(e,new t),nG.get(e)}class nQ{t;i=0;o=[];h(e){if(e.hadRecentInput)return;let t=this.o[0],r=this.o.at(-1);this.i&&t&&r&&e.startTime-r.startTime<1e3&&e.startTime-t.startTime<5e3?(this.i+=e.value,this.o.push(e)):(this.i=e.value,this.o=[e]),this.t?.(e)}}let nZ=(e,t,r={})=>{try{if(PerformanceObserver.supportedEntryTypes.includes(e)){let n=new PerformanceObserver(e=>{Promise.resolve().then(()=>{t(e.getEntries())})});return n.observe({type:e,buffered:!0,...r}),n}}catch{}},n0=e=>{let t=!1;return()=>{t||(e(),t=!0)}},n1=-1,n2=new Set,n3=()=>"hidden"!==document.visibilityState||document.prerendering?1/0:0,n4=e=>{if("hidden"===document.visibilityState){if("visibilitychange"===e.type)for(let e of n2)e();isFinite(n1)||(n1="visibilitychange"===e.type?e.timeStamp:0,removeEventListener("prerenderingchange",n4,!0))}},n5=()=>{if(n1<0){let e=nK();n1=(document.prerendering?void 0:globalThis.performance.getEntriesByType("visibility-state").filter(t=>"hidden"===t.name&&t.startTime>e)[0]?.startTime)??n3(),addEventListener("visibilitychange",n4,!0),addEventListener("prerenderingchange",n4,!0),nz(()=>{setTimeout(()=>{n1=n3()})})}return{get firstHiddenTime(){return n1},onHidden(e){n2.add(e)}}},n6=e=>{document.prerendering?addEventListener("prerenderingchange",()=>e(),!0):e()},n8=[1800,3e3],n9=(e,t={})=>{n6(()=>{let r=n5(),n,i=nV("FCP"),o=nZ("paint",e=>{for(let t of e)"first-contentful-paint"===t.name&&(o.disconnect(),t.startTime<r.firstHiddenTime&&(i.value=Math.max(t.startTime-nK(),0),i.entries.push(t),n(!0)))});o&&(n=nW(e,i,n8,t.reportAllChanges),nz(r=>{n=nW(e,i=nV("FCP"),n8,t.reportAllChanges),nJ(()=>{i.value=performance.now()-r.timeStamp,n(!0)})}))})},n7=[.1,.25],ie=(e,t={})=>{let r=n5();n9(n0(()=>{let n,i=nV("CLS",0),o=nX(t,nQ),s=e=>{for(let t of e)o.h(t);o.i>i.value&&(i.value=o.i,i.entries=o.o,n())},a=nZ("layout-shift",s);a&&(n=nW(e,i,n7,t.reportAllChanges),r.onHidden(()=>{s(a.takeRecords()),n(!0)}),nz(()=>{o.i=0,n=nW(e,i=nV("CLS",0),n7,t.reportAllChanges),nJ(()=>n())}),setTimeout(n))}))},it=0,ir=1/0,ii=0,io=e=>{for(let t of e)t.interactionId&&(ir=Math.min(ir,t.interactionId),it=(ii=Math.max(ii,t.interactionId))?(ii-ir)/7+1:0)},is=()=>n?it:performance.interactionCount??0,ia=()=>{"interactionCount"in performance||n||(n=nZ("event",io,{type:"event",buffered:!0,durationThreshold:0}))},iu=0;class il{u=[];l=new Map;m;p;v(){iu=is(),this.u.length=0,this.l.clear()}L(){let e=Math.min(this.u.length-1,Math.floor((is()-iu)/50));return this.u[e]}h(e){if(this.m?.(e),!e.interactionId&&"first-input"!==e.entryType)return;let t=this.u.at(-1),r=this.l.get(e.interactionId);if(r||this.u.length<10||e.duration>t.P){if(r?e.duration>r.P?(r.entries=[e],r.P=e.duration):e.duration===r.P&&e.startTime===r.entries[0].startTime&&r.entries.push(e):(r={id:e.interactionId,entries:[e],P:e.duration},this.l.set(r.id,r),this.u.push(r)),this.u.sort((e,t)=>t.P-e.P),this.u.length>10)for(let e of this.u.splice(10))this.l.delete(e.id);this.p?.(r)}}}let ic=e=>{let t=globalThis.requestIdleCallback||setTimeout;"hidden"===document.visibilityState?e():(addEventListener("visibilitychange",e=n0(e),{once:!0,capture:!0}),t(()=>{e(),removeEventListener("visibilitychange",e,{capture:!0})}))},ih=[200,500],id=(e,t={})=>{if(!globalThis.PerformanceEventTiming||!("interactionId"in PerformanceEventTiming.prototype))return;let r=n5();n6(()=>{ia();let n,i=nV("INP"),o=nX(t,il),s=e=>{ic(()=>{for(let t of e)o.h(t);let t=o.L();t&&t.P!==i.value&&(i.value=t.P,i.entries=t.entries,n())})},a=nZ("event",s,{durationThreshold:t.durationThreshold??40});n=nW(e,i,ih,t.reportAllChanges),a&&(a.observe({type:"first-input",buffered:!0}),r.onHidden(()=>{s(a.takeRecords()),n(!0)}),nz(()=>{o.v(),n=nW(e,i=nV("INP"),ih,t.reportAllChanges)}))})};class ip{m;h(e){this.m?.(e)}}let iv=[2500,4e3],ig=(e,t={})=>{n6(()=>{let r=n5(),n,i=nV("LCP"),o=nX(t,ip),s=e=>{for(let s of(t.reportAllChanges||(e=e.slice(-1)),e))o.h(s),s.startTime<r.firstHiddenTime&&(i.value=Math.max(s.startTime-nK(),0),i.entries=[s],n())},a=nZ("largest-contentful-paint",s);if(a){n=nW(e,i,iv,t.reportAllChanges);let r=n0(()=>{s(a.takeRecords()),a.disconnect(),n(!0)}),o=e=>{e.isTrusted&&(ic(r),removeEventListener(e.type,o,{capture:!0}))};for(let e of["keydown","click","visibilitychange"])addEventListener(e,o,{capture:!0});nz(r=>{n=nW(e,i=nV("LCP"),iv,t.reportAllChanges),nJ(()=>{i.value=performance.now()-r.timeStamp,n(!0)})})}})},iy=[800,1800],im=e=>{document.prerendering?n6(()=>im(e)):"complete"!==document.readyState?addEventListener("load",()=>im(e),!0):setTimeout(e)},ib=(e,t={})=>{let r=nV("TTFB"),n=nW(e,r,iy,t.reportAllChanges);im(()=>{let i=nY();i&&(r.value=Math.max(i.responseStart-nK(),0),r.entries=[i],n(!0),nz(()=>{(n=nW(e,r=nV("TTFB",0),iy,t.reportAllChanges))(!0)}))})};function iw(e){var t,r;return{value:e.value,rating:e.rating,delta:e.delta,navigationType:e.navigationType,id:e.id,timestamp:Math.floor((r=(null===(t=e.entries[0])||void 0===t?void 0:t.startTime)||0,performance.timeOrigin+r)),navigationStart:Math.floor(performance.timeOrigin)}}var i_=function(){var e=null,t=E(),r=null==t?void 0:t.document,n=null==t?void 0:t.location;return{name:"web-vitals-browser",type:"enrichment",setup:function(t,i){return(0,y.sH)(void 0,void 0,void 0,function(){var o,s,a;return(0,y.YH)(this,function(u){return o=function(e){if(!e)return"";var r,n=e;try{n=decodeURI(e)}catch(e){null===(r=t.loggerProvider)||void 0===r||r.error("Malformed URI sequence: ",e)}return n},void 0===r||(s=o(null==n?void 0:n.href),a={"[Amplitude] Page Domain":(null==n?void 0:n.hostname)||"","[Amplitude] Page Location":s,"[Amplitude] Page Path":o(null==n?void 0:n.pathname),"[Amplitude] Page Title":"undefined"!=typeof document&&document.title||"","[Amplitude] Page URL":s.split("?")[0]},ig(function(e){a["[Amplitude] LCP"]=iw(e)}),n9(function(e){a["[Amplitude] FCP"]=iw(e)}),id(function(e){a["[Amplitude] INP"]=iw(e)}),ie(function(e){a["[Amplitude] CLS"]=iw(e)}),ib(function(e){a["[Amplitude] TTFB"]=iw(e)}),e=function(){"hidden"===r.visibilityState&&e&&(i.track("[Amplitude] Web Vitals",a),r.removeEventListener("visibilitychange",e),e=null)},r.addEventListener("visibilitychange",e)),[2]})})},execute:function(e){return(0,y.sH)(void 0,void 0,void 0,function(){return(0,y.YH)(this,function(t){return[2,e]})})},teardown:function(){return(0,y.sH)(void 0,void 0,void 0,function(){return(0,y.YH)(this,function(t){return e&&(null==r||r.removeEventListener("visibilitychange",e)),[2]})})}}},ik=function(){function e(){}return e.prototype.parse=function(){return(0,y.sH)(this,void 0,void 0,function(){return(0,y.YH)(this,function(e){return[2,(0,y.Cl)((0,y.Cl)((0,y.Cl)((0,y.Cl)({},q.F3),this.getUtmParam()),this.getReferrer()),this.getClickIds())]})})},e.prototype.getUtmParam=function(){var e=A();return{utm_campaign:e[q._9],utm_content:e[q.fL],utm_id:e[q.Cs],utm_medium:e[q.Jn],utm_source:e[q.VU],utm_term:e[q.Wx]}},e.prototype.getReferrer=function(){var e,t,r={referrer:void 0,referring_domain:void 0};try{r.referrer=document.referrer||void 0,r.referring_domain=null!==(t=null===(e=r.referrer)||void 0===e?void 0:e.split("/")[2])&&void 0!==t?t:void 0}catch(e){}return r},e.prototype.getClickIds=function(){var e,t=A();return(e={})[q.h2]=t[q.h2],e[q.lT]=t[q.lT],e[q.wX]=t[q.wX],e[q.q2]=t[q.q2],e[q.KY]=t[q.KY],e[q.Ct]=t[q.Ct],e[q.qr]=t[q.qr],e[q.wu]=t[q.wu],e[q.tt]=t[q.tt],e[q.Gp]=t[q.Gp],e[q.SO]=t[q.SO],e},e}(),iS=function(e){var t=e.split(".");return t.length<=2?e:t.slice(t.length-2,t.length).join(".")},iE=function(e,t,r,n,i){void 0===i&&(i=!0),e.referrer;var o=e.referring_domain,s=(0,y.Tt)(e,["referrer","referring_domain"]),a=t||{},u=(a.referrer,a.referring_domain),l=(0,y.Tt)(a,["referrer","referring_domain"]);if(iT(r.excludeReferrers,e.referring_domain))return n.debug("This is not a new campaign because ".concat(e.referring_domain," is in the exclude referrer list.")),!1;if(!i&&Object.values(e).every(function(e){return!e})&&t)return n.debug("This is not a new campaign because this is a direct traffic in the same session."),!1;var c=JSON.stringify(s)!==JSON.stringify(l),h=iS(o||"")!==iS(u||""),d=!t||c||h;return d?n.debug("This is a new campaign. An $identify event will be sent."):n.debug("This is not a new campaign because it's the same as the previous one."),d},iT=function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=""),e.some(function(e){return e instanceof RegExp?e.test(t):e===t})},iC=function(e){var t=e;return t?(t.startsWith(".")&&(t=t.substring(1)),[new RegExp("".concat(t.replace(".","\\."),"$"))]):[]},iO=function(){function e(e,t){var r,n,i,o;this.shouldTrackNewCampaign=!1,this.options=(0,y.Cl)({initialEmptyValue:"EMPTY",resetSessionOnNewCampaign:!1,excludeReferrers:iC(null===(r=t.cookieOptions)||void 0===r?void 0:r.domain)},e),this.storage=t.cookieStorage,this.storageKey=(n=t.apiKey,i="MKTG",void 0===o&&(o=10),[q.r,i,n.substring(0,o)].filter(Boolean).join("_")),this.currentCampaign=q.F3,this.sessionTimeout=t.sessionTimeout,this.lastEventTime=t.lastEventTime,this.logger=t.loggerProvider,t.loggerProvider.log("Installing web attribution tracking.")}return e.prototype.init=function(){return(0,y.sH)(this,void 0,void 0,function(){var e,t;return(0,y.YH)(this,function(r){switch(r.label){case 0:return[4,this.fetchCampaign()];case 1:if(t=y.zs.apply(void 0,[r.sent(),2]),this.currentCampaign=t[0],this.previousCampaign=t[1],e=!this.lastEventTime||ei(this.sessionTimeout,this.lastEventTime),!iE(this.currentCampaign,this.previousCampaign,this.options,this.logger,e))return[3,3];return this.shouldTrackNewCampaign=!0,[4,this.storage.set(this.storageKey,this.currentCampaign)];case 2:r.sent(),r.label=3;case 3:return[2]}})})},e.prototype.fetchCampaign=function(){return(0,y.sH)(this,void 0,void 0,function(){return(0,y.YH)(this,function(e){switch(e.label){case 0:return[4,Promise.all([new ik().parse(),this.storage.get(this.storageKey)])];case 1:return[2,e.sent()]}})})},e.prototype.generateCampaignEvent=function(e){this.shouldTrackNewCampaign=!1;var t,r,n=(t=this.currentCampaign,r=this.options,es(Object.entries((0,y.Cl)((0,y.Cl)({},q.F3),t)).reduce(function(e,t){var n,i=(0,y.zs)(t,2),o=i[0],s=i[1];return(e.setOnce("initial_".concat(o),null!==(n=null!=s?s:r.initialEmptyValue)&&void 0!==n?n:"EMPTY"),s)?e.set(o,s):e.unset(o)},new et.T$)));return e&&(n.event_id=e),n},e.prototype.shouldSetSessionIdOnNewCampaign=function(){return this.shouldTrackNewCampaign&&!!this.options.resetSessionOnNewCampaign},e}(),iA=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,y.C6)(t,e),t.prototype.init=function(e,t,r){var n,i;return void 0===e&&(e=""),arguments.length>2?(n=t,i=r):"string"==typeof t?(n=t,i=void 0):(n=null==t?void 0:t.userId,i=t),k(this._init((0,y.Cl)((0,y.Cl)({},i),{userId:n,apiKey:e})))},t.prototype._init=function(t){var r,n,i;return(0,y.sH)(this,void 0,void 0,function(){var o,s,a,u,l,c,h=this;return(0,y.YH)(this,function(d){var f,p,v,g,m;switch(d.label){case 0:if(this.initializing)return[2];return this.initializing=!0,[4,(f=t.apiKey,p=t,v=this,void 0===p&&(p={}),(0,y.sH)(void 0,void 0,void 0,function(){var e,t,r,n,i,o,s,a,u,l,c,h,d,g,m,b,w,_,k,S,E,T,O,I,P,x,R,j,U,L,N,$,D,H,M,B,F,z,W,J,Y,K,V,G,X;return(0,y.YH)(this,function(Q){var Z,ee,et;switch(Q.label){case 0:if(e=p.identityStorage||e0,E={},e===e0)return[3,1];return r="",[3,5];case 1:if(null===(O=null===(T=p.cookieOptions)||void 0===T?void 0:T.domain)||void 0===O)return[3,2];return n=O,[3,4];case 2:return[4,(0,y.sH)(void 0,void 0,void 0,function(){var e,t,r,n,i,o;return(0,y.YH)(this,function(s){switch(s.label){case 0:return[4,new eA().isEnabled()];case 1:if(!s.sent()||"undefined"==typeof location||!location.hostname)return[2,""];for(e=(null!=Z?Z:location.hostname).split("."),t=[],r="AMP_TLDTEST",n=e.length-2;n>=0;--n)t.push(e.slice(n).join("."));n=0,s.label=2;case 2:if(!(n<t.length))return[3,7];return[4,(o=new eA({domain:"."+(i=t[n])})).set(r,1)];case 3:return s.sent(),[4,o.get(r)];case 4:if(!s.sent())return[3,6];return[4,o.remove(r)];case 5:return s.sent(),[2,"."+i];case 6:return n++,[3,2];case 7:return[2,""]}})})];case 3:n=Q.sent(),Q.label=4;case 4:r=n,Q.label=5;case 5:return t=y.Cl.apply(void 0,[(E.domain=r,E.expiration=365,E.sameSite="Lax",E.secure=!1,E.upgrade=!0,E),p.cookieOptions]),[4,(ee=i=e2(p.identityStorage,t),void 0===(et=null===(P=null===(I=p.cookieOptions)||void 0===I?void 0:I.upgrade)||void 0===P||P)&&(et=!0),(0,y.sH)(void 0,void 0,void 0,function(){var e,t,r,n,i,o,s,a,u;return(0,y.YH)(this,function(l){switch(l.label){case 0:return e="".concat(q.r.toLowerCase(),"_").concat(f.substring(0,6)),[4,ee.getRaw(e)];case 1:if(!(t=l.sent()))return[2,{optOut:!1}];if(!et)return[3,3];return[4,ee.remove(e)];case 2:l.sent(),l.label=3;case 3:return n=(r=(0,y.zs)(t.split("."),6))[0],i=r[1],o=r[2],s=r[3],a=r[4],u=r[5],[2,{deviceId:n,userId:eH(i),sessionId:eD(s),lastEventId:eD(u),lastEventTime:eD(a),optOut:!!o}]}})}))];case 6:return o=Q.sent(),[4,i.get(eO(f))];case 7:return s=Q.sent(),l=!(u=(a=A()).ampTimestamp?Number(a.ampTimestamp):void 0)||Date.now()<u,c=null!==(L=null!==(U=null!==(j=null!==(x=p.deviceId)&&void 0!==x?x:l?null!==(R=a.ampDeviceId)&&void 0!==R?R:a.deviceId:void 0)&&void 0!==j?j:null==s?void 0:s.deviceId)&&void 0!==U?U:o.deviceId)&&void 0!==L?L:C(),h=null!==(N=null==s?void 0:s.lastEventId)&&void 0!==N?N:o.lastEventId,d=null!==($=null==s?void 0:s.lastEventTime)&&void 0!==$?$:o.lastEventTime,g=null!==(H=null!==(D=p.optOut)&&void 0!==D?D:null==s?void 0:s.optOut)&&void 0!==H?H:o.optOut,m=null!==(M=null==s?void 0:s.sessionId)&&void 0!==M?M:o.sessionId,b=null!==(F=null!==(B=p.userId)&&void 0!==B?B:null==s?void 0:s.userId)&&void 0!==F?F:o.userId,v.previousSessionDeviceId=null!==(z=null==s?void 0:s.deviceId)&&void 0!==z?z:o.deviceId,v.previousSessionUserId=null!==(W=null==s?void 0:s.userId)&&void 0!==W?W:o.userId,w={ipAddress:null===(Y=null===(J=p.trackingOptions)||void 0===J?void 0:J.ipAddress)||void 0===Y||Y,language:null===(V=null===(K=p.trackingOptions)||void 0===K?void 0:K.language)||void 0===V||V,platform:null===(X=null===(G=p.trackingOptions)||void 0===G?void 0:G.platform)||void 0===X||X},_=null==s?void 0:s.pageCounter,k=null==s?void 0:s.debugLogsEnabled,void 0!==p.autocapture&&(p.defaultTracking=p.autocapture),[4,(S=new e1(f,p.appVersion,i,t,p.defaultTracking,p.autocapture,c,p.flushIntervalMillis,p.flushMaxRetries,p.flushQueueSize,e,p.ingestionMetadata,p.instanceName,h,d,p.loggerProvider,p.logLevel,p.minIdLength,p.offline,g,p.partnerId,p.plan,p.serverUrl,p.serverZone,m,p.sessionTimeout,p.storageProvider,w,p.transport,p.useBatch,p.fetchRemoteConfig,b,_,k,p.networkTrackingOptions)).storageProvider.isEnabled()];case 8:return Q.sent()||(S.loggerProvider.warn("Storage provider ".concat(S.storageProvider.constructor.name," is not enabled. Falling back to MemoryStorage.")),S.storageProvider=new eC),[2,S]}})}))];case 1:if(!(o=d.sent()).fetchRemoteConfig)return[3,3];return this.remoteConfigClient=new O(o.apiKey,o.loggerProvider,o.serverZone),[4,new Promise(function(e){var t;null===(t=h.remoteConfigClient)||void 0===t||t.subscribe("configs.analyticsSDK.browserSDK","all",function(t,r,n){o.loggerProvider.debug("Remote configuration received:",JSON.stringify({remoteConfig:t,source:r,lastFetch:n},null,2)),t&&function(e,t){if(e){!function e(t){if(!("object"!=typeof t||null===t||Array.isArray(t))){var r,n,i=Object.keys(t);try{for(var o=(0,y.Ju)(i),s=o.next();!s.done;s=o.next()){var a=s.value;try{var u=t[a];"boolean"==typeof(null==u?void 0:u.enabled)&&(u.enabled?(delete u.enabled,0===Object.keys(u).length&&(t[a]=!0)):t[a]=!1),e(u)}catch(e){}}}catch(e){r={error:e}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}}}(e);try{var r,n,i,o;if(t.loggerProvider.debug("Update browser config with remote configuration:",JSON.stringify(e)),e&&"autocapture"in e){if("boolean"==typeof e.autocapture&&(t.autocapture=e.autocapture),"object"==typeof e.autocapture&&null!==e.autocapture){var s=(0,y.Cl)({},e.autocapture);if(void 0===t.autocapture&&(t.autocapture=e.autocapture),"object"==typeof e.autocapture.elementInteractions&&null!==e.autocapture.elementInteractions&&(null===(i=e.autocapture.elementInteractions.pageUrlAllowlistRegex)||void 0===i?void 0:i.length)){s.elementInteractions=(0,y.Cl)({},e.autocapture.elementInteractions);var a=s.elementInteractions,u=null!==(o=a.pageUrlAllowlist)&&void 0!==o?o:[],l=[];try{for(var c=(0,y.Ju)(e.autocapture.elementInteractions.pageUrlAllowlistRegex),h=c.next();!h.done;h=c.next()){var d=h.value;try{l.push(new RegExp(d))}catch(e){t.loggerProvider.warn("Invalid regex pattern: ".concat(d),e)}}}catch(e){r={error:e}}finally{try{h&&!h.done&&(n=c.return)&&n.call(c)}finally{if(r)throw r.error}}var f=u.concat(l);a.pageUrlAllowlist=f,delete a.pageUrlAllowlistRegex}"boolean"==typeof t.autocapture&&(t.autocapture=(0,y.Cl)({attribution:t.autocapture,fileDownloads:t.autocapture,formInteractions:t.autocapture,pageViews:t.autocapture,sessions:t.autocapture,elementInteractions:t.autocapture,webVitals:t.autocapture,frustrationInteractions:t.autocapture},s)),"object"==typeof t.autocapture&&(t.autocapture=(0,y.Cl)((0,y.Cl)({},t.autocapture),s))}t.defaultTracking=t.autocapture}t.loggerProvider.debug("Browser config after remote config update:",JSON.stringify(t))}catch(e){t.loggerProvider.error("Failed to apply remote configuration because of error: ",e)}}}(t,o),e()})})];case 2:d.sent(),d.label=3;case 3:return[4,e.prototype._init.call(this,o)];case 4:if(d.sent(),this.logBrowserOptions(o),!eh(this.config.defaultTracking))return[3,6];return s=eh((g=this.config).defaultTracking)&&g.defaultTracking&&"object"==typeof g.defaultTracking&&g.defaultTracking.attribution&&"object"==typeof g.defaultTracking.attribution?(0,y.Cl)({},g.defaultTracking.attribution):{},this.webAttribution=new iO(s,this.config),[4,this.webAttribution.init()];case 5:d.sent(),d.label=6;case 6:if(l=!(!(u=(a=A()).ampTimestamp?Number(a.ampTimestamp):void 0)||Date.now()<u)||Number.isNaN(Number(a.ampSessionId))?void 0:Number(a.ampSessionId),this.setSessionId(null!==(i=null!==(n=null!==(r=t.sessionId)&&void 0!==r?r:l)&&void 0!==n?n:this.config.sessionId)&&void 0!==i?i:Date.now()),(c=M(t.instanceName)).identityStore.setIdentity({userId:this.config.userId,deviceId:this.config.deviceId}),null===this.config.offline)return[3,8];return[4,this.add(t_()).promise];case 7:d.sent(),d.label=8;case 8:return[4,this.add(new Z).promise];case 9:return d.sent(),[4,this.add(new eT).promise];case 10:return d.sent(),[4,this.add(new ee).promise];case 11:if(d.sent(),tw(this.config),!ec(this.config.defaultTracking,"fileDownloads"))return[3,13];return this.config.loggerProvider.debug("Adding file download tracking plugin"),[4,this.add(tm()).promise];case 12:d.sent(),d.label=13;case 13:if(!ec(this.config.defaultTracking,"formInteractions"))return[3,15];return this.config.loggerProvider.debug("Adding form interaction plugin"),[4,this.add(tv()).promise];case 14:d.sent(),d.label=15;case 15:if(!ed(this.config.defaultTracking))return[3,17];return this.config.loggerProvider.debug("Adding page view tracking plugin"),[4,this.add(th(ew(this.config))).promise];case 16:d.sent(),d.label=17;case 17:if(!ev(this.config.autocapture))return[3,19];return this.config.loggerProvider.debug("Adding user interactions plugin (autocapture plugin)"),[4,this.add(ng(ey(this.config))).promise];case 18:d.sent(),d.label=19;case 19:if(!eg(this.config.autocapture))return[3,21];return this.config.loggerProvider.debug("Adding frustration interactions plugin"),[4,this.add(nw(em(this.config))).promise];case 20:d.sent(),d.label=21;case 21:if(!ep(this.config.autocapture))return[3,23];return this.config.loggerProvider.debug("Adding network tracking plugin"),[4,this.add(nB(eb(this.config))).promise];case 22:d.sent(),d.label=23;case 23:if("object"!=typeof(m=this.config.autocapture)||!0!==m.webVitals)return[3,25];return this.config.loggerProvider.debug("Adding web vitals plugin"),[4,this.add(i_()).promise];case 24:d.sent(),d.label=25;case 25:return this.initializing=!1,[4,this.runQueuedFunctions("dispatchQ")];case 26:return d.sent(),c.eventBridge.setEventReceiver(function(e){h.track(e.eventType,e.eventProperties)}),[2]}})})},t.prototype.getUserId=function(){var e;return null===(e=this.config)||void 0===e?void 0:e.userId},t.prototype.setUserId=function(e){if(!this.config){this.q.push(this.setUserId.bind(this,e));return}this.config.loggerProvider.debug("function setUserId: ",e),(e!==this.config.userId||void 0===e)&&(this.config.userId=e,this.timeline.onIdentityChanged({userId:e}),B(e,this.config.instanceName))},t.prototype.getDeviceId=function(){var e;return null===(e=this.config)||void 0===e?void 0:e.deviceId},t.prototype.setDeviceId=function(e){if(!this.config){this.q.push(this.setDeviceId.bind(this,e));return}this.config.loggerProvider.debug("function setDeviceId: ",e),e!==this.config.deviceId&&(this.config.deviceId=e,this.timeline.onIdentityChanged({deviceId:e}),F(e,this.config.instanceName))},t.prototype.reset=function(){this.setDeviceId(C()),this.setUserId(void 0)},t.prototype.getIdentity=function(){var e,t;return{deviceId:null===(e=this.config)||void 0===e?void 0:e.deviceId,userId:null===(t=this.config)||void 0===t?void 0:t.userId,userProperties:this.userProperties}},t.prototype.getOptOut=function(){var e;return null===(e=this.config)||void 0===e?void 0:e.optOut},t.prototype.getSessionId=function(){var e;return null===(e=this.config)||void 0===e?void 0:e.sessionId},t.prototype.setSessionId=function(e){var t,r=[];if(!this.config)return this.q.push(this.setSessionId.bind(this,e)),k(Promise.resolve());if(e===this.config.sessionId)return k(Promise.resolve());this.config.loggerProvider.debug("function setSessionId: ",e);var n=this.getSessionId();n!==e&&this.timeline.onSessionIdChanged(e);var i=this.config.lastEventTime,o=null!==(t=this.config.lastEventId)&&void 0!==t?t:-1;this.config.sessionId=e,this.config.lastEventTime=void 0,this.config.pageCounter=0,ef(this.config.defaultTracking)&&(n&&i&&r.push(this.track(eW,void 0,{device_id:this.previousSessionDeviceId,event_id:++o,session_id:n,time:i+1,user_id:this.previousSessionUserId}).promise),this.config.lastEventTime=this.config.sessionId);var s=this.trackCampaignEventIfNeeded(++o,r);return ef(this.config.defaultTracking)&&r.push(this.track(ez,void 0,{event_id:s?++o:o,session_id:this.config.sessionId,time:this.config.lastEventTime}).promise),this.previousSessionDeviceId=this.config.deviceId,this.previousSessionUserId=this.config.userId,k(Promise.all(r))},t.prototype.extendSession=function(){if(!this.config){this.q.push(this.extendSession.bind(this));return}this.config.lastEventTime=Date.now()},t.prototype.setTransport=function(e){if(!this.config){this.q.push(this.setTransport.bind(this,e));return}this.config.transportProvider=e3(e)},t.prototype.identify=function(t,r){if(ek(t)){var n=t._q;t._q=[],t=e_(new et.T$,n)}return(null==r?void 0:r.user_id)&&this.setUserId(r.user_id),(null==r?void 0:r.device_id)&&this.setDeviceId(r.device_id),e.prototype.identify.call(this,t,r)},t.prototype.groupIdentify=function(t,r,n,i){if(ek(n)){var o=n._q;n._q=[],n=e_(new et.T$,o)}return e.prototype.groupIdentify.call(this,t,r,n,i)},t.prototype.revenue=function(t,r){if(ek(t)){var n=t._q;t._q=[],t=e_(new en,n)}return e.prototype.revenue.call(this,t,r)},t.prototype.trackCampaignEventIfNeeded=function(e,t){if(!this.webAttribution||!this.webAttribution.shouldTrackNewCampaign)return!1;var r=this.webAttribution.generateCampaignEvent(e);return t?t.push(this.track(r).promise):this.track(r),this.config.loggerProvider.log("Tracking attribution."),!0},t.prototype.process=function(t){return(0,y.sH)(this,void 0,void 0,function(){var r,n,i;return(0,y.YH)(this,function(o){return r=Date.now(),n=ei(this.config.sessionTimeout,this.config.lastEventTime),i=this.webAttribution&&this.webAttribution.shouldSetSessionIdOnNewCampaign(),t.event_type===ez||t.event_type===eW||t.session_id&&t.session_id!==this.getSessionId()||(n||i?(this.setSessionId(r),i&&this.config.loggerProvider.log("Created a new session for new campaign.")):n||this.trackCampaignEventIfNeeded()),t.event_type===u.IDENTIFY&&t.user_properties&&(this.userProperties=this.getOperationAppliedUserProperties(t.user_properties)),[2,e.prototype.process.call(this,t)]})})},t.prototype.logBrowserOptions=function(e){try{var t=(0,y.Cl)((0,y.Cl)({},e),{apiKey:e.apiKey.substring(0,10)+"********"});this.config.loggerProvider.debug("Initialized Amplitude with BrowserConfig:",JSON.stringify(t))}catch(e){this.config.loggerProvider.error("Error logging browser config",e)}},t}(el);let iI=function(){var e=new iA;return{init:_(e.init.bind(e),"init",m(e),w(e,["config"])),add:_(e.add.bind(e),"add",m(e),w(e,["config.apiKey","timeline.plugins"])),remove:_(e.remove.bind(e),"remove",m(e),w(e,["config.apiKey","timeline.plugins"])),track:_(e.track.bind(e),"track",m(e),w(e,["config.apiKey","timeline.queue.length"])),logEvent:_(e.logEvent.bind(e),"logEvent",m(e),w(e,["config.apiKey","timeline.queue.length"])),identify:_(e.identify.bind(e),"identify",m(e),w(e,["config.apiKey","timeline.queue.length"])),groupIdentify:_(e.groupIdentify.bind(e),"groupIdentify",m(e),w(e,["config.apiKey","timeline.queue.length"])),setGroup:_(e.setGroup.bind(e),"setGroup",m(e),w(e,["config.apiKey","timeline.queue.length"])),revenue:_(e.revenue.bind(e),"revenue",m(e),w(e,["config.apiKey","timeline.queue.length"])),flush:_(e.flush.bind(e),"flush",m(e),w(e,["config.apiKey","timeline.queue.length"])),getUserId:_(e.getUserId.bind(e),"getUserId",m(e),w(e,["config","config.userId"])),setUserId:_(e.setUserId.bind(e),"setUserId",m(e),w(e,["config","config.userId"])),getDeviceId:_(e.getDeviceId.bind(e),"getDeviceId",m(e),w(e,["config","config.deviceId"])),setDeviceId:_(e.setDeviceId.bind(e),"setDeviceId",m(e),w(e,["config","config.deviceId"])),reset:_(e.reset.bind(e),"reset",m(e),w(e,["config","config.userId","config.deviceId"])),getSessionId:_(e.getSessionId.bind(e),"getSessionId",m(e),w(e,["config"])),setSessionId:_(e.setSessionId.bind(e),"setSessionId",m(e),w(e,["config"])),extendSession:_(e.extendSession.bind(e),"extendSession",m(e),w(e,["config"])),setOptOut:_(e.setOptOut.bind(e),"setOptOut",m(e),w(e,["config"])),setTransport:_(e.setTransport.bind(e),"setTransport",m(e),w(e,["config"])),getIdentity:_(e.getIdentity.bind(e),"getIdentity",m(e),w(e,["config"])),getOptOut:_(e.getOptOut.bind(e),"getOptOut",m(e),w(e,["config"]))}}();iI.add,iI.extendSession,iI.flush,iI.getDeviceId,iI.getSessionId,iI.getUserId,iI.groupIdentify;var iP=iI.identify,ix=iI.init,iR=(iI.logEvent,iI.remove,iI.reset,iI.revenue,iI.setDeviceId,iI.setGroup,iI.setOptOut,iI.setSessionId,iI.setTransport,iI.setUserId),ij=iI.track},60956:(e,t)=>{t.read=function(e,t,r,n,i){var o,s,a=8*i-n-1,u=(1<<a)-1,l=u>>1,c=-7,h=r?i-1:0,d=r?-1:1,f=e[t+h];for(h+=d,o=f&(1<<-c)-1,f>>=-c,c+=a;c>0;o=256*o+e[t+h],h+=d,c-=8);for(s=o&(1<<-c)-1,o>>=-c,c+=n;c>0;s=256*s+e[t+h],h+=d,c-=8);if(0===o)o=1-l;else{if(o===u)return s?NaN:1/0*(f?-1:1);s+=Math.pow(2,n),o-=l}return(f?-1:1)*s*Math.pow(2,o-n)},t.write=function(e,t,r,n,i,o){var s,a,u,l=8*o-i-1,c=(1<<l)-1,h=c>>1,d=5960464477539062e-23*(23===i),f=n?0:o-1,p=n?1:-1,v=+(t<0||0===t&&1/t<0);for(isNaN(t=Math.abs(t))||t===1/0?(a=+!!isNaN(t),s=c):(s=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-s))<1&&(s--,u*=2),s+h>=1?t+=d/u:t+=d*Math.pow(2,1-h),t*u>=2&&(s++,u/=2),s+h>=c?(a=0,s=c):s+h>=1?(a=(t*u-1)*Math.pow(2,i),s+=h):(a=t*Math.pow(2,h-1)*Math.pow(2,i),s=0));i>=8;e[r+f]=255&a,f+=p,a/=256,i-=8);for(s=s<<i|a,l+=i;l>0;e[r+f]=255&s,f+=p,s/=256,l-=8);e[r+f-p]|=128*v}},60969:(e,t,r)=>{"use strict";r.d(t,{DX:()=>a,Dc:()=>l,TL:()=>s});var n=r(93467),i=r(82523),o=r(12939);function s(e){let t=function(e){let t=n.forwardRef((e,t)=>{let{children:r,...o}=e;if(n.isValidElement(r)){var s;let e,a;let u=(s=r,(a=(e=Object.getOwnPropertyDescriptor(s.props,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?s.ref:(a=(e=Object.getOwnPropertyDescriptor(s,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?s.props.ref:s.props.ref||s.ref),l=function(e,t){let r={...t};for(let n in t){let i=e[n],o=t[n];/^on[A-Z]/.test(n)?i&&o?r[n]=(...e)=>{let t=o(...e);return i(...e),t}:i&&(r[n]=i):"style"===n?r[n]={...i,...o}:"className"===n&&(r[n]=[i,o].filter(Boolean).join(" "))}return{...e,...r}}(o,r.props);return r.type!==n.Fragment&&(l.ref=t?(0,i.t)(t,u):u),n.cloneElement(r,l)}return n.Children.count(r)>1?n.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}(e),r=n.forwardRef((e,r)=>{let{children:i,...s}=e,a=n.Children.toArray(i),u=a.find(c);if(u){let e=u.props.children,i=a.map(t=>t!==u?t:n.Children.count(e)>1?n.Children.only(null):n.isValidElement(e)?e.props.children:null);return(0,o.jsx)(t,{...s,ref:r,children:n.isValidElement(e)?n.cloneElement(e,void 0,i):null})}return(0,o.jsx)(t,{...s,ref:r,children:i})});return r.displayName=`${e}.Slot`,r}var a=s("Slot"),u=Symbol("radix.slottable");function l(e){let t=({children:e})=>(0,o.jsx)(o.Fragment,{children:e});return t.displayName=`${e}.Slottable`,t.__radixId=u,t}function c(e){return n.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===u}},62994:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});let n=(0,r(32420).A)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},66906:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});class r extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}}t.default=r},67471:(e,t,r)=>{"use strict";r.d(t,{$:()=>a,s:()=>s});var n=r(85900),i=r(82789),o=r(97865),s=class extends i.k{#l;#c;#h;constructor(e){super(),this.mutationId=e.mutationId,this.#c=e.mutationCache,this.#l=[],this.state=e.state||a(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){this.#l.includes(e)||(this.#l.push(e),this.clearGcTimeout(),this.#c.notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){this.#l=this.#l.filter(t=>t!==e),this.scheduleGc(),this.#c.notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){this.#l.length||("pending"===this.state.status?this.scheduleGc():this.#c.remove(this))}continue(){return this.#h?.continue()??this.execute(this.state.variables)}async execute(e){let t=()=>{this.#d({type:"continue"})};this.#h=(0,o.II)({fn:()=>this.options.mutationFn?this.options.mutationFn(e):Promise.reject(Error("No mutationFn found")),onFail:(e,t)=>{this.#d({type:"failed",failureCount:e,error:t})},onPause:()=>{this.#d({type:"pause"})},onContinue:t,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#c.canRun(this)});let r="pending"===this.state.status,n=!this.#h.canStart();try{if(r)t();else{this.#d({type:"pending",variables:e,isPaused:n}),await this.#c.config.onMutate?.(e,this);let t=await this.options.onMutate?.(e);t!==this.state.context&&this.#d({type:"pending",context:t,variables:e,isPaused:n})}let i=await this.#h.start();return await this.#c.config.onSuccess?.(i,e,this.state.context,this),await this.options.onSuccess?.(i,e,this.state.context),await this.#c.config.onSettled?.(i,null,this.state.variables,this.state.context,this),await this.options.onSettled?.(i,null,e,this.state.context),this.#d({type:"success",data:i}),i}catch(t){try{throw await this.#c.config.onError?.(t,e,this.state.context,this),await this.options.onError?.(t,e,this.state.context),await this.#c.config.onSettled?.(void 0,t,this.state.variables,this.state.context,this),await this.options.onSettled?.(void 0,t,e,this.state.context),t}finally{this.#d({type:"error",error:t})}}finally{this.#c.runNext(this)}}#d(e){this.state=(t=>{switch(e.type){case"failed":return{...t,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...t,isPaused:!0};case"continue":return{...t,isPaused:!1};case"pending":return{...t,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...t,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...t,data:void 0,error:e.error,failureCount:t.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}})(this.state),n.jG.batch(()=>{this.#l.forEach(t=>{t.onMutationUpdate(e)}),this.#c.notify({mutation:this,type:"updated",action:e})})}};function a(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}},68593:(e,t,r)=>{"use strict";r.d(t,{BH:()=>v,Cp:()=>p,EN:()=>f,Eh:()=>l,F$:()=>d,GU:()=>C,MK:()=>c,S$:()=>n,ZM:()=>T,ZZ:()=>S,Zw:()=>o,d2:()=>u,f8:()=>g,gn:()=>s,hT:()=>E,j3:()=>a,lQ:()=>i,nJ:()=>h,pl:()=>_,y9:()=>k,yy:()=>w});var n="undefined"==typeof window||"Deno"in globalThis;function i(){}function o(e,t){return"function"==typeof e?e(t):e}function s(e){return"number"==typeof e&&e>=0&&e!==1/0}function a(e,t){return Math.max(e+(t||0)-Date.now(),0)}function u(e,t){return"function"==typeof e?e(t):e}function l(e,t){return"function"==typeof e?e(t):e}function c(e,t){let{type:r="all",exact:n,fetchStatus:i,predicate:o,queryKey:s,stale:a}=e;if(s){if(n){if(t.queryHash!==d(s,t.options))return!1}else if(!p(t.queryKey,s))return!1}if("all"!==r){let e=t.isActive();if("active"===r&&!e||"inactive"===r&&e)return!1}return("boolean"!=typeof a||t.isStale()===a)&&(!i||i===t.state.fetchStatus)&&(!o||!!o(t))}function h(e,t){let{exact:r,status:n,predicate:i,mutationKey:o}=e;if(o){if(!t.options.mutationKey)return!1;if(r){if(f(t.options.mutationKey)!==f(o))return!1}else if(!p(t.options.mutationKey,o))return!1}return(!n||t.state.status===n)&&(!i||!!i(t))}function d(e,t){return(t?.queryKeyHashFn||f)(e)}function f(e){return JSON.stringify(e,(e,t)=>m(t)?Object.keys(t).sort().reduce((e,r)=>(e[r]=t[r],e),{}):t)}function p(e,t){return e===t||typeof e==typeof t&&!!e&&!!t&&"object"==typeof e&&"object"==typeof t&&Object.keys(t).every(r=>p(e[r],t[r]))}function v(e,t){if(e===t)return e;let r=y(e)&&y(t);if(r||m(e)&&m(t)){let n=r?e:Object.keys(e),i=n.length,o=r?t:Object.keys(t),s=o.length,a=r?[]:{},u=new Set(n),l=0;for(let n=0;n<s;n++){let i=r?n:o[n];(!r&&u.has(i)||r)&&void 0===e[i]&&void 0===t[i]?(a[i]=void 0,l++):(a[i]=v(e[i],t[i]),a[i]===e[i]&&void 0!==e[i]&&l++)}return i===s&&l===i?e:a}return t}function g(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(let r in e)if(e[r]!==t[r])return!1;return!0}function y(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function m(e){if(!b(e))return!1;let t=e.constructor;if(void 0===t)return!0;let r=t.prototype;return!!(b(r)&&r.hasOwnProperty("isPrototypeOf"))&&Object.getPrototypeOf(e)===Object.prototype}function b(e){return"[object Object]"===Object.prototype.toString.call(e)}function w(e){return new Promise(t=>{setTimeout(t,e)})}function _(e,t,r){return"function"==typeof r.structuralSharing?r.structuralSharing(e,t):!1!==r.structuralSharing?v(e,t):t}function k(e,t,r=0){let n=[...e,t];return r&&n.length>r?n.slice(1):n}function S(e,t,r=0){let n=[t,...e];return r&&n.length>r?n.slice(0,-1):n}var E=Symbol();function T(e,t){return!e.queryFn&&t?.initialPromise?()=>t.initialPromise:e.queryFn&&e.queryFn!==E?e.queryFn:()=>Promise.reject(Error(`Missing queryFn: '${e.queryHash}'`))}function C(e,t){return"function"==typeof e?e(...t):!!e}},73728:(e,t,r)=>{"use strict";r.d(t,{AQ:()=>p,C6:()=>i,Cl:()=>o,Ju:()=>l,N3:()=>f,Tt:()=>s,YH:()=>u,fX:()=>d,gz:()=>h,sH:()=>a,xN:()=>v,zs:()=>c});var n=function(e,t){return(n=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function i(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var o=function(){return(o=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function s(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>t.indexOf(n)&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)0>t.indexOf(n[i])&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function a(e,t,r,n){return new(r||(r=Promise))(function(i,o){function s(e){try{u(n.next(e))}catch(e){o(e)}}function a(e){try{u(n.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(s,a)}u((n=n.apply(e,t||[])).next())})}function u(e,t){var r,n,i,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},s=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return s.next=a(0),s.throw=a(1),s.return=a(2),"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(u){return function(a){if(r)throw TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(o=0)),o;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,n=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}}function l(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function c(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return s}function h(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(c(arguments[t]));return e}function d(e,t,r){if(r||2==arguments.length)for(var n,i=0,o=t.length;i<o;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))}function f(e){return this instanceof f?(this.v=e,this):new f(e)}function p(e,t,r){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var n,i=r.apply(e,t||[]),o=[];return n=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),s("next"),s("throw"),s("return",function(e){return function(t){return Promise.resolve(t).then(e,l)}}),n[Symbol.asyncIterator]=function(){return this},n;function s(e,t){i[e]&&(n[e]=function(t){return new Promise(function(r,n){o.push([e,t,r,n])>1||a(e,t)})},t&&(n[e]=t(n[e])))}function a(e,t){try{var r;(r=i[e](t)).value instanceof f?Promise.resolve(r.value.v).then(u,l):c(o[0][2],r)}catch(e){c(o[0][3],e)}}function u(e){a("next",e)}function l(e){a("throw",e)}function c(e,t){e(t),o.shift(),o.length&&a(o[0][0],o[0][1])}}function v(e){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=l(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise(function(n,i){!function(e,t,r,n){Promise.resolve(n).then(function(t){e({value:t,done:r})},t)}(n,i,(t=e[r](t)).done,t.value)})}}}Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError},74753:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let i=n(r(51719));class o extends i.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){let r=Array.from(new Set(t)).map(e=>"string"==typeof e&&RegExp("[,()]").test(e)?`"${e}"`:`${e}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}contains(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return"string"==typeof t?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:n}={}){let i="";"plain"===n?i="pl":"phrase"===n?i="ph":"websearch"===n&&(i="w");let o=void 0===r?"":`(${r})`;return this.url.searchParams.append(e,`${i}fts${o}.${t}`),this}match(e){return Object.entries(e).forEach(([e,t])=>{this.url.searchParams.append(e,`eq.${t}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){let n=r?`${r}.or`:"or";return this.url.searchParams.append(n,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}}t.default=o},77647:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let i=n(r(91518)),o=n(r(66906));class s{constructor(e){var t,r;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=null!==(t=e.shouldThrowOnError)&&void 0!==t&&t,this.signal=e.signal,this.isMaybeSingle=null!==(r=e.isMaybeSingle)&&void 0!==r&&r,e.fetch?this.fetch=e.fetch:"undefined"==typeof fetch?this.fetch=i.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){void 0===this.schema||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),"GET"!==this.method&&"HEAD"!==this.method&&this.headers.set("Content-Type","application/json");let r=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async e=>{var t,r,n,i;let s=null,a=null,u=null,l=e.status,c=e.statusText;if(e.ok){if("HEAD"!==this.method){let r=await e.text();""===r||(a="text/csv"===this.headers.get("Accept")?r:this.headers.get("Accept")&&(null===(t=this.headers.get("Accept"))||void 0===t?void 0:t.includes("application/vnd.pgrst.plan+text"))?r:JSON.parse(r))}let i=null===(r=this.headers.get("Prefer"))||void 0===r?void 0:r.match(/count=(exact|planned|estimated)/),o=null===(n=e.headers.get("content-range"))||void 0===n?void 0:n.split("/");i&&o&&o.length>1&&(u=parseInt(o[1])),this.isMaybeSingle&&"GET"===this.method&&Array.isArray(a)&&(a.length>1?(s={code:"PGRST116",details:`Results contain ${a.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},a=null,u=null,l=406,c="Not Acceptable"):a=1===a.length?a[0]:null)}else{let t=await e.text();try{s=JSON.parse(t),Array.isArray(s)&&404===e.status&&(a=[],s=null,l=200,c="OK")}catch(r){404===e.status&&""===t?(l=204,c="No Content"):s={message:t}}if(s&&this.isMaybeSingle&&(null===(i=null==s?void 0:s.details)||void 0===i?void 0:i.includes("0 rows"))&&(s=null,l=200,c="OK"),s&&this.shouldThrowOnError)throw new o.default(s)}return{error:s,data:a,count:u,status:l,statusText:c}});return this.shouldThrowOnError||(r=r.catch(e=>{var t,r,n;return{error:{message:`${null!==(t=null==e?void 0:e.name)&&void 0!==t?t:"FetchError"}: ${null==e?void 0:e.message}`,details:`${null!==(r=null==e?void 0:e.stack)&&void 0!==r?r:""}`,hint:"",code:`${null!==(n=null==e?void 0:e.code)&&void 0!==n?n:""}`},data:null,count:null,status:0,statusText:""}})),r.then(e,t)}returns(){return this}overrideTypes(){return this}}t.default=s},77917:(e,t,r)=>{"use strict";r.d(t,{Q:()=>n});var n=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}}},82523:(e,t,r)=>{"use strict";r.d(t,{s:()=>s,t:()=>o});var n=r(93467);function i(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}function o(...e){return t=>{let r=!1,n=e.map(e=>{let n=i(e,t);return r||"function"!=typeof n||(r=!0),n});if(r)return()=>{for(let t=0;t<n.length;t++){let r=n[t];"function"==typeof r?r():i(e[t],null)}}}}function s(...e){return n.useCallback(o(...e),e)}},82789:(e,t,r)=>{"use strict";r.d(t,{k:()=>i});var n=r(68593),i=class{#f;destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),(0,n.gn)(this.gcTime)&&(this.#f=setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(n.S$?1/0:3e5))}clearGcTimeout(){this.#f&&(clearTimeout(this.#f),this.#f=void 0)}}},83042:(e,t,r)=>{"use strict";r.d(t,{t:()=>o});var n=r(77917),i=r(68593),o=new class extends n.Q{#p=!0;#t;#r;constructor(){super(),this.#r=e=>{if(!i.S$&&window.addEventListener){let t=()=>e(!0),r=()=>e(!1);return window.addEventListener("online",t,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",t),window.removeEventListener("offline",r)}}}}onSubscribe(){this.#t||this.setEventListener(this.#r)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(e){this.#r=e,this.#t?.(),this.#t=e(this.setOnline.bind(this))}setOnline(e){this.#p!==e&&(this.#p=e,this.listeners.forEach(t=>{t(e)}))}isOnline(){return this.#p}}},84337:(e,t)=>{"use strict";t.q=function(e,t){if("string"!=typeof e)throw TypeError("argument str must be a string");var r={},i=e.length;if(i<2)return r;var o=t&&t.decode||c,s=0,a=0,h=0;do{if(-1===(a=e.indexOf("=",s)))break;if(-1===(h=e.indexOf(";",s)))h=i;else if(a>h){s=e.lastIndexOf(";",a-1)+1;continue}var d=u(e,s,a),f=l(e,a,d),p=e.slice(d,f);if(!n.call(r,p)){var v=u(e,a+1,h),g=l(e,h,v);34===e.charCodeAt(v)&&34===e.charCodeAt(g-1)&&(v++,g--);var y=e.slice(v,g);r[p]=function(e,t){try{return t(e)}catch(t){return e}}(y,o)}s=h+1}while(s<i);return r},t.l=function(e,t,n){var u=n&&n.encode||encodeURIComponent;if("function"!=typeof u)throw TypeError("option encode is invalid");if(!i.test(e))throw TypeError("argument name is invalid");var l=u(t);if(!o.test(l))throw TypeError("argument val is invalid");var c=e+"="+l;if(!n)return c;if(null!=n.maxAge){var h=Math.floor(n.maxAge);if(!isFinite(h))throw TypeError("option maxAge is invalid");c+="; Max-Age="+h}if(n.domain){if(!s.test(n.domain))throw TypeError("option domain is invalid");c+="; Domain="+n.domain}if(n.path){if(!a.test(n.path))throw TypeError("option path is invalid");c+="; Path="+n.path}if(n.expires){var d,f=n.expires;if(d=f,"[object Date]"!==r.call(d)||isNaN(f.valueOf()))throw TypeError("option expires is invalid");c+="; Expires="+f.toUTCString()}if(n.httpOnly&&(c+="; HttpOnly"),n.secure&&(c+="; Secure"),n.partitioned&&(c+="; Partitioned"),n.priority)switch("string"==typeof n.priority?n.priority.toLowerCase():n.priority){case"low":c+="; Priority=Low";break;case"medium":c+="; Priority=Medium";break;case"high":c+="; Priority=High";break;default:throw TypeError("option priority is invalid")}if(n.sameSite)switch("string"==typeof n.sameSite?n.sameSite.toLowerCase():n.sameSite){case!0:case"strict":c+="; SameSite=Strict";break;case"lax":c+="; SameSite=Lax";break;case"none":c+="; SameSite=None";break;default:throw TypeError("option sameSite is invalid")}return c};var r=Object.prototype.toString,n=Object.prototype.hasOwnProperty,i=/^[!#$%&'*+\-.^_`|~0-9A-Za-z]+$/,o=/^("?)[\u0021\u0023-\u002B\u002D-\u003A\u003C-\u005B\u005D-\u007E]*\1$/,s=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,a=/^[\u0020-\u003A\u003D-\u007E]*$/;function u(e,t,r){do{var n=e.charCodeAt(t);if(32!==n&&9!==n)return t}while(++t<r);return r}function l(e,t,r){for(;t>r;){var n=e.charCodeAt(--t);if(32!==n&&9!==n)return t+1}return r}function c(e){return -1!==e.indexOf("%")?decodeURIComponent(e):e}},85558:(e,t,r)=>{"use strict";r.d(t,{E:()=>o,a:()=>i});var n=r(73728),i=function(e){if(Object.keys(e).length>1e3)return!1;for(var t in e){var r=e[t];if(!o(t,r))return!1}return!0},o=function(e,t){var r,o;if("string"!=typeof e)return!1;if(Array.isArray(t)){var s=!0;try{for(var a=(0,n.Ju)(t),u=a.next();!u.done;u=a.next()){var l=u.value;if(Array.isArray(l))return!1;if("object"==typeof l)s=s&&i(l);else if(!["number","string"].includes(typeof l))return!1;if(!s)return!1}}catch(e){r={error:e}}finally{try{u&&!u.done&&(o=a.return)&&o.call(a)}finally{if(r)throw r.error}}}else if(null==t)return!1;else if("object"==typeof t)return i(t);else if(!["number","string","boolean"].includes(typeof t))return!1;return!0}},85900:(e,t,r)=>{"use strict";r.d(t,{jG:()=>i});var n=e=>setTimeout(e,0),i=function(){let e=[],t=0,r=e=>{e()},i=e=>{e()},o=n,s=n=>{t?e.push(n):o(()=>{r(n)})},a=()=>{let t=e;e=[],t.length&&o(()=>{i(()=>{t.forEach(e=>{r(e)})})})};return{batch:e=>{let r;t++;try{r=e()}finally{--t||a()}return r},batchCalls:e=>(...t)=>{s(()=>{e(...t)})},schedule:s,setNotifyFunction:e=>{r=e},setBatchNotifyFunction:e=>{i=e},setScheduler:e=>{o=e}}}()},91518:(e,t,r)=>{"use strict";r.r(t),r.d(t,{Headers:()=>s,Request:()=>a,Response:()=>u,default:()=>o,fetch:()=>i});var n=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==r.g)return r.g;throw Error("unable to locate global object")}();let i=n.fetch,o=n.fetch.bind(n),s=n.Headers,a=n.Request,u=n.Response},97865:(e,t,r)=>{"use strict";r.d(t,{II:()=>c,cc:()=>l,v_:()=>u});var n=r(35795),i=r(83042),o=r(18891),s=r(68593);function a(e){return Math.min(1e3*2**e,3e4)}function u(e){return(e??"online")!=="online"||i.t.isOnline()}var l=class extends Error{constructor(e){super("CancelledError"),this.revert=e?.revert,this.silent=e?.silent}};function c(e){let t,r=!1,c=0,h=(0,o.T)(),d=()=>"pending"!==h.status,f=()=>n.m.isFocused()&&("always"===e.networkMode||i.t.isOnline())&&e.canRun(),p=()=>u(e.networkMode)&&e.canRun(),v=e=>{d()||(t?.(),h.resolve(e))},g=e=>{d()||(t?.(),h.reject(e))},y=()=>new Promise(r=>{t=e=>{(d()||f())&&r(e)},e.onPause?.()}).then(()=>{t=void 0,d()||e.onContinue?.()}),m=()=>{let t;if(d())return;let n=0===c?e.initialPromise:void 0;try{t=n??e.fn()}catch(e){t=Promise.reject(e)}Promise.resolve(t).then(v).catch(t=>{if(d())return;let n=e.retry??3*!s.S$,i=e.retryDelay??a,o="function"==typeof i?i(c,t):i,u=!0===n||"number"==typeof n&&c<n||"function"==typeof n&&n(c,t);if(r||!u){g(t);return}c++,e.onFail?.(c,t),(0,s.yy)(o).then(()=>f()?void 0:y()).then(()=>{r?g(t):m()})})};return{promise:h,status:()=>h.status,cancel:t=>{d()||(g(new l(t)),e.abort?.())},continue:()=>(t?.(),h),cancelRetry:()=>{r=!0},continueRetry:()=>{r=!1},canStart:p,start:()=>(p()?m():y().then(m),h)}}},98445:(e,t)=>{"use strict";t.byteLength=function(e){var t=u(e),r=t[0],n=t[1];return(r+n)*3/4-n},t.toByteArray=function(e){var t,r,o=u(e),s=o[0],a=o[1],l=new i((s+a)*3/4-a),c=0,h=a>0?s-4:s;for(r=0;r<h;r+=4)t=n[e.charCodeAt(r)]<<18|n[e.charCodeAt(r+1)]<<12|n[e.charCodeAt(r+2)]<<6|n[e.charCodeAt(r+3)],l[c++]=t>>16&255,l[c++]=t>>8&255,l[c++]=255&t;return 2===a&&(t=n[e.charCodeAt(r)]<<2|n[e.charCodeAt(r+1)]>>4,l[c++]=255&t),1===a&&(t=n[e.charCodeAt(r)]<<10|n[e.charCodeAt(r+1)]<<4|n[e.charCodeAt(r+2)]>>2,l[c++]=t>>8&255,l[c++]=255&t),l},t.fromByteArray=function(e){for(var t,n=e.length,i=n%3,o=[],s=0,a=n-i;s<a;s+=16383)o.push(function(e,t,n){for(var i,o=[],s=t;s<n;s+=3)i=(e[s]<<16&0xff0000)+(e[s+1]<<8&65280)+(255&e[s+2]),o.push(r[i>>18&63]+r[i>>12&63]+r[i>>6&63]+r[63&i]);return o.join("")}(e,s,s+16383>a?a:s+16383));return 1===i?o.push(r[(t=e[n-1])>>2]+r[t<<4&63]+"=="):2===i&&o.push(r[(t=(e[n-2]<<8)+e[n-1])>>10]+r[t>>4&63]+r[t<<2&63]+"="),o.join("")};for(var r=[],n=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,a=o.length;s<a;++s)r[s]=o[s],n[o.charCodeAt(s)]=s;function u(e){var t=e.length;if(t%4>0)throw Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");-1===r&&(r=t);var n=r===t?0:4-r%4;return[r,n]}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63}}]);